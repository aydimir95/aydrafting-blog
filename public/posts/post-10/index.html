<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>C# &#43; Revit API: Lesson 10 - Create a Pulldown Button | Blog</title>
<meta name="keywords" content="C#, Revit, Tutorial">
<meta name="description" content="The Goal

We will create a PulldownButton and add a few PushButtons to it.
We will also create some helper methods to generate ButtonData objects given we are beginning to use these in lots of places.
In the next post we will stack PulldownButtons.

Aussie BIM Guru
What we need

Create a data creation methods,
Add a PulldownButton to our panel,
Add PushButtons to it,
Add Icons

Related API Classes

RibbonPanel

PulldownButtonData

PulldownButton


PushButtonData

PushButton





Homework

Create a static utility methods on the Ribbon_Util.cs
Modify a PushButton method to use static utility methods
Create a PulldownButton method
Create a PulldownButton method Extension class to add PushButton to PulldownButton
Update the Strartup method

Solution
Code
Project Solution


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26


Solution
|-&gt; guRoo
	|-&gt; Dependencies
	|-&gt; Commands
		|-&gt; General 
			|-&gt; Cmds_General.cs 
			|-&gt; Cmds_PullDown.cs  // Create a New Class
	|-&gt; Forms
	|-&gt; General 
		|-&gt; Globals.cs 
	|-&gt; Extensions 
		|-&gt; UIControlledApplicaiton_Ext.cs 
		|-&gt; RibbonPanel_Ext.cs    // Update
		|-&gt; PulldownButton_Ext.cs // Create New Extension Class
	|-&gt; Resources
		|-&gt; Files 
			|-&gt; Tooltips.resx     // Update
		|-&gt; Icons 
		|-&gt; Icons16 
			|-&gt; General_test16.png 
		|-&gt; Icons32 
			|-&gt; General_test32.png 
	|-&gt; Utilities
		|-&gt; Ribbon_Utils.cs       // Update
	|-&gt; Application.cs            // Update
	|-&gt; guRoo.addin


Cmd_PullDown.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70


using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace guRoo.Cmds_PullDown
{
    /// &lt;summary&gt;
    ///		Example Command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_1Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements)
        {
            var uiApp = CommandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Code logic here:
            TaskDialog.Show(&#34;Button 1 is Working!&#34;, doc.Title);

            // Final return here:
            return Result.Succeeded;
        }
    }

    /// &lt;summary&gt;
    ///		Example Command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_2Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements)
        {
            var uiApp = CommandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Code logic here:
            TaskDialog.Show(&#34;Button 2 is Working!&#34;, doc.Title);

            // Final return here:
            return Result.Succeeded;
        }
    }

    /// &lt;summary&gt;
    ///		Example Command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_3Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements)
        {
            var uiApp = CommandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Code logic here:
            TaskDialog.Show(&#34;Button 3 is Working!&#34;, doc.Title);

            // Final return here:
            return Result.Succeeded;
        }
    }
}


RibbonPanel_Ext.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79


using Autodesk.Revit.UI;
using System.Diagnostics;
using gRib = guRoo.Utilities.Ribbon_Utils;

namespace guRoo.Extensions
{
    public static class RibbonPanel_Ext
    {
        # region Add Button Creation
        /// &lt;summary&gt;
        /// Adds a Pushbutton to the panel.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;
        /// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt;
        /// &lt;returns&gt;A Pushbutton object.&lt;/returns&gt;

        public static PushButton Ext_AddPushButton(this RibbonPanel panel, string buttonName, string className)
        {
            if (panel is null)
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }

            // Create a Data Object
            var pushButtonData = gRib.NewPushButtonData(buttonName, className);
            
            if (panel.AddItem(pushButtonData) is PushButton pushButton)
            {
                // If the button was made, return it.
                return pushButton;
            }
            else
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }
        }


        /// &lt;summary&gt;
        /// Adds a PulldownButton to the panel.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;
        /// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt;
        /// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt;

        public static PulldownButton Ext_AddPulldownButton(this RibbonPanel panel, string buttonName, string className)
        {
            if (panel is null)
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }

            // Create a Data Object
            var pulldownButtonData = gRib.NewPulldownButtonData(buttonName, className);

            if (panel.AddItem(pulldownButtonData) is PulldownButton pulldownButton)
            {
                // If the button was made, return it.
                return pulldownButton;
            }
            else
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }
        }

        #endregion
    }
}


PulldownButton_Ext.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43


using Autodesk.Revit.UI;
using System.Diagnostics;
using gRib = guRoo.Utilities.Ribbon_Utils;

namespace guRoo.Extensions
{
    public static class PulldownButton_Ext
    {
        # region Add Button Creation
        /// &lt;summary&gt;
        /// Adds a PulldownButton to the panel.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;
        /// &lt;param name=&#34;pulldownButton&#34;&gt;The RibbonPanel to add the button to (Extended).&lt;/param&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;className&#34;&gt;The full class name the button runs.&lt;/param&gt;
        /// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt;

        public static PushButton Ext_AddPushButton(this PulldownButton pulldownButton, string buttonName, string className)
        {
            if (pulldownButton is null)
            {
                Debug.WriteLine($&#34;Error: Could not add {buttonName} to pulldown.&#34;);
                return null;
            }

            // Create a Data Object
            var pushButtonData = gRib.NewPushButtonData(buttonName, className);

            if (pulldownButton.AddPushButton(pushButtonData) is PushButton pushButton)
            {
                // If the button was made, return it.
                return pushButton;
            }
            else
            {
                Debug.WriteLine($&#34;Error: Could not add {buttonName} to pulldown.&#34;);
                return null;
            }
        }
        #endregion
    }
}


Tooltips.resx

  
      
          Name
          Value
          Comment
      
  
  
      
          General_Test
          This is a working tooltip.We can do extra lines.
          
      
      
          General_Test2
          This is a working tooltip.We can do extra lines.
          
      
      
          PullDown
          This is a PulldownButton
          
      
      
          PullDown_1Button
          This is Button 1 of the Pulldown Button.
          
      
      
          PullDown_2Button
          This is Button 2 of the Pulldown Button.
          
      
      
          PullDown_3Button
          This is Button 3 of the Pulldown Button.
          
      
  

Ribbon_Utils.cs


  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107


using Autodesk.Revit.UI;
using System;
using System.Diagnostics;
using System.Windows.Media;
using System.Windows.Media.Imaging;

namespace guRoo.Utilities
{
    public static class Ribbon_Utils
    {
        #region PushButton Data
        /// &lt;summary&gt;
        /// Create a PushButtonData object.
        /// &lt;/summary&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;returns&gt;A PushButtonData object.&lt;/returns&gt;

        public static PushButtonData NewPushButtonData(string buttonName, string className)
        {
            var baseName = CommandToBaseName(className);

            var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className);

            // Set the values
            pushButtonData.ToolTip = LookupTooltip(baseName);
            pushButtonData.Image = GetIcon(baseName, resolution: 16);
            pushButtonData.LargeImage = GetIcon(baseName, resolution: 32);

            return pushButtonData;

        }
        #endregion

        #region Pulldown Data
        /// &lt;summary&gt;
        /// Create a PulldownButtonData object.
        /// &lt;/summary&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;returns&gt;A PulldownButtonData object.&lt;/returns&gt;

        public static PulldownButtonData NewPulldownButtonData(string buttonName, string className)
        {
            var baseName = CommandToBaseName(className);

            var pulldownButtonData = new PulldownButtonData(baseName, buttonName);

            // Set the values
            pulldownButtonData.ToolTip = LookupTooltip(baseName);
            pulldownButtonData.Image = GetIcon(baseName, resolution: 16);
            pulldownButtonData.LargeImage = GetIcon(baseName, resolution: 32);

            return pulldownButtonData;

        }
        #endregion

        #region Method to get the base name of a command
        public static string CommandToBaseName(string commandName)
        {
            return commandName.Replace(&#34;guRoo.Cmds_&#34;, &#34;&#34;).Replace(&#34;.Cmd&#34;, &#34;&#34;);
        }

        // Method to get a value from a dictionary key
        public static string LookupTooltip(string key, string failValue = null)
        {
            failValue ??= &#34;No tooltip value was found.&#34;; // ??= -&gt; if this is null set it to the following

            if (Globals.Tooltips.TryGetValue(key, out string value))
            {
                return value;
            }

            return failValue;
        }
        #endregion

        #region Method to get an icon as an image source
        public static ImageSource GetIcon(string baseName, int resolution = 32)
        {
            var resourcePath = $&#34;guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png&#34;;

            using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath))
            {
                if (stream is null) { return null; }

                var decoder = new PngBitmapDecoder(
                    stream,
                    BitmapCreateOptions.PreservePixelFormat,
                    BitmapCacheOption.Default);

                if (decoder.Frames.Count &gt; 0)
                {
                    return decoder.Frames.First();
                }
                else
                {
                    return null;
                }
            }
        }
        #endregion 


    }
}


Application.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92


// Autodesk
using Autodesk.Revit.UI;
using Autodesk.Revit.UI.Events;


// guRoo
using gRib = guRoo.Utilities.Ribbon_Utils;
using guRoo.Extensions;

// This application belongs to the root namespace
namespace guRoo
{
    // Implementing the interface for application.cs class
    public class Application : IExternalApplication
    // IExternalApplication for the interface
    {
        // Make a private uiCtlApp method:
        private static UIControlledApplication _uiCtlApp;

        //This will return a result on Startup method - requires uiCtlApp
        public Result OnStartup(UIControlledApplication uiCtlApp)
        {

            #region Globals registration
            // Store _uiCtlApp, register on idling
            _uiCtlApp = uiCtlApp;

            try
            {
                _uiCtlApp.Idling &#43;= RegisterUiApp;
            }
            catch
            {
                Globals.UiApp = null;
                Globals.UsernameRevit = null;
            }

            // Register Globals
            Globals.RegisterProperties(uiCtlApp);

            // Register Tooltips
            Globals.RegisterTooltips(&#34;guRoo.Resources.Files.Tooltips&#34;);
            #endregion

            #region Ribbon setup
            // Add RibbonTab
            uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); 

            // Create RibbonPanel
            var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, &#34;General&#34;);

            // Add PushButton to RibbonPanel
            var buttonTest = panelGeneral.Ext_AddPushButton(&#34;Testing&#34;, &#34;guRoo.Cmds_General.Cmd_Test&#34;);

            // Add PulldownButton to RibbonPanel
            var pulldownTest = panelGeneral.Ext_AddPulldownButton(&#34;PullDown&#34;, &#34;guRoo.Cmds_PullDown&#34;);

            // Add Buttons to Pulldown
            pulldownTest.Ext_AddPushButton(&#34;Button 1&#34;, &#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 2&#34;, &#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 3&#34;, &#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;);

            #endregion


            // Final return:
            return Result.Succeeded; // or Cancelled
        }

        #region On shutdown method
        // This will urn on shutdown
        public Result OnShutdown(UIControlledApplication uiCtlApp)
        {
            return Result.Succeeded;
        }
        #endregion

        #region Use idling to register UiApp
        // On idling, register UiApp/username
        private static void RegisterUiApp(object sender, IdlingEventArgs e)
        {
            _uiCtlApp.Idling -= RegisterUiApp;

            if (sender is UIApplication uiApp)
            {
                Globals.UiApp = uiApp;
                Globals.UsernameRevit = uiApp.Application.Username;
            }
        }
        #endregion
    }
}




These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/post-10/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css" integrity="sha256-bVhUcqQJqPUE5r&#43;Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/post-10/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/post-10/">
  <meta property="og:site_name" content="Blog">
  <meta property="og:title" content="C# &#43; Revit API: Lesson 10 - Create a Pulldown Button">
  <meta property="og:description" content="The Goal We will create a PulldownButton and add a few PushButtons to it.
We will also create some helper methods to generate ButtonData objects given we are beginning to use these in lots of places.
In the next post we will stack PulldownButtons.
Aussie BIM Guru
What we need Create a data creation methods, Add a PulldownButton to our panel, Add PushButtons to it, Add Icons Related API Classes RibbonPanel PulldownButtonData PulldownButton PushButtonData PushButton Homework Create a static utility methods on the Ribbon_Util.cs Modify a PushButton method to use static utility methods Create a PulldownButton method Create a PulldownButton method Extension class to add PushButton to PulldownButton Update the Strartup method Solution Code Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 Solution |-&gt; guRoo |-&gt; Dependencies |-&gt; Commands |-&gt; General |-&gt; Cmds_General.cs |-&gt; Cmds_PullDown.cs // Create a New Class |-&gt; Forms |-&gt; General |-&gt; Globals.cs |-&gt; Extensions |-&gt; UIControlledApplicaiton_Ext.cs |-&gt; RibbonPanel_Ext.cs // Update |-&gt; PulldownButton_Ext.cs // Create New Extension Class |-&gt; Resources |-&gt; Files |-&gt; Tooltips.resx // Update |-&gt; Icons |-&gt; Icons16 |-&gt; General_test16.png |-&gt; Icons32 |-&gt; General_test32.png |-&gt; Utilities |-&gt; Ribbon_Utils.cs // Update |-&gt; Application.cs // Update |-&gt; guRoo.addin Cmd_PullDown.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace guRoo.Cmds_PullDown { /// &lt;summary&gt; ///	Example Command /// &lt;/summary&gt; [Transaction(TransactionMode.Manual)] public class Cmd_1Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(&#34;Button 1 is Working!&#34;, doc.Title); // Final return here: return Result.Succeeded; } } /// &lt;summary&gt; ///	Example Command /// &lt;/summary&gt; [Transaction(TransactionMode.Manual)] public class Cmd_2Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(&#34;Button 2 is Working!&#34;, doc.Title); // Final return here: return Result.Succeeded; } } /// &lt;summary&gt; ///	Example Command /// &lt;/summary&gt; [Transaction(TransactionMode.Manual)] public class Cmd_3Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(&#34;Button 3 is Working!&#34;, doc.Title); // Final return here: return Result.Succeeded; } } } RibbonPanel_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class RibbonPanel_Ext { # region Add Button Creation /// &lt;summary&gt; /// Adds a Pushbutton to the panel. /// &lt;/summary&gt; /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt; /// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt; /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt; /// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt; /// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt; /// &lt;returns&gt;A Pushbutton object.&lt;/returns&gt; public static PushButton Ext_AddPushButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (panel.AddItem(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;); return null; } } /// &lt;summary&gt; /// Adds a PulldownButton to the panel. /// &lt;/summary&gt; /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt; /// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt; /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt; /// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt; /// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt; /// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt; public static PulldownButton Ext_AddPulldownButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;); return null; } // Create a Data Object var pulldownButtonData = gRib.NewPulldownButtonData(buttonName, className); if (panel.AddItem(pulldownButtonData) is PulldownButton pulldownButton) { // If the button was made, return it. return pulldownButton; } else { Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;); return null; } } #endregion } } PulldownButton_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class PulldownButton_Ext { # region Add Button Creation /// &lt;summary&gt; /// Adds a PulldownButton to the panel. /// &lt;/summary&gt; /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt; /// &lt;param name=&#34;pulldownButton&#34;&gt;The RibbonPanel to add the button to (Extended).&lt;/param&gt; /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt; /// &lt;param name=&#34;className&#34;&gt;The full class name the button runs.&lt;/param&gt; /// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt; public static PushButton Ext_AddPushButton(this PulldownButton pulldownButton, string buttonName, string className) { if (pulldownButton is null) { Debug.WriteLine($&#34;Error: Could not add {buttonName} to pulldown.&#34;); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (pulldownButton.AddPushButton(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($&#34;Error: Could not add {buttonName} to pulldown.&#34;); return null; } } #endregion } } Tooltips.resx Name Value Comment General_Test This is a working tooltip.
We can do extra lines. General_Test2 This is a working tooltip.
We can do extra lines. PullDown This is a PulldownButton PullDown_1Button This is Button 1 of the Pulldown Button. PullDown_2Button This is Button 2 of the Pulldown Button. PullDown_3Button This is Button 3 of the Pulldown Button. Ribbon_Utils.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 using Autodesk.Revit.UI; using System; using System.Diagnostics; using System.Windows.Media; using System.Windows.Media.Imaging; namespace guRoo.Utilities { public static class Ribbon_Utils { #region PushButton Data /// &lt;summary&gt; /// Create a PushButtonData object. /// &lt;/summary&gt; /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt; /// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt; /// &lt;returns&gt;A PushButtonData object.&lt;/returns&gt; public static PushButtonData NewPushButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className); // Set the values pushButtonData.ToolTip = LookupTooltip(baseName); pushButtonData.Image = GetIcon(baseName, resolution: 16); pushButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pushButtonData; } #endregion #region Pulldown Data /// &lt;summary&gt; /// Create a PulldownButtonData object. /// &lt;/summary&gt; /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt; /// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt; /// &lt;returns&gt;A PulldownButtonData object.&lt;/returns&gt; public static PulldownButtonData NewPulldownButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pulldownButtonData = new PulldownButtonData(baseName, buttonName); // Set the values pulldownButtonData.ToolTip = LookupTooltip(baseName); pulldownButtonData.Image = GetIcon(baseName, resolution: 16); pulldownButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pulldownButtonData; } #endregion #region Method to get the base name of a command public static string CommandToBaseName(string commandName) { return commandName.Replace(&#34;guRoo.Cmds_&#34;, &#34;&#34;).Replace(&#34;.Cmd&#34;, &#34;&#34;); } // Method to get a value from a dictionary key public static string LookupTooltip(string key, string failValue = null) { failValue ??= &#34;No tooltip value was found.&#34;; // ??= -&gt; if this is null set it to the following if (Globals.Tooltips.TryGetValue(key, out string value)) { return value; } return failValue; } #endregion #region Method to get an icon as an image source public static ImageSource GetIcon(string baseName, int resolution = 32) { var resourcePath = $&#34;guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png&#34;; using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath)) { if (stream is null) { return null; } var decoder = new PngBitmapDecoder( stream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); if (decoder.Frames.Count &gt; 0) { return decoder.Frames.First(); } else { return null; } } } #endregion } } Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling &#43;= RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips(&#34;guRoo.Resources.Files.Tooltips&#34;); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, &#34;General&#34;); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton(&#34;Testing&#34;, &#34;guRoo.Cmds_General.Cmd_Test&#34;); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton(&#34;PullDown&#34;, &#34;guRoo.Cmds_PullDown&#34;); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton(&#34;Button 1&#34;, &#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;); pulldownTest.Ext_AddPushButton(&#34;Button 2&#34;, &#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;); pulldownTest.Ext_AddPushButton(&#34;Button 3&#34;, &#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-14T12:02:26+03:00">
    <meta property="article:modified_time" content="2025-08-14T12:02:26+03:00">
    <meta property="article:tag" content="C#">
    <meta property="article:tag" content="Revit">
    <meta property="article:tag" content="Tutorial">
      <meta property="og:image" content="http://localhost:1313/LogoAYD.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/LogoAYD.png">
<meta name="twitter:title" content="C# &#43; Revit API: Lesson 10 - Create a Pulldown Button">
<meta name="twitter:description" content="The Goal

We will create a PulldownButton and add a few PushButtons to it.
We will also create some helper methods to generate ButtonData objects given we are beginning to use these in lots of places.
In the next post we will stack PulldownButtons.

Aussie BIM Guru
What we need

Create a data creation methods,
Add a PulldownButton to our panel,
Add PushButtons to it,
Add Icons

Related API Classes

RibbonPanel

PulldownButtonData

PulldownButton


PushButtonData

PushButton





Homework

Create a static utility methods on the Ribbon_Util.cs
Modify a PushButton method to use static utility methods
Create a PulldownButton method
Create a PulldownButton method Extension class to add PushButton to PulldownButton
Update the Strartup method

Solution
Code
Project Solution


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26


Solution
|-&gt; guRoo
	|-&gt; Dependencies
	|-&gt; Commands
		|-&gt; General 
			|-&gt; Cmds_General.cs 
			|-&gt; Cmds_PullDown.cs  // Create a New Class
	|-&gt; Forms
	|-&gt; General 
		|-&gt; Globals.cs 
	|-&gt; Extensions 
		|-&gt; UIControlledApplicaiton_Ext.cs 
		|-&gt; RibbonPanel_Ext.cs    // Update
		|-&gt; PulldownButton_Ext.cs // Create New Extension Class
	|-&gt; Resources
		|-&gt; Files 
			|-&gt; Tooltips.resx     // Update
		|-&gt; Icons 
		|-&gt; Icons16 
			|-&gt; General_test16.png 
		|-&gt; Icons32 
			|-&gt; General_test32.png 
	|-&gt; Utilities
		|-&gt; Ribbon_Utils.cs       // Update
	|-&gt; Application.cs            // Update
	|-&gt; guRoo.addin


Cmd_PullDown.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70


using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace guRoo.Cmds_PullDown
{
    /// &lt;summary&gt;
    ///		Example Command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_1Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements)
        {
            var uiApp = CommandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Code logic here:
            TaskDialog.Show(&#34;Button 1 is Working!&#34;, doc.Title);

            // Final return here:
            return Result.Succeeded;
        }
    }

    /// &lt;summary&gt;
    ///		Example Command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_2Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements)
        {
            var uiApp = CommandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Code logic here:
            TaskDialog.Show(&#34;Button 2 is Working!&#34;, doc.Title);

            // Final return here:
            return Result.Succeeded;
        }
    }

    /// &lt;summary&gt;
    ///		Example Command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_3Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements)
        {
            var uiApp = CommandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Code logic here:
            TaskDialog.Show(&#34;Button 3 is Working!&#34;, doc.Title);

            // Final return here:
            return Result.Succeeded;
        }
    }
}


RibbonPanel_Ext.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79


using Autodesk.Revit.UI;
using System.Diagnostics;
using gRib = guRoo.Utilities.Ribbon_Utils;

namespace guRoo.Extensions
{
    public static class RibbonPanel_Ext
    {
        # region Add Button Creation
        /// &lt;summary&gt;
        /// Adds a Pushbutton to the panel.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;
        /// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt;
        /// &lt;returns&gt;A Pushbutton object.&lt;/returns&gt;

        public static PushButton Ext_AddPushButton(this RibbonPanel panel, string buttonName, string className)
        {
            if (panel is null)
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }

            // Create a Data Object
            var pushButtonData = gRib.NewPushButtonData(buttonName, className);
            
            if (panel.AddItem(pushButtonData) is PushButton pushButton)
            {
                // If the button was made, return it.
                return pushButton;
            }
            else
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }
        }


        /// &lt;summary&gt;
        /// Adds a PulldownButton to the panel.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;
        /// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt;
        /// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt;

        public static PulldownButton Ext_AddPulldownButton(this RibbonPanel panel, string buttonName, string className)
        {
            if (panel is null)
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }

            // Create a Data Object
            var pulldownButtonData = gRib.NewPulldownButtonData(buttonName, className);

            if (panel.AddItem(pulldownButtonData) is PulldownButton pulldownButton)
            {
                // If the button was made, return it.
                return pulldownButton;
            }
            else
            {
                Debug.WriteLine($&#34;Error: Could not create {buttonName}.&#34;);
                return null;
            }
        }

        #endregion
    }
}


PulldownButton_Ext.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43


using Autodesk.Revit.UI;
using System.Diagnostics;
using gRib = guRoo.Utilities.Ribbon_Utils;

namespace guRoo.Extensions
{
    public static class PulldownButton_Ext
    {
        # region Add Button Creation
        /// &lt;summary&gt;
        /// Adds a PulldownButton to the panel.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;
        /// &lt;param name=&#34;pulldownButton&#34;&gt;The RibbonPanel to add the button to (Extended).&lt;/param&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;className&#34;&gt;The full class name the button runs.&lt;/param&gt;
        /// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt;

        public static PushButton Ext_AddPushButton(this PulldownButton pulldownButton, string buttonName, string className)
        {
            if (pulldownButton is null)
            {
                Debug.WriteLine($&#34;Error: Could not add {buttonName} to pulldown.&#34;);
                return null;
            }

            // Create a Data Object
            var pushButtonData = gRib.NewPushButtonData(buttonName, className);

            if (pulldownButton.AddPushButton(pushButtonData) is PushButton pushButton)
            {
                // If the button was made, return it.
                return pushButton;
            }
            else
            {
                Debug.WriteLine($&#34;Error: Could not add {buttonName} to pulldown.&#34;);
                return null;
            }
        }
        #endregion
    }
}


Tooltips.resx

  
      
          Name
          Value
          Comment
      
  
  
      
          General_Test
          This is a working tooltip.We can do extra lines.
          
      
      
          General_Test2
          This is a working tooltip.We can do extra lines.
          
      
      
          PullDown
          This is a PulldownButton
          
      
      
          PullDown_1Button
          This is Button 1 of the Pulldown Button.
          
      
      
          PullDown_2Button
          This is Button 2 of the Pulldown Button.
          
      
      
          PullDown_3Button
          This is Button 3 of the Pulldown Button.
          
      
  

Ribbon_Utils.cs


  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107


using Autodesk.Revit.UI;
using System;
using System.Diagnostics;
using System.Windows.Media;
using System.Windows.Media.Imaging;

namespace guRoo.Utilities
{
    public static class Ribbon_Utils
    {
        #region PushButton Data
        /// &lt;summary&gt;
        /// Create a PushButtonData object.
        /// &lt;/summary&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;returns&gt;A PushButtonData object.&lt;/returns&gt;

        public static PushButtonData NewPushButtonData(string buttonName, string className)
        {
            var baseName = CommandToBaseName(className);

            var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className);

            // Set the values
            pushButtonData.ToolTip = LookupTooltip(baseName);
            pushButtonData.Image = GetIcon(baseName, resolution: 16);
            pushButtonData.LargeImage = GetIcon(baseName, resolution: 32);

            return pushButtonData;

        }
        #endregion

        #region Pulldown Data
        /// &lt;summary&gt;
        /// Create a PulldownButtonData object.
        /// &lt;/summary&gt;
        /// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;
        /// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt;
        /// &lt;returns&gt;A PulldownButtonData object.&lt;/returns&gt;

        public static PulldownButtonData NewPulldownButtonData(string buttonName, string className)
        {
            var baseName = CommandToBaseName(className);

            var pulldownButtonData = new PulldownButtonData(baseName, buttonName);

            // Set the values
            pulldownButtonData.ToolTip = LookupTooltip(baseName);
            pulldownButtonData.Image = GetIcon(baseName, resolution: 16);
            pulldownButtonData.LargeImage = GetIcon(baseName, resolution: 32);

            return pulldownButtonData;

        }
        #endregion

        #region Method to get the base name of a command
        public static string CommandToBaseName(string commandName)
        {
            return commandName.Replace(&#34;guRoo.Cmds_&#34;, &#34;&#34;).Replace(&#34;.Cmd&#34;, &#34;&#34;);
        }

        // Method to get a value from a dictionary key
        public static string LookupTooltip(string key, string failValue = null)
        {
            failValue ??= &#34;No tooltip value was found.&#34;; // ??= -&gt; if this is null set it to the following

            if (Globals.Tooltips.TryGetValue(key, out string value))
            {
                return value;
            }

            return failValue;
        }
        #endregion

        #region Method to get an icon as an image source
        public static ImageSource GetIcon(string baseName, int resolution = 32)
        {
            var resourcePath = $&#34;guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png&#34;;

            using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath))
            {
                if (stream is null) { return null; }

                var decoder = new PngBitmapDecoder(
                    stream,
                    BitmapCreateOptions.PreservePixelFormat,
                    BitmapCacheOption.Default);

                if (decoder.Frames.Count &gt; 0)
                {
                    return decoder.Frames.First();
                }
                else
                {
                    return null;
                }
            }
        }
        #endregion 


    }
}


Application.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92


// Autodesk
using Autodesk.Revit.UI;
using Autodesk.Revit.UI.Events;


// guRoo
using gRib = guRoo.Utilities.Ribbon_Utils;
using guRoo.Extensions;

// This application belongs to the root namespace
namespace guRoo
{
    // Implementing the interface for application.cs class
    public class Application : IExternalApplication
    // IExternalApplication for the interface
    {
        // Make a private uiCtlApp method:
        private static UIControlledApplication _uiCtlApp;

        //This will return a result on Startup method - requires uiCtlApp
        public Result OnStartup(UIControlledApplication uiCtlApp)
        {

            #region Globals registration
            // Store _uiCtlApp, register on idling
            _uiCtlApp = uiCtlApp;

            try
            {
                _uiCtlApp.Idling &#43;= RegisterUiApp;
            }
            catch
            {
                Globals.UiApp = null;
                Globals.UsernameRevit = null;
            }

            // Register Globals
            Globals.RegisterProperties(uiCtlApp);

            // Register Tooltips
            Globals.RegisterTooltips(&#34;guRoo.Resources.Files.Tooltips&#34;);
            #endregion

            #region Ribbon setup
            // Add RibbonTab
            uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); 

            // Create RibbonPanel
            var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, &#34;General&#34;);

            // Add PushButton to RibbonPanel
            var buttonTest = panelGeneral.Ext_AddPushButton(&#34;Testing&#34;, &#34;guRoo.Cmds_General.Cmd_Test&#34;);

            // Add PulldownButton to RibbonPanel
            var pulldownTest = panelGeneral.Ext_AddPulldownButton(&#34;PullDown&#34;, &#34;guRoo.Cmds_PullDown&#34;);

            // Add Buttons to Pulldown
            pulldownTest.Ext_AddPushButton(&#34;Button 1&#34;, &#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 2&#34;, &#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 3&#34;, &#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;);

            #endregion


            // Final return:
            return Result.Succeeded; // or Cancelled
        }

        #region On shutdown method
        // This will urn on shutdown
        public Result OnShutdown(UIControlledApplication uiCtlApp)
        {
            return Result.Succeeded;
        }
        #endregion

        #region Use idling to register UiApp
        // On idling, register UiApp/username
        private static void RegisterUiApp(object sender, IdlingEventArgs e)
        {
            _uiCtlApp.Idling -= RegisterUiApp;

            if (sender is UIApplication uiApp)
            {
                Globals.UiApp = uiApp;
                Globals.UsernameRevit = uiApp.Application.Username;
            }
        }
        #endregion
    }
}




These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "C# + Revit API: Lesson 10 - Create a Pulldown Button",
      "item": "http://localhost:1313/posts/post-10/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C# + Revit API: Lesson 10 - Create a Pulldown Button",
  "name": "C# \u002b Revit API: Lesson 10 - Create a Pulldown Button",
  "description": "The Goal We will create a PulldownButton and add a few PushButtons to it.\nWe will also create some helper methods to generate ButtonData objects given we are beginning to use these in lots of places.\nIn the next post we will stack PulldownButtons.\nAussie BIM Guru\nWhat we need Create a data creation methods, Add a PulldownButton to our panel, Add PushButtons to it, Add Icons Related API Classes RibbonPanel PulldownButtonData PulldownButton PushButtonData PushButton Homework Create a static utility methods on the Ribbon_Util.cs Modify a PushButton method to use static utility methods Create a PulldownButton method Create a PulldownButton method Extension class to add PushButton to PulldownButton Update the Strartup method Solution Code Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 Solution |-\u0026gt; guRoo |-\u0026gt; Dependencies |-\u0026gt; Commands |-\u0026gt; General |-\u0026gt; Cmds_General.cs |-\u0026gt; Cmds_PullDown.cs // Create a New Class |-\u0026gt; Forms |-\u0026gt; General |-\u0026gt; Globals.cs |-\u0026gt; Extensions |-\u0026gt; UIControlledApplicaiton_Ext.cs |-\u0026gt; RibbonPanel_Ext.cs // Update |-\u0026gt; PulldownButton_Ext.cs // Create New Extension Class |-\u0026gt; Resources |-\u0026gt; Files |-\u0026gt; Tooltips.resx // Update |-\u0026gt; Icons |-\u0026gt; Icons16 |-\u0026gt; General_test16.png |-\u0026gt; Icons32 |-\u0026gt; General_test32.png |-\u0026gt; Utilities |-\u0026gt; Ribbon_Utils.cs // Update |-\u0026gt; Application.cs // Update |-\u0026gt; guRoo.addin Cmd_PullDown.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace guRoo.Cmds_PullDown { /// \u0026lt;summary\u0026gt; ///\tExample Command /// \u0026lt;/summary\u0026gt; [Transaction(TransactionMode.Manual)] public class Cmd_1Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(\u0026#34;Button 1 is Working!\u0026#34;, doc.Title); // Final return here: return Result.Succeeded; } } /// \u0026lt;summary\u0026gt; ///\tExample Command /// \u0026lt;/summary\u0026gt; [Transaction(TransactionMode.Manual)] public class Cmd_2Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(\u0026#34;Button 2 is Working!\u0026#34;, doc.Title); // Final return here: return Result.Succeeded; } } /// \u0026lt;summary\u0026gt; ///\tExample Command /// \u0026lt;/summary\u0026gt; [Transaction(TransactionMode.Manual)] public class Cmd_3Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(\u0026#34;Button 3 is Working!\u0026#34;, doc.Title); // Final return here: return Result.Succeeded; } } } RibbonPanel_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class RibbonPanel_Ext { # region Add Button Creation /// \u0026lt;summary\u0026gt; /// Adds a Pushbutton to the panel. /// \u0026lt;/summary\u0026gt; /// \u0026lt;typeparam name=\u0026#34;CommandClass\u0026#34;\u0026gt;The related Command class.\u0026lt;/typeparam\u0026gt; /// \u0026lt;param name=\u0026#34;ribbonPanel\u0026#34;\u0026gt;The RibbonPanel (extended).\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;buttonName\u0026#34;\u0026gt;The name for the button.\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;availability\u0026#34;\u0026gt;The availability name.\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;suffix\u0026#34;\u0026gt;The icon suffix (none by default).\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;A Pushbutton object.\u0026lt;/returns\u0026gt; public static PushButton Ext_AddPushButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($\u0026#34;Error: Could not create {buttonName}.\u0026#34;); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (panel.AddItem(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($\u0026#34;Error: Could not create {buttonName}.\u0026#34;); return null; } } /// \u0026lt;summary\u0026gt; /// Adds a PulldownButton to the panel. /// \u0026lt;/summary\u0026gt; /// \u0026lt;typeparam name=\u0026#34;CommandClass\u0026#34;\u0026gt;The related Command class.\u0026lt;/typeparam\u0026gt; /// \u0026lt;param name=\u0026#34;ribbonPanel\u0026#34;\u0026gt;The RibbonPanel (extended).\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;buttonName\u0026#34;\u0026gt;The name for the button.\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;availability\u0026#34;\u0026gt;The availability name.\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;suffix\u0026#34;\u0026gt;The icon suffix (none by default).\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;A PulldownButton object.\u0026lt;/returns\u0026gt; public static PulldownButton Ext_AddPulldownButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($\u0026#34;Error: Could not create {buttonName}.\u0026#34;); return null; } // Create a Data Object var pulldownButtonData = gRib.NewPulldownButtonData(buttonName, className); if (panel.AddItem(pulldownButtonData) is PulldownButton pulldownButton) { // If the button was made, return it. return pulldownButton; } else { Debug.WriteLine($\u0026#34;Error: Could not create {buttonName}.\u0026#34;); return null; } } #endregion } } PulldownButton_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class PulldownButton_Ext { # region Add Button Creation /// \u0026lt;summary\u0026gt; /// Adds a PulldownButton to the panel. /// \u0026lt;/summary\u0026gt; /// \u0026lt;typeparam name=\u0026#34;CommandClass\u0026#34;\u0026gt;The related Command class.\u0026lt;/typeparam\u0026gt; /// \u0026lt;param name=\u0026#34;pulldownButton\u0026#34;\u0026gt;The RibbonPanel to add the button to (Extended).\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;buttonName\u0026#34;\u0026gt;The name for the button.\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;className\u0026#34;\u0026gt;The full class name the button runs.\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;A PulldownButton object.\u0026lt;/returns\u0026gt; public static PushButton Ext_AddPushButton(this PulldownButton pulldownButton, string buttonName, string className) { if (pulldownButton is null) { Debug.WriteLine($\u0026#34;Error: Could not add {buttonName} to pulldown.\u0026#34;); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (pulldownButton.AddPushButton(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($\u0026#34;Error: Could not add {buttonName} to pulldown.\u0026#34;); return null; } } #endregion } } Tooltips.resx Name Value Comment General_Test This is a working tooltip.\nWe can do extra lines. General_Test2 This is a working tooltip.\nWe can do extra lines. PullDown This is a PulldownButton PullDown_1Button This is Button 1 of the Pulldown Button. PullDown_2Button This is Button 2 of the Pulldown Button. PullDown_3Button This is Button 3 of the Pulldown Button. Ribbon_Utils.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 using Autodesk.Revit.UI; using System; using System.Diagnostics; using System.Windows.Media; using System.Windows.Media.Imaging; namespace guRoo.Utilities { public static class Ribbon_Utils { #region PushButton Data /// \u0026lt;summary\u0026gt; /// Create a PushButtonData object. /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;buttonName\u0026#34;\u0026gt;The name for the button.\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;className\u0026#34;\u0026gt;The availability name.\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;A PushButtonData object.\u0026lt;/returns\u0026gt; public static PushButtonData NewPushButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className); // Set the values pushButtonData.ToolTip = LookupTooltip(baseName); pushButtonData.Image = GetIcon(baseName, resolution: 16); pushButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pushButtonData; } #endregion #region Pulldown Data /// \u0026lt;summary\u0026gt; /// Create a PulldownButtonData object. /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;buttonName\u0026#34;\u0026gt;The name for the button.\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;className\u0026#34;\u0026gt;The availability name.\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;A PulldownButtonData object.\u0026lt;/returns\u0026gt; public static PulldownButtonData NewPulldownButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pulldownButtonData = new PulldownButtonData(baseName, buttonName); // Set the values pulldownButtonData.ToolTip = LookupTooltip(baseName); pulldownButtonData.Image = GetIcon(baseName, resolution: 16); pulldownButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pulldownButtonData; } #endregion #region Method to get the base name of a command public static string CommandToBaseName(string commandName) { return commandName.Replace(\u0026#34;guRoo.Cmds_\u0026#34;, \u0026#34;\u0026#34;).Replace(\u0026#34;.Cmd\u0026#34;, \u0026#34;\u0026#34;); } // Method to get a value from a dictionary key public static string LookupTooltip(string key, string failValue = null) { failValue ??= \u0026#34;No tooltip value was found.\u0026#34;; // ??= -\u0026gt; if this is null set it to the following if (Globals.Tooltips.TryGetValue(key, out string value)) { return value; } return failValue; } #endregion #region Method to get an icon as an image source public static ImageSource GetIcon(string baseName, int resolution = 32) { var resourcePath = $\u0026#34;guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png\u0026#34;; using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath)) { if (stream is null) { return null; } var decoder = new PngBitmapDecoder( stream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); if (decoder.Frames.Count \u0026gt; 0) { return decoder.Frames.First(); } else { return null; } } } #endregion } } Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips(\u0026#34;guRoo.Resources.Files.Tooltips\u0026#34;); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, \u0026#34;General\u0026#34;); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton(\u0026#34;Testing\u0026#34;, \u0026#34;guRoo.Cmds_General.Cmd_Test\u0026#34;); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton(\u0026#34;PullDown\u0026#34;, \u0026#34;guRoo.Cmds_PullDown\u0026#34;); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton(\u0026#34;Button 1\u0026#34;, \u0026#34;guRoo.Cmds_PullDown.Cmd_1Button\u0026#34;); pulldownTest.Ext_AddPushButton(\u0026#34;Button 2\u0026#34;, \u0026#34;guRoo.Cmds_PullDown.Cmd_2Button\u0026#34;); pulldownTest.Ext_AddPushButton(\u0026#34;Button 3\u0026#34;, \u0026#34;guRoo.Cmds_PullDown.Cmd_3Button\u0026#34;); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.\n",
  "keywords": [
    "C#", "Revit", "Tutorial"
  ],
  "articleBody": "The Goal We will create a PulldownButton and add a few PushButtons to it.\nWe will also create some helper methods to generate ButtonData objects given we are beginning to use these in lots of places.\nIn the next post we will stack PulldownButtons.\nAussie BIM Guru\nWhat we need Create a data creation methods, Add a PulldownButton to our panel, Add PushButtons to it, Add Icons Related API Classes RibbonPanel PulldownButtonData PulldownButton PushButtonData PushButton Homework Create a static utility methods on the Ribbon_Util.cs Modify a PushButton method to use static utility methods Create a PulldownButton method Create a PulldownButton method Extension class to add PushButton to PulldownButton Update the Strartup method Solution Code Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e General |-\u003e Cmds_General.cs |-\u003e Cmds_PullDown.cs // Create a New Class |-\u003e Forms |-\u003e General |-\u003e Globals.cs |-\u003e Extensions |-\u003e UIControlledApplicaiton_Ext.cs |-\u003e RibbonPanel_Ext.cs // Update |-\u003e PulldownButton_Ext.cs // Create New Extension Class |-\u003e Resources |-\u003e Files |-\u003e Tooltips.resx // Update |-\u003e Icons |-\u003e Icons16 |-\u003e General_test16.png |-\u003e Icons32 |-\u003e General_test32.png |-\u003e Utilities |-\u003e Ribbon_Utils.cs // Update |-\u003e Application.cs // Update |-\u003e guRoo.addin Cmd_PullDown.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace guRoo.Cmds_PullDown { /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_1Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(\"Button 1 is Working!\", doc.Title); // Final return here: return Result.Succeeded; } } /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_2Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(\"Button 2 is Working!\", doc.Title); // Final return here: return Result.Succeeded; } } /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_3Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show(\"Button 3 is Working!\", doc.Title); // Final return here: return Result.Succeeded; } } } RibbonPanel_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class RibbonPanel_Ext { # region Add Button Creation /// /// Adds a Pushbutton to the panel. /// /// The related Command class. /// The RibbonPanel (extended). /// The name for the button. /// The availability name. /// The icon suffix (none by default). /// A Pushbutton object. public static PushButton Ext_AddPushButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (panel.AddItem(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } } /// /// Adds a PulldownButton to the panel. /// /// The related Command class. /// The RibbonPanel (extended). /// The name for the button. /// The availability name. /// The icon suffix (none by default). /// A PulldownButton object. public static PulldownButton Ext_AddPulldownButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } // Create a Data Object var pulldownButtonData = gRib.NewPulldownButtonData(buttonName, className); if (panel.AddItem(pulldownButtonData) is PulldownButton pulldownButton) { // If the button was made, return it. return pulldownButton; } else { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } } #endregion } } PulldownButton_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class PulldownButton_Ext { # region Add Button Creation /// /// Adds a PulldownButton to the panel. /// /// The related Command class. /// The RibbonPanel to add the button to (Extended). /// The name for the button. /// The full class name the button runs. /// A PulldownButton object. public static PushButton Ext_AddPushButton(this PulldownButton pulldownButton, string buttonName, string className) { if (pulldownButton is null) { Debug.WriteLine($\"Error: Could not add {buttonName} to pulldown.\"); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (pulldownButton.AddPushButton(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($\"Error: Could not add {buttonName} to pulldown.\"); return null; } } #endregion } } Tooltips.resx Name Value Comment General_Test This is a working tooltip.\nWe can do extra lines. General_Test2 This is a working tooltip.\nWe can do extra lines. PullDown This is a PulldownButton PullDown_1Button This is Button 1 of the Pulldown Button. PullDown_2Button This is Button 2 of the Pulldown Button. PullDown_3Button This is Button 3 of the Pulldown Button. Ribbon_Utils.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 using Autodesk.Revit.UI; using System; using System.Diagnostics; using System.Windows.Media; using System.Windows.Media.Imaging; namespace guRoo.Utilities { public static class Ribbon_Utils { #region PushButton Data /// /// Create a PushButtonData object. /// /// The name for the button. /// The availability name. /// A PushButtonData object. public static PushButtonData NewPushButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className); // Set the values pushButtonData.ToolTip = LookupTooltip(baseName); pushButtonData.Image = GetIcon(baseName, resolution: 16); pushButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pushButtonData; } #endregion #region Pulldown Data /// /// Create a PulldownButtonData object. /// /// The name for the button. /// The availability name. /// A PulldownButtonData object. public static PulldownButtonData NewPulldownButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pulldownButtonData = new PulldownButtonData(baseName, buttonName); // Set the values pulldownButtonData.ToolTip = LookupTooltip(baseName); pulldownButtonData.Image = GetIcon(baseName, resolution: 16); pulldownButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pulldownButtonData; } #endregion #region Method to get the base name of a command public static string CommandToBaseName(string commandName) { return commandName.Replace(\"guRoo.Cmds_\", \"\").Replace(\".Cmd\", \"\"); } // Method to get a value from a dictionary key public static string LookupTooltip(string key, string failValue = null) { failValue ??= \"No tooltip value was found.\"; // ??= -\u003e if this is null set it to the following if (Globals.Tooltips.TryGetValue(key, out string value)) { return value; } return failValue; } #endregion #region Method to get an icon as an image source public static ImageSource GetIcon(string baseName, int resolution = 32) { var resourcePath = $\"guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png\"; using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath)) { if (stream is null) { return null; } var decoder = new PngBitmapDecoder( stream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); if (decoder.Frames.Count \u003e 0) { return decoder.Frames.First(); } else { return null; } } } #endregion } } Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips(\"guRoo.Resources.Files.Tooltips\"); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, \"General\"); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton(\"Testing\", \"guRoo.Cmds_General.Cmd_Test\"); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton(\"PullDown\", \"guRoo.Cmds_PullDown\"); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton(\"Button 1\", \"guRoo.Cmds_PullDown.Cmd_1Button\"); pulldownTest.Ext_AddPushButton(\"Button 2\", \"guRoo.Cmds_PullDown.Cmd_2Button\"); pulldownTest.Ext_AddPushButton(\"Button 3\", \"guRoo.Cmds_PullDown.Cmd_3Button\"); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.\n",
  "wordCount" : "1760",
  "inLanguage": "en",
  "image": "http://localhost:1313/LogoAYD.png","datePublished": "2025-08-14T12:02:26+03:00",
  "dateModified": "2025-08-14T12:02:26+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/post-10/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Blog (Alt + H)">Blog</a>
        </div>

        
        <div class="logo main-logo">
            <a href="https://aydrafting.com" target="_blank">
                <img src="/LogoAYD.png" alt="Blog" height="40">
            </a>
        </div>

        
        <div class="logo-switches">
            <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        </div>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      C# &#43; Revit API: Lesson 10 - Create a Pulldown Button
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2025-08-14 12:02:26 +0300 MSK'>August 14, 2025</span>&nbsp;·&nbsp;9 min&nbsp;|&nbsp;<a href="mailto:%20aydimir@aydrafting.com" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#the-goal" aria-label="The Goal">The Goal</a><ul>
                        
                <li>
                    <a href="#what-we-need" aria-label="What we need">What we need</a></li>
                <li>
                    <a href="#related-api-classes" aria-label="Related API Classes">Related API Classes</a></li></ul>
                </li>
                <li>
                    <a href="#homework" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#code" aria-label="Code">Code</a><ul>
                        
                <li>
                    <a href="#project-solution" aria-label="Project Solution">Project Solution</a></li>
                <li>
                    <a href="#cmd_pulldowncs" aria-label="Cmd_PullDown.cs">Cmd_PullDown.cs</a></li>
                <li>
                    <a href="#ribbonpanel_extcs" aria-label="RibbonPanel_Ext.cs">RibbonPanel_Ext.cs</a></li>
                <li>
                    <a href="#pulldownbutton_extcs" aria-label="PulldownButton_Ext.cs">PulldownButton_Ext.cs</a></li>
                <li>
                    <a href="#tooltipsresx" aria-label="Tooltips.resx">Tooltips.resx</a></li>
                <li>
                    <a href="#ribbon_utilscs" aria-label="Ribbon_Utils.cs">Ribbon_Utils.cs</a></li>
                <li>
                    <a href="#applicationcs" aria-label="Application.cs">Application.cs</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="the-goal">The Goal<a hidden class="anchor" aria-hidden="true" href="#the-goal">#</a></h1>
<p><img alt="Pasted image 20250814142840.png" loading="lazy" src="/images/Pasted%20image%2020250814142840.png"></p>
<p>We will create a <code>PulldownButton</code> and add a few <code>PushButtons</code> to it.</p>
<p>We will also create some helper methods to generate <code>ButtonData</code> objects given we are beginning to use these in lots of places.</p>
<p>In the next post we will stack <code>PulldownButtons</code>.</p>
<p><img alt="Pasted image 20250814122745.png" loading="lazy" src="/images/Pasted%20image%2020250814122745.png">
<a href="https://www.youtube.com/watch?v=Zx5Aadrq7RY">Aussie BIM Guru</a></p>
<h2 id="what-we-need">What we need<a hidden class="anchor" aria-hidden="true" href="#what-we-need">#</a></h2>
<ol>
<li>Create a data creation methods,</li>
<li>Add a <code>PulldownButton</code> to our panel,</li>
<li>Add <code>PushButtons</code> to it,</li>
<li>Add <code>Icons</code></li>
</ol>
<h2 id="related-api-classes">Related API Classes<a hidden class="anchor" aria-hidden="true" href="#related-api-classes">#</a></h2>
<ol>
<li><code>RibbonPanel</code>
<ol>
<li><code>PulldownButtonData</code>
<ol>
<li><code>PulldownButton</code></li>
</ol>
</li>
<li><code>PushButtonData</code>
<ol>
<li><code>PushButton</code></li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="homework">Homework<a hidden class="anchor" aria-hidden="true" href="#homework">#</a></h1>
<ol>
<li>Create a <code>static utility</code> methods on the <code>Ribbon_Util.cs</code></li>
<li>Modify a <code>PushButton</code> method to use <code>static utility</code> methods</li>
<li>Create a <code>PulldownButton</code> method</li>
<li>Create a <code>PulldownButton</code> method <code>Extension</code> class to add <code>PushButton</code> to <code>PulldownButton</code></li>
<li>Update the <code>Strartup</code> method</li>
</ol>
<h1 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h1>
<h2 id="code">Code<a hidden class="anchor" aria-hidden="true" href="#code">#</a></h2>
<h3 id="project-solution"><code>Project Solution</code><a hidden class="anchor" aria-hidden="true" href="#project-solution">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Solution
</span></span><span class="line"><span class="cl"><span class="p">|</span>-&gt; guRoo
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Dependencies
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Commands
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; General 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_General.cs 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_PullDown.cs  // Create a New Class
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Forms
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; General 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Globals.cs 
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Extensions 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; UIControlledApplicaiton_Ext.cs 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; RibbonPanel_Ext.cs    // Update
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; PulldownButton_Ext.cs // Create New Extension Class
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Resources
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Files 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Tooltips.resx     // Update
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons16 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; General_test16.png 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons32 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; General_test32.png 
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Utilities
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Ribbon_Utils.cs       // Update
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Application.cs            // Update
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; guRoo.addin
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmd_pulldowncs"><code>Cmd_PullDown.cs</code><a hidden class="anchor" aria-hidden="true" href="#cmd_pulldowncs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Cmds_PullDown</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_1Button</span> <span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">CommandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Code logic here:</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Button 1 is Working!&#34;</span><span class="p">,</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return here:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_2Button</span> <span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">CommandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Code logic here:</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Button 2 is Working!&#34;</span><span class="p">,</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return here:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_3Button</span> <span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">CommandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Code logic here:</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Button 3 is Working!&#34;</span><span class="p">,</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return here:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ribbonpanel_extcs"><code>RibbonPanel_Ext.cs</code><a hidden class="anchor" aria-hidden="true" href="#ribbonpanel_extcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gRib</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Ribbon_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Extensions</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">RibbonPanel_Ext</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="cp"># region</span> <span class="n">Add</span> <span class="n">Button</span> <span class="n">Creation</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// Adds a Pushbutton to the panel.</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;returns&gt;A Pushbutton object.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">PushButton</span> <span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="k">this</span> <span class="n">RibbonPanel</span> <span class="n">panel</span><span class="p">,</span> <span class="kt">string</span> <span class="n">buttonName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">panel</span> <span class="k">is</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not create {buttonName}.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Create a Data Object</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pushButtonData</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">NewPushButtonData</span><span class="p">(</span><span class="n">buttonName</span><span class="p">,</span> <span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">panel</span><span class="p">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">pushButtonData</span><span class="p">)</span> <span class="k">is</span> <span class="n">PushButton</span> <span class="n">pushButton</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// If the button was made, return it.</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">pushButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not create {buttonName}.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// Adds a PulldownButton to the panel.</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;ribbonPanel&#34;&gt;The RibbonPanel (extended).&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;availability&#34;&gt;The availability name.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;suffix&#34;&gt;The icon suffix (none by default).&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">PulldownButton</span> <span class="n">Ext_AddPulldownButton</span><span class="p">(</span><span class="k">this</span> <span class="n">RibbonPanel</span> <span class="n">panel</span><span class="p">,</span> <span class="kt">string</span> <span class="n">buttonName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">panel</span> <span class="k">is</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not create {buttonName}.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Create a Data Object</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pulldownButtonData</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">NewPulldownButtonData</span><span class="p">(</span><span class="n">buttonName</span><span class="p">,</span> <span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">panel</span><span class="p">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">pulldownButtonData</span><span class="p">)</span> <span class="k">is</span> <span class="n">PulldownButton</span> <span class="n">pulldownButton</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// If the button was made, return it.</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">pulldownButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not create {buttonName}.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pulldownbutton_extcs"><code>PulldownButton_Ext.cs</code><a hidden class="anchor" aria-hidden="true" href="#pulldownbutton_extcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gRib</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Ribbon_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Extensions</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">PulldownButton_Ext</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="cp"># region</span> <span class="n">Add</span> <span class="n">Button</span> <span class="n">Creation</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// Adds a PulldownButton to the panel.</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;typeparam name=&#34;CommandClass&#34;&gt;The related Command class.&lt;/typeparam&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;pulldownButton&#34;&gt;The RibbonPanel to add the button to (Extended).&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;className&#34;&gt;The full class name the button runs.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;returns&gt;A PulldownButton object.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">PushButton</span> <span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="k">this</span> <span class="n">PulldownButton</span> <span class="n">pulldownButton</span><span class="p">,</span> <span class="kt">string</span> <span class="n">buttonName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">pulldownButton</span> <span class="k">is</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not add {buttonName} to pulldown.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Create a Data Object</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pushButtonData</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">NewPushButtonData</span><span class="p">(</span><span class="n">buttonName</span><span class="p">,</span> <span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">pulldownButton</span><span class="p">.</span><span class="n">AddPushButton</span><span class="p">(</span><span class="n">pushButtonData</span><span class="p">)</span> <span class="k">is</span> <span class="n">PushButton</span> <span class="n">pushButton</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// If the button was made, return it.</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">pushButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not add {buttonName} to pulldown.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="tooltipsresx"><code>Tooltips.resx</code><a hidden class="anchor" aria-hidden="true" href="#tooltipsresx">#</a></h3>
<table>
  <thead>
      <tr>
          <th style="text-align: center">Name</th>
          <th>Value</th>
          <th>Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">General_Test</td>
          <td>This is a working tooltip.<br><br>We can do extra lines.</td>
          <td></td>
      </tr>
      <tr>
          <td style="text-align: center">General_Test2</td>
          <td>This is a working tooltip.<br><br>We can do extra lines.</td>
          <td></td>
      </tr>
      <tr>
          <td style="text-align: center">PullDown</td>
          <td>This is a PulldownButton</td>
          <td></td>
      </tr>
      <tr>
          <td style="text-align: center">PullDown_1Button</td>
          <td>This is Button 1 of the Pulldown Button.</td>
          <td></td>
      </tr>
      <tr>
          <td style="text-align: center">PullDown_2Button</td>
          <td>This is Button 2 of the Pulldown Button.</td>
          <td></td>
      </tr>
      <tr>
          <td style="text-align: center">PullDown_3Button</td>
          <td>This is Button 3 of the Pulldown Button.</td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="ribbon_utilscs"><code>Ribbon_Utils.cs</code><a hidden class="anchor" aria-hidden="true" href="#ribbon_utilscs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Windows.Media</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Windows.Media.Imaging</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Utilities</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Ribbon_Utils</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">PushButton</span> <span class="n">Data</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// Create a PushButtonData object.</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;returns&gt;A PushButtonData object.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">PushButtonData</span> <span class="n">NewPushButtonData</span><span class="p">(</span><span class="kt">string</span> <span class="n">buttonName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">baseName</span> <span class="p">=</span> <span class="n">CommandToBaseName</span><span class="p">(</span><span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pushButtonData</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PushButtonData</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">buttonName</span><span class="p">,</span> <span class="n">Globals</span><span class="p">.</span><span class="n">AssemblyPath</span><span class="p">,</span> <span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Set the values</span>
</span></span><span class="line"><span class="cl">            <span class="n">pushButtonData</span><span class="p">.</span><span class="n">ToolTip</span> <span class="p">=</span> <span class="n">LookupTooltip</span><span class="p">(</span><span class="n">baseName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pushButtonData</span><span class="p">.</span><span class="n">Image</span> <span class="p">=</span> <span class="n">GetIcon</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="m">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pushButtonData</span><span class="p">.</span><span class="n">LargeImage</span> <span class="p">=</span> <span class="n">GetIcon</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="m">32</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">pushButtonData</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Pulldown</span> <span class="n">Data</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// Create a PulldownButtonData object.</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;buttonName&#34;&gt;The name for the button.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;className&#34;&gt;The availability name.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;returns&gt;A PulldownButtonData object.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">PulldownButtonData</span> <span class="n">NewPulldownButtonData</span><span class="p">(</span><span class="kt">string</span> <span class="n">buttonName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">baseName</span> <span class="p">=</span> <span class="n">CommandToBaseName</span><span class="p">(</span><span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pulldownButtonData</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PulldownButtonData</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">buttonName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Set the values</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownButtonData</span><span class="p">.</span><span class="n">ToolTip</span> <span class="p">=</span> <span class="n">LookupTooltip</span><span class="p">(</span><span class="n">baseName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownButtonData</span><span class="p">.</span><span class="n">Image</span> <span class="p">=</span> <span class="n">GetIcon</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="m">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownButtonData</span><span class="p">.</span><span class="n">LargeImage</span> <span class="p">=</span> <span class="n">GetIcon</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="m">32</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">pulldownButtonData</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Method</span> <span class="n">to</span> <span class="k">get</span> <span class="n">the</span> <span class="k">base</span> <span class="n">name</span> <span class="n">of</span> <span class="n">a</span> <span class="n">command</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">CommandToBaseName</span><span class="p">(</span><span class="kt">string</span> <span class="n">commandName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">commandName</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;guRoo.Cmds_&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">).</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;.Cmd&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to get a value from a dictionary key</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">LookupTooltip</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">string</span> <span class="n">failValue</span> <span class="p">=</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">failValue</span> <span class="p">??=</span> <span class="s">&#34;No tooltip value was found.&#34;</span><span class="p">;</span> <span class="c1">// ??= -&gt; if this is null set it to the following</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">Globals</span><span class="p">.</span><span class="n">Tooltips</span><span class="p">.</span><span class="n">TryGetValue</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="k">out</span> <span class="kt">string</span> <span class="k">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">failValue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Method</span> <span class="n">to</span> <span class="k">get</span> <span class="n">an</span> <span class="n">icon</span> <span class="k">as</span> <span class="n">an</span> <span class="n">image</span> <span class="n">source</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">ImageSource</span> <span class="n">GetIcon</span><span class="p">(</span><span class="kt">string</span> <span class="n">baseName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">resolution</span> <span class="p">=</span> <span class="m">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">resourcePath</span> <span class="p">=</span> <span class="s">$&#34;guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">Globals</span><span class="p">.</span><span class="n">Assembly</span><span class="p">.</span><span class="n">GetManifestResourceStream</span><span class="p">(</span><span class="n">resourcePath</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">stream</span> <span class="k">is</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">decoder</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PngBitmapDecoder</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">stream</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">BitmapCreateOptions</span><span class="p">.</span><span class="n">PreservePixelFormat</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">BitmapCacheOption</span><span class="p">.</span><span class="n">Default</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">decoder</span><span class="p">.</span><span class="n">Frames</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="n">decoder</span><span class="p">.</span><span class="n">Frames</span><span class="p">.</span><span class="n">First</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="applicationcs"><code>Application.cs</code><a hidden class="anchor" aria-hidden="true" href="#applicationcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI.Events</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// guRoo</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gRib</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Ribbon_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">guRoo.Extensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// This application belongs to the root namespace</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Implementing the interface for application.cs class</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Application</span> <span class="p">:</span> <span class="n">IExternalApplication</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// IExternalApplication for the interface</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Make a private uiCtlApp method:</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">static</span> <span class="n">UIControlledApplication</span> <span class="n">_uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//This will return a result on Startup method - requires uiCtlApp</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cp">#region</span> <span class="n">Globals</span> <span class="n">registration</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Store _uiCtlApp, register on idling</span>
</span></span><span class="line"><span class="cl">            <span class="n">_uiCtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">try</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">+=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">catch</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Register Globals</span>
</span></span><span class="line"><span class="cl">            <span class="n">Globals</span><span class="p">.</span><span class="n">RegisterProperties</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Register Tooltips</span>
</span></span><span class="line"><span class="cl">            <span class="n">Globals</span><span class="p">.</span><span class="n">RegisterTooltips</span><span class="p">(</span><span class="s">&#34;guRoo.Resources.Files.Tooltips&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cp">#region</span> <span class="n">Ribbon</span> <span class="n">setup</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Add RibbonTab</span>
</span></span><span class="line"><span class="cl">            <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">Ext_AddRibbonTab</span><span class="p">(</span><span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Create RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">panelGeneral</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">Ext_AddRibbonPanel</span><span class="p">(</span><span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">,</span> <span class="s">&#34;General&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Add PushButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">buttonTest</span> <span class="p">=</span> <span class="n">panelGeneral</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Testing&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_General.Cmd_Test&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Add PulldownButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pulldownTest</span> <span class="p">=</span> <span class="n">panelGeneral</span><span class="p">.</span><span class="n">Ext_AddPulldownButton</span><span class="p">(</span><span class="s">&#34;PullDown&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Add Buttons to Pulldown</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownTest</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button 1&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownTest</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button 2&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownTest</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button 3&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span> <span class="c1">// or Cancelled</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">On</span> <span class="n">shutdown</span> <span class="n">method</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// This will urn on shutdown</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">OnShutdown</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Use</span> <span class="n">idling</span> <span class="n">to</span> <span class="n">register</span> <span class="n">UiApp</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// On idling, register UiApp/username</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">RegisterUiApp</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">IdlingEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">-=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">sender</span> <span class="k">is</span> <span class="n">UIApplication</span> <span class="n">uiApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<blockquote>
<p>These tutorials were inspired by the work of <a href="https://www.youtube.com/@AussieBIMGuru">Aussie BIM Guru</a>. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.</p></blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/c%23/">C#</a></li>
      <li><a href="http://localhost:1313/tags/revit/">Revit</a></li>
      <li><a href="http://localhost:1313/tags/tutorial/">Tutorial</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/post-11/">
    <span class="title">« Prev</span>
    <br>
    <span>C# &#43; Revit API: Lesson 11 - Stacking Buttons</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/lesson-9/">
    <span class="title">Next »</span>
    <br>
    <span>C# &#43; Revit API: Lesson 9 - Static vs. Extension Methods</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© 2025 AYDrafting. All rights reserved.</span> · 

    <span>
        Powered by
        <a href="https://aydrafting.com/" rel="noopener noreferrer" target="_blank">AYDrafting</a> &
        <a href="https://github.com/aydimir95/" rel="noopener" target="_blank">GitHub</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
