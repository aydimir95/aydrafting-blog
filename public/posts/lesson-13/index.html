<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>C# &#43; Revit API: Lesson 13 - MessageBox Forms | Blog</title>
<meta name="keywords" content="C#, Revit, Tutorial">
<meta name="description" content="
MessageBox Forms - needed to send alerts to the user from our add-in.

Before, we were using TaskDialog to convey outcomes to the user when they run our tools. It&rsquo;s ok for the basic processes but lacks the level of interaction we need.
We will use a MessageBox form to address this and contain it within a custom method we can easily call on and customize further.

MessageBox Anatomy
">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/lesson-13/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css" integrity="sha256-bVhUcqQJqPUE5r&#43;Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/lesson-13/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/lesson-13/">
  <meta property="og:site_name" content="Blog">
  <meta property="og:title" content="C# &#43; Revit API: Lesson 13 - MessageBox Forms">
  <meta property="og:description" content=" MessageBox Forms - needed to send alerts to the user from our add-in.
Before, we were using TaskDialog to convey outcomes to the user when they run our tools. It’s ok for the basic processes but lacks the level of interaction we need. We will use a MessageBox form to address this and contain it within a custom method we can easily call on and customize further. MessageBox Anatomy ">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-01T15:50:07+03:00">
    <meta property="article:modified_time" content="2025-09-01T15:50:07+03:00">
    <meta property="article:tag" content="C#">
    <meta property="article:tag" content="Revit">
    <meta property="article:tag" content="Tutorial">
    <meta property="og:image" content="http://localhost:1313/images/Pasted%20image%2020250901160911.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/Pasted%20image%2020250901160911.png">
<meta name="twitter:title" content="C# &#43; Revit API: Lesson 13 - MessageBox Forms">
<meta name="twitter:description" content="
MessageBox Forms - needed to send alerts to the user from our add-in.

Before, we were using TaskDialog to convey outcomes to the user when they run our tools. It&rsquo;s ok for the basic processes but lacks the level of interaction we need.
We will use a MessageBox form to address this and contain it within a custom method we can easily call on and customize further.

MessageBox Anatomy
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "C# + Revit API: Lesson 13 - MessageBox Forms",
      "item": "http://localhost:1313/posts/lesson-13/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C# + Revit API: Lesson 13 - MessageBox Forms",
  "name": "C# \u002b Revit API: Lesson 13 - MessageBox Forms",
  "description": " MessageBox Forms - needed to send alerts to the user from our add-in.\nBefore, we were using TaskDialog to convey outcomes to the user when they run our tools. It\u0026rsquo;s ok for the basic processes but lacks the level of interaction we need. We will use a MessageBox form to address this and contain it within a custom method we can easily call on and customize further. MessageBox Anatomy ",
  "keywords": [
    "C#", "Revit", "Tutorial"
  ],
  "articleBody": " MessageBox Forms - needed to send alerts to the user from our add-in.\nBefore, we were using TaskDialog to convey outcomes to the user when they run our tools. It’s ok for the basic processes but lacks the level of interaction we need. We will use a MessageBox form to address this and contain it within a custom method we can easily call on and customize further. MessageBox Anatomy We will use a custom method to make a more flexible form with multiple options, icons etc. Microsoft/DotNet Docs Most things we will use that are related to Windows tend to fall under the System library. We will need to get used to consulting the dotnet Docs as well as Revit API Docs for many things in the future. Example: MessageBox Class 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 private void Form1_FormClosing(object sender, FormClosingEventArgs e) { const string message = \"Are you sure that you would like to close the form?\"; const string caption = \"Form Closing\"; var result = MessageBox.Show( message, caption, MessageBoxButtons.YesNo, // MessageBoxButtons Enum MessageBoxIcon.Question); // MessageBoxIcons Enum // If the no button was pressed ... if (result == Dialog.No) // DialogResult Enum { // cancel the closure of the form. e.Cancel = true; } } DialogResult Enum Name Value Description None 0 Nothing is returned from the dialog box. This means that the modal dialog continues running. OK 1 The dialog box return value is OK (usually sent from a button labeled OK). Cancel 2 The dialog box return value is Cancel (usually sent from a button labeled Cancel). Abort 3 The dialog box return value is Abort (usually sent from a button labeled Abort). Retry 4 The dialog box return value is Retry (usually sent from a button labeled Retry). Ignore 5 The dialog box return value is Ignore (usually sent from a button labeled Ignore). Yes 6 The dialog box return value is Yes (usually sent from a button labeled Yes). No 7 The dialog box return value is No (usually sent from a button labeled No). TryAgain 10 The dialog box return value is Try Again (usually sent from a button labeled Try Again). Continue 11 The dialog box return value is Continue (usually sent from a button labeled Continue). MessageBoxButtons Enum Name Value Description OK 0 The message box contains an OK button. OKCancel 1 The message box contains OK and Cancel buttons. AbortRetryIgnore 2 The message box contains Abort, Retry, and Ignore buttons. YesNoCancel 3 The message box contains Yes, No, and Cancel buttons. YesNo 4 The message box contains Yes and No buttons. RetryCancel 5 The message box contains Retry and Cancel buttons. CancelTryContinue 6 Specifies that the message box contains Cancel, Try Again, and Continue buttons. MessageBoxIcons Enum Name Value Description None 0 The message box contains no symbols. Error 16 The message box contains a symbol consisting of white X in a circle with a red background. Hand 16 The message box contains a symbol consisting of a white X in a circle with a red background. Stop 16 The message box contains a symbol consisting of white X in a circle with a red background. Question 32 The message box contains a symbol consisting of a question mark in a circle. The question mark message icon is no longer recommended because it does not clearly represent a specific type of message and because the phrasing of a message as a question could apply to any message type. In addition, users can confuse the question mark symbol with a help information symbol. Therefore, do not use this question mark symbol in your message boxes. The system continues to support its inclusion only for backward compatibility. Exclamation 48 The message box contains a symbol consisting of an exclamation point in a triangle with a yellow background. Warning 48 The message box contains a symbol consisting of an exclamation point in a triangle with a yellow background. Asterisk 64 The message box contains a symbol consisting of a lowercase letter i in a circle. Information 64 The message box contains a symbol consisting of a lowercase letter i in a circle. FormResult Class from Lesson 4 We will always have our forms return a consistent custom object which tells us: If the form was cancelled, valid, affirmative If there are object(s) returned If there is a single object returned Homework Tidy up the FormResult Class Set up a Custom Method Develop fixed variants Solution Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Solution |-\u003e ViewOnSheets2025 |-\u003e Dependencies |-\u003e Properties |-\u003e Commands |-\u003e Cmd_Button.cs # Update |-\u003e Forms |-\u003e Custom.cs # Update |-\u003e Extensions |-\u003e General |-\u003e Models |-\u003e Resources |-\u003e Services |-\u003e Utilities |-\u003e Views |-\u003e Application.cs |-\u003e Host.cs |-\u003e guRoo.addin Custom.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; using System.Windows.Forms; // Might need to add the Forms in Assemblies namespace guRoo.Forms { public static class Custom { /// /// /// /// /// /// /// /// /// public static FormResult Message( string title = null, string message = null, message = null, bool yesNo = false, bool noCancel = false, MessageBoxIcon icon = MessageBoxIcon.None) // by default = no icons { var formResult = new FromResult(isValid: false); title ??= \"Message\"; message ??= \"No message was provided.\"; if (yesNo \u0026\u0026 icon == MessageBoxIcon.None) { icon = MessageBoxIcon.Question; } buttons = MessageBoxButtons.OKCancel; if (noCancel) { buttons = MessageBoxButtons.OK; } else if (yesNo) { buttons = MessageBoxButtons.YesNo; } var dialogResult = MessageBox.Show( message, title, buttons, icon); if (dialogResult == DialogResult.Yes || dialogResult == DialogResult.OK) { formResult.Validate(); return formResult; } } /// /// /// /// /// public static Result Completed(string message) { Message( title: \"Task Completed\", message: message, yesNo: false, noCancel: true icon: MessageBoxIcon.Information); return Result.Succeded; } /// /// /// /// /// public static Result Cancelled(string message) { Message( title: \"Task Cancelled\", message: message, yesNo: false, noCancel: true icon: MessageBoxIcon.Warning); return Result.Cancelled; } /// /// /// /// /// public static Result Error(string message) { Message( title: \"Error\", message: message, yesNo: false, noCancel: true icon: MessageBoxIcon.Error); return Result.Cancelled; } } public class FormResult { public object Object{ get; set; } public List\u003cobject\u003e Objects { get; set; } public bool Cancelled { get; set; } public bool Valid { get; set; } public bool Affirmative { get; set; } // Constructor (Default) public FormResult() { this.Object = null; this.Objects = new List\u003cobject\u003e(); this.Cancelled = true; this.Valid = false; this.Affirmative = false; } // Constructor (Alternative) public FormResult(bool isValid) { this.Object = null; this.Objects = new List\u003cobject\u003e(); this.Cancelled = !isValid; this.Valid = isValid; this.Affirmative = isValid; } // Method to validate public void Validate() { this.Cancelled = true; this.Valid = true; this.Affirmative = true; } // Method to validate public void Validate(object obj) { this.Validate(); this.Object = obj; } // Method to validate public void Validate(List\u003cobject\u003e objs) { this.Validate(); this.Objects = objs; } } } Cmds_Button.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; using Autodesk.Revit.DB; //UKON using UKON.Extensions; using gFrm = guRoo.Forms; // Associate with PushButton Commands namespace guRoo.Commands.General { /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_Test : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { // Collect the Document and Application objects from the CommandData var (uiApp, uiDoc, doc) = CommandData.Ext_GetRevitContext(); // Collect all walls var walls = new FilteredElementCollector(doc) .OfClass(typeof(Wall)) .WhereElementIsNotElementType() .ToElements(); // Show the message dialog with the document title gFrm.Custom.Message( doc.Title, $\"We have {walls.Count} walls in the model\" ); // Collect all walls lower than 12 feet // First: Construct a filter for .WherePasses() Method var parameterId = new ElementId(BuiltInParameter.WALL_USER_HEIGHT_PARAM); var provider = new ParameterValueProvider(parameterId); var rule = new FilterNumericLess(); var passesRule = new FilterDoubleRule(provider, rule, 12, 0.1); var paramFilter = new ElementParameterFilter(passesRule); // Then: Apply the filter to the FilteredElementCollector var wallsFiltered = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Walls) .WhereElementIsNotElementType() .WherePasses(paramFilter) .ToElements(); // Show the message dialog with different warning MessageBoxes var yesNoResult = uFrm.Custom.Message(doc.Title, $\"We have {wallsFiltered.Count} walls less than 12 feet in the model\", yesNo: true); if (yesNoResult.Cancelled) { return Result.Cancelled; } if (yesNoResult.Cancelled) { return gFrm.Custom.Cancelled(\"\\'No\\' was chosen.\"); } gFrm.Custom.Error(\"An error did not occur, just showing this form.\"); return gFrm.Custom.Completed(\"Script completed\"); } } } ",
  "wordCount" : "1639",
  "inLanguage": "en",
  "image":"http://localhost:1313/images/Pasted%20image%2020250901160911.png","datePublished": "2025-09-01T15:50:07+03:00",
  "dateModified": "2025-09-01T15:50:07+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/lesson-13/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Blog (Alt + H)">Blog</a>
        </div>

        
        <div class="logo main-logo">
            <a href="https://aydrafting.com" target="_blank">
                <img src="/LogoAYD.png" alt="Blog" height="40">
            </a>
        </div>

        
        <div class="logo-switches">
            <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        </div>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      C# &#43; Revit API: Lesson 13 - MessageBox Forms
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='Created: 2025-09-01 15:50:07 +0300 MSK'>September 1, 2025</span>&nbsp;·&nbsp;8 min&nbsp;|&nbsp;<a href="mailto:%20aydimir@aydrafting.com" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/images/Pasted%20image%2020250901160911.png" alt="MessageBox Forms in C# and Revit API">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#messagebox-anatomy" aria-label="MessageBox Anatomy">MessageBox Anatomy</a></li>
                <li>
                    <a href="#microsoftdotnet-docs" aria-label="Microsoft/DotNet Docs">Microsoft/DotNet Docs</a><ul>
                        
                <li>
                    <a href="#example" aria-label="Example:">Example:</a><ul>
                        
                <li>
                    <a href="#messagebox-class" aria-label="MessageBox Class">MessageBox Class</a></li>
                <li>
                    <a href="#dialogresult-enum" aria-label="DialogResult Enum">DialogResult Enum</a></li>
                <li>
                    <a href="#messageboxbuttons-enum" aria-label="MessageBoxButtons Enum">MessageBoxButtons Enum</a></li>
                <li>
                    <a href="#messageboxicons-enum" aria-label="MessageBoxIcons Enum">MessageBoxIcons Enum</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#formresult-class-from-lesson-4" aria-label="FormResult Class from Lesson 4">FormResult Class from Lesson 4</a></li>
                <li>
                    <a href="#homework" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution" aria-label="Solution">Solution</a><ul>
                        <ul>
                        
                <li>
                    <a href="#project-solution" aria-label="Project Solution">Project Solution</a></li>
                <li>
                    <a href="#customcs" aria-label="Custom.cs">Custom.cs</a></li>
                <li>
                    <a href="#cmds_buttoncs" aria-label="Cmds_Button.cs">Cmds_Button.cs</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p><code>MessageBox Forms</code> - needed to send alerts to the user from our add-in.</p></blockquote>
<ul>
<li>Before, we were using <code>TaskDialog</code> to convey outcomes to the user when they run our tools. It&rsquo;s ok for the basic processes but lacks the level of interaction we need.</li>
<li>We will use a <code>MessageBox</code> form to address this and contain it within a custom method we can easily call on and customize further.</li>
</ul>
<h1 id="messagebox-anatomy"><code>MessageBox</code> Anatomy<a hidden class="anchor" aria-hidden="true" href="#messagebox-anatomy">#</a></h1>
<p><img alt="Pasted image 20250901160911.png" loading="lazy" src="/images/Pasted%20image%2020250901160911.png"></p>
<ul>
<li>We will use a custom <code>method</code> to make a more flexible form with multiple options, icons etc.</li>
</ul>
<h1 id="microsoftdotnet-docs"><a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox?view=windowsdesktop-9.0">Microsoft/DotNet Docs</a><a hidden class="anchor" aria-hidden="true" href="#microsoftdotnet-docs">#</a></h1>
<ul>
<li>Most things we will use that are related to Windows tend to fall under the <code>System</code> library.</li>
<li>We will need to get used to consulting the <code>dotnet</code> Docs as well as <code>Revit API</code> Docs for many things in the future.</li>
</ul>
<h2 id="example">Example:<a hidden class="anchor" aria-hidden="true" href="#example">#</a></h2>
<h3 id="messagebox-class"><code>MessageBox</code> Class<a hidden class="anchor" aria-hidden="true" href="#messagebox-class">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">Form1_FormClosing</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FormClosingEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="kt">string</span> <span class="n">message</span> <span class="p">=</span> 
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Are you sure that you would like to close the form?&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="kd">const</span> <span class="kt">string</span> <span class="n">caption</span> <span class="p">=</span> <span class="s">&#34;Form Closing&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">		<span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="n">caption</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="n">MessageBoxButtons</span><span class="p">.</span><span class="n">YesNo</span><span class="p">,</span>  <span class="c1">// MessageBoxButtons Enum</span>
</span></span><span class="line"><span class="cl">		<span class="n">MessageBoxIcon</span><span class="p">.</span><span class="n">Question</span><span class="p">);</span> <span class="c1">// MessageBoxIcons Enum</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c1">// If the no button was pressed ...</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">==</span> <span class="n">Dialog</span><span class="p">.</span><span class="n">No</span><span class="p">)</span> <span class="c1">// DialogResult Enum</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// cancel the closure of the form.</span>
</span></span><span class="line"><span class="cl">		<span class="n">e</span><span class="p">.</span><span class="n">Cancel</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="dialogresult-enum"><code>DialogResult</code> Enum<a hidden class="anchor" aria-hidden="true" href="#dialogresult-enum">#</a></h3>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>Value</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>None</td>
          <td>0</td>
          <td><code>Nothing</code> is returned from the dialog box. This means that the modal dialog continues running.</td>
      </tr>
      <tr>
          <td>OK</td>
          <td>1</td>
          <td>The dialog box return value is <code>OK</code> (usually sent from a button labeled OK).</td>
      </tr>
      <tr>
          <td>Cancel</td>
          <td>2</td>
          <td>The dialog box return value is <code>Cancel</code> (usually sent from a button labeled Cancel).</td>
      </tr>
      <tr>
          <td>Abort</td>
          <td>3</td>
          <td>The dialog box return value is <code>Abort</code> (usually sent from a button labeled Abort).</td>
      </tr>
      <tr>
          <td>Retry</td>
          <td>4</td>
          <td>The dialog box return value is <code>Retry</code> (usually sent from a button labeled Retry).</td>
      </tr>
      <tr>
          <td>Ignore</td>
          <td>5</td>
          <td>The dialog box return value is <code>Ignore</code> (usually sent from a button labeled Ignore).</td>
      </tr>
      <tr>
          <td>Yes</td>
          <td>6</td>
          <td>The dialog box return value is <code>Yes</code> (usually sent from a button labeled Yes).</td>
      </tr>
      <tr>
          <td>No</td>
          <td>7</td>
          <td>The dialog box return value is <code>No</code> (usually sent from a button labeled No).</td>
      </tr>
      <tr>
          <td>TryAgain</td>
          <td>10</td>
          <td>The dialog box return value is Try Again (usually sent from a button labeled Try Again).</td>
      </tr>
      <tr>
          <td>Continue</td>
          <td>11</td>
          <td>The dialog box return value is Continue (usually sent from a button labeled Continue).</td>
      </tr>
  </tbody>
</table>
<h3 id="messageboxbuttons-enum"><code>MessageBoxButtons</code> Enum<a hidden class="anchor" aria-hidden="true" href="#messageboxbuttons-enum">#</a></h3>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>Value</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>OK</td>
          <td>0</td>
          <td>The message box contains an OK button.</td>
      </tr>
      <tr>
          <td>OKCancel</td>
          <td>1</td>
          <td>The message box contains OK and Cancel buttons.</td>
      </tr>
      <tr>
          <td>AbortRetryIgnore</td>
          <td>2</td>
          <td>The message box contains Abort, Retry, and Ignore buttons.</td>
      </tr>
      <tr>
          <td>YesNoCancel</td>
          <td>3</td>
          <td>The message box contains Yes, No, and Cancel buttons.</td>
      </tr>
      <tr>
          <td>YesNo</td>
          <td>4</td>
          <td>The message box contains Yes and No buttons.</td>
      </tr>
      <tr>
          <td>RetryCancel</td>
          <td>5</td>
          <td>The message box contains Retry and Cancel buttons.</td>
      </tr>
      <tr>
          <td>CancelTryContinue</td>
          <td>6</td>
          <td>Specifies that the message box contains Cancel, Try Again, and Continue buttons.</td>
      </tr>
  </tbody>
</table>
<h3 id="messageboxicons-enum"><code>MessageBoxIcons</code> Enum<a hidden class="anchor" aria-hidden="true" href="#messageboxicons-enum">#</a></h3>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>Value</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>None</td>
          <td>0</td>
          <td>The message box contains no symbols.</td>
      </tr>
      <tr>
          <td>Error</td>
          <td>16</td>
          <td>The message box contains a symbol consisting of white X in a circle with a red background.</td>
      </tr>
      <tr>
          <td>Hand</td>
          <td>16</td>
          <td>The message box contains a symbol consisting of a white X in a circle with a red background.</td>
      </tr>
      <tr>
          <td>Stop</td>
          <td>16</td>
          <td>The message box contains a symbol consisting of white X in a circle with a red background.</td>
      </tr>
      <tr>
          <td>Question</td>
          <td>32</td>
          <td>The message box contains a symbol consisting of a question mark in a circle. The question mark message icon is no longer recommended because it does not clearly represent a specific type of message and because the phrasing of a message as a question could apply to any message type. In addition, users can confuse the question mark symbol with a help information symbol. Therefore, do not use this question mark symbol in your message boxes. The system continues to support its inclusion only for backward compatibility.</td>
      </tr>
      <tr>
          <td>Exclamation</td>
          <td>48</td>
          <td>The message box contains a symbol consisting of an exclamation point in a triangle with a yellow background.</td>
      </tr>
      <tr>
          <td>Warning</td>
          <td>48</td>
          <td>The message box contains a symbol consisting of an exclamation point in a triangle with a yellow background.</td>
      </tr>
      <tr>
          <td>Asterisk</td>
          <td>64</td>
          <td>The message box contains a symbol consisting of a lowercase letter i in a circle.</td>
      </tr>
      <tr>
          <td>Information</td>
          <td>64</td>
          <td>The message box contains a symbol consisting of a lowercase letter i in a circle.</td>
      </tr>
  </tbody>
</table>
<h1 id="formresult-class-from-lesson-4"><code>FormResult</code> Class from <code>Lesson 4</code><a hidden class="anchor" aria-hidden="true" href="#formresult-class-from-lesson-4">#</a></h1>
<ul>
<li>We will always have our <code>forms</code> return a consistent custom object which tells us:
<ul>
<li>If the form was <code>cancelled</code>, <code>valid</code>, <code>affirmative</code></li>
<li>If there are <code>object(s)</code> returned</li>
<li>If there is a single <code>object</code> returned</li>
</ul>
</li>
</ul>
<h1 id="homework">Homework<a hidden class="anchor" aria-hidden="true" href="#homework">#</a></h1>
<ul>
<li>Tidy up the FormResult Class</li>
<li>Set up a Custom Method</li>
<li>Develop fixed variants</li>
</ul>
<h1 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h1>
<h3 id="project-solution"><code>Project Solution</code><a hidden class="anchor" aria-hidden="true" href="#project-solution">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Solution
</span></span><span class="line"><span class="cl"><span class="p">|</span>-&gt; ViewOnSheets2025
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Dependencies
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Properties
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Commands
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Cmd_Button.cs <span class="c1"># Update</span>
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Forms
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Custom.cs     <span class="c1"># Update</span>
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Extensions
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; General 
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Models
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Resources
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Services
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Utilities
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Views
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Application.cs  
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Host.cs         
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; guRoo.addin
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="customcs"><code>Custom.cs</code><a hidden class="anchor" aria-hidden="true" href="#customcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Windows.Forms</span><span class="p">;</span> <span class="c1">// Might need to add the Forms in Assemblies </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Forms</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Custom</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// </span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;/Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;title&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;message&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;yesNo&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;noCancel&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;icon&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;return&gt;&lt;/return&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">FormResult</span> <span class="n">Message</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">title</span> <span class="p">=</span> <span class="kc">null</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">message</span> <span class="p">=</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="n">message</span> <span class="p">=</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="kt">bool</span> <span class="n">yesNo</span> <span class="p">=</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="kt">bool</span> <span class="n">noCancel</span> <span class="p">=</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="n">MessageBoxIcon</span> <span class="n">icon</span> <span class="p">=</span> <span class="n">MessageBoxIcon</span><span class="p">.</span><span class="n">None</span><span class="p">)</span> <span class="c1">// by default = no icons</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">formResult</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FromResult</span><span class="p">(</span><span class="n">isValid</span><span class="p">:</span> <span class="kc">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="n">title</span> <span class="p">??=</span> <span class="s">&#34;Message&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">message</span> <span class="p">??=</span> <span class="s">&#34;No message was provided.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">yesNo</span> <span class="p">&amp;&amp;</span> <span class="n">icon</span> <span class="p">==</span> <span class="n">MessageBoxIcon</span><span class="p">.</span><span class="n">None</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">			<span class="p">{</span> 
</span></span><span class="line"><span class="cl">				<span class="n">icon</span> <span class="p">=</span> <span class="n">MessageBoxIcon</span><span class="p">.</span><span class="n">Question</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="n">buttons</span> <span class="p">=</span> <span class="n">MessageBoxButtons</span><span class="p">.</span><span class="n">OKCancel</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">noCancel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">buttons</span> <span class="p">=</span> <span class="n">MessageBoxButtons</span><span class="p">.</span><span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">yesNo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">buttons</span> <span class="p">=</span> <span class="n">MessageBoxButtons</span><span class="p">.</span><span class="n">YesNo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">dialogResult</span> <span class="p">=</span> <span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">				<span class="n">message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">				<span class="n">title</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">				<span class="n">buttons</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">				<span class="n">icon</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">dialogResult</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Yes</span> <span class="p">||</span> 
</span></span><span class="line"><span class="cl">				<span class="n">dialogResult</span> <span class="p">==</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">formResult</span><span class="p">.</span><span class="n">Validate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="n">formResult</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// </span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;/Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;message&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;return&gt;&lt;/return&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">Result</span> <span class="n">Completed</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Message</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">			<span class="n">title</span><span class="p">:</span> <span class="s">&#34;Task Completed&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">message</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">yesNo</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">noCancel</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">			<span class="n">icon</span><span class="p">:</span> <span class="n">MessageBoxIcon</span><span class="p">.</span><span class="n">Information</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// </span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;/Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;message&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;return&gt;&lt;/return&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">Result</span> <span class="n">Cancelled</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Message</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">			<span class="n">title</span><span class="p">:</span> <span class="s">&#34;Task Cancelled&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">message</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">yesNo</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">noCancel</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">			<span class="n">icon</span><span class="p">:</span> <span class="n">MessageBoxIcon</span><span class="p">.</span><span class="n">Warning</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Cancelled</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// </span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;/Summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;message&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;return&gt;&lt;/return&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">Result</span> <span class="n">Error</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Message</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">			<span class="n">title</span><span class="p">:</span> <span class="s">&#34;Error&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">message</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">yesNo</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="n">noCancel</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">			<span class="n">icon</span><span class="p">:</span> <span class="n">MessageBoxIcon</span><span class="p">.</span><span class="n">Error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Cancelled</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">FormResult</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kt">object</span> <span class="n">Object</span><span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">Objects</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kt">bool</span> <span class="n">Cancelled</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kt">bool</span> <span class="n">Valid</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kt">bool</span> <span class="n">Affirmative</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="c1">// Constructor (Default)</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">FormResult</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Object</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Objects</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Cancelled</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Valid</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Affirmative</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="c1">// Constructor (Alternative)</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">FormResult</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isValid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Object</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Objects</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Cancelled</span> <span class="p">=</span> <span class="p">!</span><span class="n">isValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Valid</span> <span class="p">=</span> <span class="n">isValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="n">Affirmative</span> <span class="p">=</span> <span class="n">isValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to validate</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="k">void</span> <span class="n">Validate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="n">Cancelled</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="n">Valid</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="n">Affirmative</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to validate</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="k">void</span> <span class="n">Validate</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">	        <span class="k">this</span><span class="p">.</span><span class="n">Validate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="n">Object</span> <span class="p">=</span> <span class="n">obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to validate</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="k">void</span> <span class="n">Validate</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">objs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">	        <span class="k">this</span><span class="p">.</span><span class="n">Validate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="n">Objects</span> <span class="p">=</span> <span class="n">objs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmds_buttoncs"><code>Cmds_Button.cs</code><a hidden class="anchor" aria-hidden="true" href="#cmds_buttoncs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.DB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//UKON</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">UKON.Extensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gFrm</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Forms</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Associate with PushButton Commands</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Commands.General</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Test</span> <span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Collect the Document and Application objects from the CommandData</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="p">(</span><span class="n">uiApp</span><span class="p">,</span> <span class="n">uiDoc</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span> <span class="p">=</span> <span class="n">CommandData</span><span class="p">.</span><span class="n">Ext_GetRevitContext</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Collect all walls</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">walls</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">OfClass</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Wall</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">WhereElementIsNotElementType</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">ToElements</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Show the message dialog with the document title</span>
</span></span><span class="line"><span class="cl">            <span class="n">gFrm</span><span class="p">.</span><span class="n">Custom</span><span class="p">.</span><span class="n">Message</span><span class="p">(</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">,</span> <span class="s">$&#34;We have {walls.Count} walls in the model&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Collect all walls lower than 12 feet</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// First: Construct a filter for .WherePasses() Method</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">parameterId</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ElementId</span><span class="p">(</span><span class="n">BuiltInParameter</span><span class="p">.</span><span class="n">WALL_USER_HEIGHT_PARAM</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">provider</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ParameterValueProvider</span><span class="p">(</span><span class="n">parameterId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">rule</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FilterNumericLess</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">passesRule</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FilterDoubleRule</span><span class="p">(</span><span class="n">provider</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">0.1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">paramFilter</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ElementParameterFilter</span><span class="p">(</span><span class="n">passesRule</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Then: Apply the filter to the FilteredElementCollector</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">wallsFiltered</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">OfCategory</span><span class="p">(</span><span class="n">BuiltInCategory</span><span class="p">.</span><span class="n">OST_Walls</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">WhereElementIsNotElementType</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">WherePasses</span><span class="p">(</span><span class="n">paramFilter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">ToElements</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Show the message dialog with different warning MessageBoxes</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">yesNoResult</span> <span class="p">=</span> <span class="n">uFrm</span><span class="p">.</span><span class="n">Custom</span><span class="p">.</span><span class="n">Message</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">,</span> <span class="s">$&#34;We have {wallsFiltered.Count} walls less than 12 feet in the model&#34;</span><span class="p">,</span> <span class="n">yesNo</span><span class="p">:</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">yesNoResult</span><span class="p">.</span><span class="n">Cancelled</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Cancelled</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">yesNoResult</span><span class="p">.</span><span class="n">Cancelled</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">gFrm</span><span class="p">.</span><span class="n">Custom</span><span class="p">.</span><span class="n">Cancelled</span><span class="p">(</span><span class="s">&#34;\&#39;No\&#39; was chosen.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">gFrm</span><span class="p">.</span><span class="n">Custom</span><span class="p">.</span><span class="n">Error</span><span class="p">(</span><span class="s">&#34;An error did not occur, just showing this form.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">gFrm</span><span class="p">.</span><span class="n">Custom</span><span class="p">.</span><span class="n">Completed</span><span class="p">(</span><span class="s">&#34;Script completed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/c%23/">C#</a></li>
      <li><a href="http://localhost:1313/tags/revit/">Revit</a></li>
      <li><a href="http://localhost:1313/tags/tutorial/">Tutorial</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/lesson-14/">
    <span class="title">« Prev</span>
    <br>
    <span>C# &#43; Revit API: Lesson 14 - Dropdown (Win)Forms</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/lesson-12/">
    <span class="title">Next »</span>
    <br>
    <span>C# &#43; Revit API: Lesson 12 - FilteredElementCollector</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© 2025 AYDrafting. All rights reserved.</span> · 

    <span>
        Powered by
        <a href="https://aydrafting.com/" rel="noopener noreferrer" target="_blank">AYDrafting</a> &
        <a href="https://github.com/aydimir95/" rel="noopener" target="_blank">GitHub</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
