<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>C# + Revit API: Lesson 12 - FilteredElementCollector | Blog</title><meta name=keywords content="C#,Revit,Tutorial"><meta name=description content="Goal

In most Revit add-ins, your first step will be to collect elements from the model.
The go-to tool for this is the FilteredElementCollector, which lets you gather elements and then refine your selection using a variety of filtering techniques in C#.

To explore everything there is to know about:
FilteredElementCollector

The FilteredElementCollector is a special Revit API class that works much like running a database query, with your Revit document acting as the database.
It allows you to start with a broad set of elements and then refine your results using various filtering methods to target exactly what you need.

Declaring a Collector

To create a collector for the entire document:



1


var collector = new FilteredElementCollector(doc);



If you only want elements visible in a specific view, pass the view’s Id:



1


var collector = new FilteredElementCollector(doc, view.Id);


Revit API
FilteredElementCollector Constructors
The FilteredElementCollector provides multiple constructor overloads, allowing you to start your collection from different scopes depending on your needs."><meta name=author content><link rel=canonical href=https://blog.aydrafting.com/posts/post-12/><link crossorigin=anonymous href=/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css integrity="sha256-bVhUcqQJqPUE5r+Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.aydrafting.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.aydrafting.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.aydrafting.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.aydrafting.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.aydrafting.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.aydrafting.com/posts/post-12/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.aydrafting.com/posts/post-12/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="C# + Revit API: Lesson 12 - FilteredElementCollector"><meta property="og:description" content="Goal In most Revit add-ins, your first step will be to collect elements from the model. The go-to tool for this is the FilteredElementCollector, which lets you gather elements and then refine your selection using a variety of filtering techniques in C#. To explore everything there is to know about: FilteredElementCollector The FilteredElementCollector is a special Revit API class that works much like running a database query, with your Revit document acting as the database. It allows you to start with a broad set of elements and then refine your results using various filtering methods to target exactly what you need. Declaring a Collector To create a collector for the entire document: 1 var collector = new FilteredElementCollector(doc); If you only want elements visible in a specific view, pass the view’s Id: 1 var collector = new FilteredElementCollector(doc, view.Id); Revit API FilteredElementCollector Constructors The FilteredElementCollector provides multiple constructor overloads, allowing you to start your collection from different scopes depending on your needs."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-15T10:37:24+03:00"><meta property="article:modified_time" content="2025-08-15T10:37:24+03:00"><meta property="article:tag" content="C#"><meta property="article:tag" content="Revit"><meta property="article:tag" content="Tutorial"><meta property="og:image" content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:title content="C# + Revit API: Lesson 12 - FilteredElementCollector"><meta name=twitter:description content="Goal

In most Revit add-ins, your first step will be to collect elements from the model.
The go-to tool for this is the FilteredElementCollector, which lets you gather elements and then refine your selection using a variety of filtering techniques in C#.

To explore everything there is to know about:
FilteredElementCollector

The FilteredElementCollector is a special Revit API class that works much like running a database query, with your Revit document acting as the database.
It allows you to start with a broad set of elements and then refine your results using various filtering methods to target exactly what you need.

Declaring a Collector

To create a collector for the entire document:



1


var collector = new FilteredElementCollector(doc);



If you only want elements visible in a specific view, pass the view’s Id:



1


var collector = new FilteredElementCollector(doc, view.Id);


Revit API
FilteredElementCollector Constructors
The FilteredElementCollector provides multiple constructor overloads, allowing you to start your collection from different scopes depending on your needs."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.aydrafting.com/posts/"},{"@type":"ListItem","position":2,"name":"C# + Revit API: Lesson 12 - FilteredElementCollector","item":"https://blog.aydrafting.com/posts/post-12/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"C# + Revit API: Lesson 12 - FilteredElementCollector","name":"C# \u002b Revit API: Lesson 12 - FilteredElementCollector","description":"Goal In most Revit add-ins, your first step will be to collect elements from the model. The go-to tool for this is the FilteredElementCollector, which lets you gather elements and then refine your selection using a variety of filtering techniques in C#. To explore everything there is to know about: FilteredElementCollector The FilteredElementCollector is a special Revit API class that works much like running a database query, with your Revit document acting as the database. It allows you to start with a broad set of elements and then refine your results using various filtering methods to target exactly what you need. Declaring a Collector To create a collector for the entire document: 1 var collector = new FilteredElementCollector(doc); If you only want elements visible in a specific view, pass the view’s Id: 1 var collector = new FilteredElementCollector(doc, view.Id); Revit API FilteredElementCollector Constructors The FilteredElementCollector provides multiple constructor overloads, allowing you to start your collection from different scopes depending on your needs.\n","keywords":["C#","Revit","Tutorial"],"articleBody":"Goal In most Revit add-ins, your first step will be to collect elements from the model. The go-to tool for this is the FilteredElementCollector, which lets you gather elements and then refine your selection using a variety of filtering techniques in C#. To explore everything there is to know about: FilteredElementCollector The FilteredElementCollector is a special Revit API class that works much like running a database query, with your Revit document acting as the database. It allows you to start with a broad set of elements and then refine your results using various filtering methods to target exactly what you need. Declaring a Collector To create a collector for the entire document: 1 var collector = new FilteredElementCollector(doc); If you only want elements visible in a specific view, pass the view’s Id: 1 var collector = new FilteredElementCollector(doc, view.Id); Revit API FilteredElementCollector Constructors The FilteredElementCollector provides multiple constructor overloads, allowing you to start your collection from different scopes depending on your needs.\n1. Constructor with Document\nThe most common constructor — collects elements from the entire document.\nFilteredElementCollector Constructor (Document): 1 2 3 public FilteredElementCollector( Document document // The document to search in. ) Example:\n1 var collector = new FilteredElementCollector(doc); 2. Constructor with Document and ElementId (View)\nCollects only elements visible in a specific view, identified by its ElementId.\nFilteredElementCollector Constructor (Document, ElementId) 1 2 3 4 public FilteredElementCollector( Document document, ElementId viewId // The view’s ID. ) Example:\n1 var collector = new FilteredElementCollector(doc, view.Id); 3. Constructor with Document and ICollection\nFilters a predefined set of elements. Useful when you’ve already gathered certain elements and want to further refine that list.\nFilteredElementCollector Constructor (Document, ICollection(ElementId)) 1 2 3 4 public FilteredElementCollector( Document document, ICollection\u003cElementId\u003e elementIds // A set of element IDs to filter. ) Example:\n1 var collector = new FilteredElementCollector(doc, myElementIds); 4. Constructor with Document, ElementId (View), and ElementId (Link)\nFilters elements within a linked Revit model, scoped to a specific view.\nFilteredElementCollector Constructor (Document, ElementId, ElementId) 1 2 3 4 5 public FilteredElementCollector( Document document, ElementId viewId, // The view ID in the host document. ElementId linkId // The Revit link instance ID in the host document. ) Example:\n1 var collector = new FilteredElementCollector(doc, view.Id, linkInstance.Id); FilteredElementCollector Methods Name Description ContainedInDesignOption Applies an ElementDesignOptionFilter to the collector. Dispose Equals Determines whether the specified object is equal to the current object. (Inherited from Object ) Excluding Applies an ExclusionFilter to the collector. FirstElement Returns the first element to pass the filter(s). FirstElementId Returns the id of the first element to pass the filter(s). GetBasicIEnumerator Returns an enumerator that iterates through a collection. GetElementCount Gets the number of elements in your current filter. GetElementIdIterator Returns an element id iterator to the elements passing the filters. GetElementIterator Returns an element iterator to the elements passing the filters. GetEnumerator Returns an enumerator that iterates through a collection. GetHashCode Serves as the default hash function. (Inherited from Object ) GetType Gets the Type of the current instance. (Inherited from Object ) IntersectWith Intersects the set of elements passing the filter in this collector with the set of elements passing the filter in another collector. IsViewValidForElementIteration Identifies if the particular element is valid for iteration of drawn elements. OfCategory Applies an ElementCategoryFilter to the collector. OfCategoryId Applies an ElementCategoryFilter to the collector. OfClass Applies an ElementClassFilter to the collector. OwnedByView Applies an ElementOwnerViewFilter to the collector. ToElementIds Returns the complete set of element ids that pass the filter(s). ToElements Returns the complete set of elements that pass the filter(s). ToString Returns a string that represents the current object. (Inherited from Object ) UnionWith Unites the set of elements passing the filter in this collector with the set of elements passing the filter in another collector. WhereElementIsCurveDriven Applies an ElementIsCurveDrivenFilter to the collector. WhereElementIsElementType Applies an ElementIsElementTypeFilter to the collector. WhereElementIsNotElementType Applies an inverted ElementIsElementTypeFilter to the collector. WhereElementIsViewIndependent Applies an ElementOwnerViewFilter to the collector. WherePasses Applies an element filter to the collector. Method Chaining in C# What is Method Chaining? Method chaining allows you to call multiple methods on an object in a single statement by linking them together with dots (.). Each method returns an object that the next method can be called on.\nThink of it like a conveyor belt in a factory - each station (method) processes the item and passes it to the next station.\nBasic Concept Instead of writing multiple separate lines:\n1 2 3 4 5 // Without chaining (multiple lines) var collector = new FilteredElementCollector(doc); collector = collector.OfClass(typeof(Wall)); collector = collector.WhereElementIsNotElementType(); var elements = collector.ToElements(); You can chain methods together:\n1 2 3 4 5 // With chaining (single statement) var elements = new FilteredElementCollector(doc) .OfClass(typeof(Wall)) .WhereElementIsNotElementType() .ToElements(); How Method Chaining Works Return Value: Each method in the chain returns an object (often the same type) Dot Notation: Use . to call the next method on the returned object Left-to-Right: Methods execute from left to right (or top to bottom when formatted) Understanding .OfClass vs .OfCategory This is crucial to understand! These two methods filter eleme=nts in completely different ways:\n.OfClass() - Filters by C# Class Type Filters based on the underlying programming class in the Revit API Examples: Wall, Floor, FamilyInstance, TextNote, etc. One class can contain multiple categories .OfCategory() - Filters by Revit Category Filters based on the visual category you see in Revit’s interface Examples: OST_Walls, OST_Doors, OST_Windows, OST_Floors, etc. More specific than class filtering Key Insight: FamilyInstance Class Many different Revit elements share the same class but have different categories:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // These are ALL FamilyInstance class, but different categories: var doors = new FilteredElementCollector(doc) .OfClass(typeof(FamilyInstance)) // Class: FamilyInstance .OfCategory(BuiltInCategory.OST_Doors) // Category: Doors .ToElements(); var windows = new FilteredElementCollector(doc) .OfClass(typeof(FamilyInstance)) // Class: FamilyInstance .OfCategory(BuiltInCategory.OST_Windows) // Category: Windows .ToElements(); var furniture = new FilteredElementCollector(doc) .OfClass(typeof(FamilyInstance)) // Class: FamilyInstance .OfCategory(BuiltInCategory.OST_Furniture) // Category: Furniture .ToElements(); When to Use Which? Use .OfClass() when:\nYou want ALL elements of a specific programming type The class directly matches what you want (like Wall, Floor) Use .OfCategory() when:\nYou want elements from a specific Revit category You’re working with FamilyInstances and need to specify which type Use BOTH when:\nYou want to be very specific and ensure you get exactly what you expect Understanding BuiltInCategory and Alternatives What is BuiltInCategory? BuiltInCategory is an enumeration (enum) provided by the Revit API that contains predefined constants for all the standard Revit categories. Think of it as a list of “official category names” that Revit recognizes.\n1 2 3 4 5 6 7 // BuiltInCategory is an enum with values like: BuiltInCategory.OST_Walls BuiltInCategory.OST_Doors BuiltInCategory.OST_Windows BuiltInCategory.OST_Floors BuiltInCategory.OST_Furniture // ... and hundreds more Why Use BuiltInCategory? (Recommended Approach) Advantages:\nType Safety: The compiler catches typos IntelliSense: Auto-complete shows you available options No Spelling Errors: Can’t misspell category names Language Independent: Works regardless of Revit’s display language Future Proof: Updates automatically with new Revit versions 1 2 3 4 5 // ✅ GOOD: Using BuiltInCategory var doors = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) // IntelliSense helps, no typos possible .WhereElementIsNotElementType() .ToElements(); Alternative 1: Using Category Objects You can get Category objects and use their ElementId:\n1 2 3 4 5 6 7 8 9 10 11 12 // Find category by name var doorCategory = doc.Categories .Cast\u003cCategory\u003e() .FirstOrDefault(c =\u003e c.Name == \"Doors\"); if (doorCategory != null) { var doors = new FilteredElementCollector(doc) .OfCategoryId(doorCategory.Id) // Using ElementId .WhereElementIsNotElementType() .ToElements(); } When to use:\nWorking with custom categories created by users Dynamic category selection based on user input When you need access to Category properties Alternative 2: Using Category Names (Not Recommended) 1 2 3 4 5 6 7 8 9 10 11 12 // ❌ PROBLEMATIC: This approach has issues var allCategories = doc.Categories; foreach (Category cat in allCategories) { if (cat.Name == \"Doors\") // Depends on Revit language! { var doors = new FilteredElementCollector(doc) .OfCategoryId(cat.Id) .ToElements(); break; } } Problems with this approach:\nLanguage Dependent: “Doors” in English, “Portes” in French, “Türen” in German Typo Prone: Easy to misspell category names Performance: Requires searching through all categories Fragile: Breaks if category names change Alternative 3: Converting Between Approaches Sometimes you need to convert between different category representations:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // Convert BuiltInCategory to Category object var builtInCat = BuiltInCategory.OST_Doors; var category = Category.GetCategory(doc, builtInCat); // Convert BuiltInCategory to ElementId var elementId = new ElementId(builtInCat); // Use either approach: var doors1 = new FilteredElementCollector(doc) .OfCategory(builtInCat) // Direct BuiltInCategory .ToElements(); var doors2 = new FilteredElementCollector(doc) .OfCategoryId(elementId) // Using ElementId .ToElements(); Practical Example: User-Defined Categories When dealing with custom categories (created by users), you’ll need the Category object approach:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 // Example: Get elements from a custom category public IList\u003cElement\u003e GetElementsFromCustomCategory(Document doc, string categoryName) { // Find the custom category var customCategory = doc.Categories .Cast\u003cCategory\u003e() .FirstOrDefault(c =\u003e c.Name.Equals(categoryName, StringComparison.OrdinalIgnoreCase)); if (customCategory != null) { return new FilteredElementCollector(doc) .OfCategoryId(customCategory.Id) .WhereElementIsNotElementType() .ToElements(); } return new List\u003cElement\u003e(); // Return empty list if category not found } Best Practice Summary Use BuiltInCategory for standard Revit categories (95% of cases):\n1 .OfCategory(BuiltInCategory.OST_Doors) Use Category objects for custom or dynamic scenarios:\n1 .OfCategoryId(customCategory.Id) Avoid string-based category searching unless absolutely necessary.\nCommon BuiltInCategory Values Here are some frequently used categories for reference:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 // Architectural BuiltInCategory.OST_Walls BuiltInCategory.OST_Doors BuiltInCategory.OST_Windows BuiltInCategory.OST_Floors BuiltInCategory.OST_Roofs BuiltInCategory.OST_Ceilings BuiltInCategory.OST_Stairs // MEP BuiltInCategory.OST_DuctCurves BuiltInCategory.OST_PipeCurves BuiltInCategory.OST_ElectricalFixtures BuiltInCategory.OST_LightingFixtures // Structural BuiltInCategory.OST_StructuralColumns BuiltInCategory.OST_StructuralFraming BuiltInCategory.OST_StructuralFoundation // Furniture \u0026 Equipment BuiltInCategory.OST_Furniture BuiltInCategory.OST_SpecialityEquipment BuiltInCategory.OST_PlumbingFixtures FilteredElementCollector Examples Example 1: Get All Walls (Class-based) 1 2 3 4 var walls = new FilteredElementCollector(doc) .OfClass(typeof(Wall)) // Wall class = Wall category .WhereElementIsNotElementType() .ToElements(); Example 2: Get Windows (Category-based - More Common) 1 2 3 4 var windows = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Windows) // Category filtering .WhereElementIsNotElementType() .ToElements(); Example 3: Get Windows (Belt \u0026 Suspenders Approach) 1 2 3 4 5 var windows = new FilteredElementCollector(doc) .OfClass(typeof(FamilyInstance)) // Class filtering .OfCategory(BuiltInCategory.OST_Windows) // Category filtering .WhereElementIsNotElementType() .ToElements(); Example 4: Get ALL Family Instances (Any Category) 1 2 3 4 var allFamilyInstances = new FilteredElementCollector(doc) .OfClass(typeof(FamilyInstance)) // Gets doors, windows, furniture, etc. .WhereElementIsNotElementType() .ToElements(); Understanding .WhereElementIsNotElementType() This method is extremely important and addresses a fundamental concept in Revit: the difference between Element Types and Element Instances.\nElement Types vs Element Instances Element Types (Templates/Definitions):\nThese are the “recipes” or “templates” for elements Examples: “Interior Door 36”×84\"\", “Exterior Wall - Brick”, “Standard Table” You see these in the Project Browser under “Families” They define properties but aren’t physical objects in your model Element Instances (Actual Placed Elements):\nThese are the actual elements placed in your model Examples: The specific door at coordinate (10, 5), the wall from point A to B These are what you see and select in your 3D/plan views They reference a type but exist at specific locations The Methods 1 2 3 4 5 // Gets ONLY element instances (the actual placed elements) .WhereElementIsNotElementType() // Gets ONLY element types (the definitions/templates) .WhereElementIsElementType() Why This Matters When you collect elements without these filters, you get BOTH types and instances:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // WITHOUT filtering - gets both types and instances var everything = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .ToElements(); // Result: Door types AND door instances mixed together // WITH instance filtering - gets only placed doors var actualDoors = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsNotElementType() // Only instances .ToElements(); // Result: Only the actual doors placed in the model // WITH type filtering - gets only door type definitions var doorTypes = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsElementType() // Only types .ToElements(); // Result: Only the door type definitions Common Use Cases Most Common: Get Instances (.WhereElementIsNotElementType())\n1 2 3 4 5 6 7 8 9 10 11 // Count how many doors are actually placed in the model var doorCount = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsNotElementType() .GetElementCount(); // Get all placed walls to analyze their geometry var walls = new FilteredElementCollector(doc) .OfClass(typeof(Wall)) .WhereElementIsNotElementType() .ToElements(); Sometimes Needed: Get Types (.WhereElementIsElementType())\n1 2 3 4 5 6 7 8 9 10 11 // Get all door types to list available options var doorTypes = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsElementType() .ToElements(); // Get all wall types to copy to another project var wallTypes = new FilteredElementCollector(doc) .OfClass(typeof(WallType)) // WallType class .WhereElementIsElementType() // Redundant but explicit .ToElements(); Pro Tip: Some Classes Are Always Types Some classes like WallType, FloorType, FamilySymbol are always types, so .WhereElementIsElementType() is redundant (but harmless):\n1 2 3 4 5 6 7 8 9 // These are equivalent for type classes: var wallTypes1 = new FilteredElementCollector(doc) .OfClass(typeof(WallType)) .ToElements(); var wallTypes2 = new FilteredElementCollector(doc) .OfClass(typeof(WallType)) .WhereElementIsElementType() // Redundant but OK .ToElements(); Memory Aid Instance = “In-stance” = IN the model (placed/physical) Type = “Template” = NOT placed (definition only) Rule of thumb: 99% of the time you want .WhereElementIsNotElementType() because you’re working with actual placed elements!\nExample 5: To Get All Elements Visible in a Specific View 1 2 3 4 var visibleElements = new FilteredElementCollector(doc, viewId) .OfClass(typeof(FamilyInstance)) .WhereElementIsNotElementType() .ToElementIds(); Custom Filters 1 2 3 4 5 var filteredElements = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsNotElementType() .WherePasses(new ElementLevelFilter(levelId)) .ToElements(); Understanding .WherePasses() and Custom Filters The .WherePasses() method allows you to apply custom filters that go beyond the basic filtering capabilities of .OfClass() and .OfCategory(). This is where you can get very specific about which elements you want.\n.WherePasses() Syntax 1 .WherePasses(new SomeFilter(parameters)) ElementLevelFilter Example 6 The ElementLevelFilter filters elements based on which level they belong to:\n1 2 3 4 5 6 // Get all doors on Level 1 var level1Doors = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsNotElementType() .WherePasses(new ElementLevelFilter(levelId)) // Only elements on this level .ToElements(); What you need:\nlevelId - The ElementId of the specific level you want to filter by How to get a levelId:\n1 2 3 4 5 6 7 8 9 10 11 12 // Option 1: Find level by name var level1 = new FilteredElementCollector(doc) .OfClass(typeof(Level)) .Cast\u003cLevel\u003e() .FirstOrDefault(l =\u003e l.Name == \"Level 1\"); var levelId = level1?.Id; // Option 2: Get all levels and pick one var allLevels = new FilteredElementCollector(doc) .OfClass(typeof(Level)) .ToElements(); var levelId = allLevels.First().Id; Complete Working Example 7 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // Step 1: Get the level we want var targetLevel = new FilteredElementCollector(doc) .OfClass(typeof(Level)) .Cast\u003cLevel\u003e() .FirstOrDefault(l =\u003e l.Name == \"Level 1\"); if (targetLevel != null) { // Step 2: Get all doors on that level var level1Doors = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsNotElementType() .WherePasses(new ElementLevelFilter(targetLevel.Id)) .ToElements(); // Now you have only doors that exist on Level 1 } Other Common Custom Filters ElementClassFilter (alternative to .OfClass()):\n1 .WherePasses(new ElementClassFilter(typeof(Wall))) ElementCategoryFilter (alternative to .OfCategory()):\n1 .WherePasses(new ElementCategoryFilter(BuiltInCategory.OST_Walls)) LogicalAndFilter (combine multiple filters with AND):\n1 2 3 4 5 6 7 8 var filter1 = new ElementLevelFilter(levelId); var filter2 = new ElementCategoryFilter(BuiltInCategory.OST_Doors); var combinedFilter = new LogicalAndFilter(filter1, filter2); var result = new FilteredElementCollector(doc) .WhereElementIsNotElementType() .WherePasses(combinedFilter) .ToElements(); LogicalOrFilter (combine multiple filters with OR):\n1 2 3 4 5 6 7 8 var doorsFilter = new ElementCategoryFilter(BuiltInCategory.OST_Doors); var windowsFilter = new ElementCategoryFilter(BuiltInCategory.OST_Windows); var doorsOrWindows = new LogicalOrFilter(doorsFilter, windowsFilter); var result = new FilteredElementCollector(doc) .WhereElementIsNotElementType() .WherePasses(doorsOrWindows) .ToElements(); When to Use .WherePasses() Use .WherePasses() when:\nBuilt-in methods (.OfClass(), .OfCategory()) aren’t specific enough You need to filter by level, view, or other specific properties You need to combine multiple filter conditions You’re working with complex filtering logic Stick with built-in methods when:\nSimple category or class filtering is sufficient You want cleaner, more readable code Performance Tip Apply the most restrictive filters first, then use .WherePasses() for fine-tuning:\n1 2 3 4 5 6 7 8 9 10 11 12 // Good: Filter by category first, then by level var efficientQuery = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) // Narrow down first .WhereElementIsNotElementType() .WherePasses(new ElementLevelFilter(levelId)) // Fine-tune .ToElements(); // Less efficient: Custom filter on everything var lessEfficientQuery = new FilteredElementCollector(doc) .WherePasses(new ElementLevelFilter(levelId)) // Filter everything first .OfCategory(BuiltInCategory.OST_Doors) // Then narrow down .ToElements(); Formatting for Readability When chaining gets long, format it vertically for better readability:\n1 2 3 4 5 6 7 8 9 10 // Good formatting - easy to read var elements = new FilteredElementCollector(doc) .OfClass(typeof(Wall)) .OfCategory(BuiltInCategory.OST_Walls) .WhereElementIsNotElementType() .WherePasses(someFilter) .ToElements(); // Bad formatting - hard to read var elements = new FilteredElementCollector(doc).OfClass(typeof(Wall)).OfCategory(BuiltInCategory.OST_Walls).WhereElementIsNotElementType().WherePasses(someFilter).ToElements(); Benefits of Method Chaining Concise Code: Less lines, more readable Fluent Interface: Reads almost like natural language Performance: Can be more efficient (no intermediate variables) Less Variables: No need to store intermediate results Common Patterns Pattern 1: Filter → Refine → Collect 1 2 3 4 var result = new FilteredElementCollector(doc) .OfClass(typeof(SomeClass)) // Filter by class .WhereElementIsNotElementType() // Refine selection .ToElements(); // Collect results Pattern 2: Category → Type → Custom Filter 1 2 3 4 5 var result = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Walls) // Filter by category .WhereElementIsNotElementType() // Exclude types .WherePasses(customFilter) // Apply custom filter .ToElements(); // Collect results Pattern 3: Count Elements 1 2 3 4 var count = new FilteredElementCollector(doc) .OfClass(typeof(Wall)) .WhereElementIsNotElementType() .GetElementCount(); // Just get the count, not the elements Important Notes Order Matters: Apply the most restrictive filters first for better performance Semicolon: Don’t forget the ; at the end of the statement Line Breaks: You can break lines anywhere in the chain for readability Return Types: Make sure each method returns something the next method can work with Practice Exercise Try converting this non-chained code to use method chaining:\n1 2 3 4 5 6 7 8 // Convert this: var collector = new FilteredElementCollector(doc); collector = collector.OfCategory(BuiltInCategory.OST_Doors); collector = collector.WhereElementIsNotElementType(); var doorElements = collector.ToElements(); // To this format: var doorElements = // Your chained solution here Solution:\n1 2 3 4 var doorElements = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_Doors) .WhereElementIsNotElementType() .ToElements(); Method chaining makes your Revit add-in code cleaner and more professional!\nHomework Solution ","wordCount":"2986","inLanguage":"en","image":"https://blog.aydrafting.com/LogoAYD.png","datePublished":"2025-08-15T10:37:24+03:00","dateModified":"2025-08-15T10:37:24+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.aydrafting.com/posts/post-12/"},"publisher":{"@type":"Organization","name":"Blog","logo":{"@type":"ImageObject","url":"https://blog.aydrafting.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.aydrafting.com/ accesskey=h title="Blog (Alt + H)">Blog</a></div><div class="logo main-logo"><a href=https://aydrafting.com target=_blank><img src=/LogoAYD.png alt=Blog height=40></a></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.aydrafting.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.aydrafting.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">C# + Revit API: Lesson 12 - FilteredElementCollector</h1><div class=post-meta><span title='2025-08-15 10:37:24 +0300 MSK'>August 15, 2025</span>&nbsp;·&nbsp;15 min&nbsp;|&nbsp;<a href=mailto:%20aydimir@aydrafting.com rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#goal aria-label=Goal>Goal</a><ul><li><a href=#to-explore-everything-there-is-to-know-about aria-label="To explore everything there is to know about:">To explore everything there is to know about:</a></li><li><a href=#filteredelementcollector aria-label=FilteredElementCollector>FilteredElementCollector</a><ul><li><a href=#declaring-a-collector aria-label="Declaring a Collector">Declaring a Collector</a></li></ul></li></ul></li><li><a href=#revit-api aria-label="Revit API">Revit API</a><ul><ul><li><a href=#filteredelementcollector-constructors aria-label="FilteredElementCollector Constructors">FilteredElementCollector Constructors</a></li><li><a href=#filteredelementcollector-methods aria-label="FilteredElementCollector Methods">FilteredElementCollector Methods</a></li></ul></ul></li><li><a href=#method-chaining-in-c aria-label="Method Chaining in C#">Method Chaining in C#</a><ul><li><a href=#what-is-method-chaining aria-label="What is Method Chaining?">What is Method Chaining?</a></li><li><a href=#basic-concept aria-label="Basic Concept">Basic Concept</a></li><li><a href=#how-method-chaining-works aria-label="How Method Chaining Works">How Method Chaining Works</a></li><li><a href=#understanding-ofclass-vs-ofcategory aria-label="Understanding .OfClass vs .OfCategory">Understanding .OfClass vs .OfCategory</a><ul><li><a href=#ofclass---filters-by-c-class-type aria-label=".OfClass() - Filters by C# Class Type">.OfClass() - Filters by C# Class Type</a></li><li><a href=#ofcategory---filters-by-revit-category aria-label=".OfCategory() - Filters by Revit Category">.OfCategory() - Filters by Revit Category</a></li><li><a href=#key-insight-familyinstance-class aria-label="Key Insight: FamilyInstance Class">Key Insight: FamilyInstance Class</a></li><li><a href=#when-to-use-which aria-label="When to Use Which?">When to Use Which?</a></li></ul></li><li><a href=#understanding-builtincategory-and-alternatives aria-label="Understanding BuiltInCategory and Alternatives">Understanding BuiltInCategory and Alternatives</a><ul><li><a href=#what-is-builtincategory aria-label="What is BuiltInCategory?">What is BuiltInCategory?</a></li><li><a href=#why-use-builtincategory-recommended-approach aria-label="Why Use BuiltInCategory? (Recommended Approach)">Why Use BuiltInCategory? (Recommended Approach)</a></li><li><a href=#alternative-1-using-category-objects aria-label="Alternative 1: Using Category Objects">Alternative 1: Using Category Objects</a></li><li><a href=#alternative-2-using-category-names-not-recommended aria-label="Alternative 2: Using Category Names (Not Recommended)">Alternative 2: Using Category Names (Not Recommended)</a></li><li><a href=#alternative-3-converting-between-approaches aria-label="Alternative 3: Converting Between Approaches">Alternative 3: Converting Between Approaches</a></li><li><a href=#practical-example-user-defined-categories aria-label="Practical Example: User-Defined Categories">Practical Example: User-Defined Categories</a></li><li><a href=#best-practice-summary aria-label="Best Practice Summary">Best Practice Summary</a></li><li><a href=#common-builtincategory-values aria-label="Common BuiltInCategory Values">Common BuiltInCategory Values</a></li></ul></li><li><a href=#filteredelementcollector-examples aria-label="FilteredElementCollector Examples">FilteredElementCollector Examples</a><ul><li><a href=#example-1-get-all-walls-class-based aria-label="Example 1: Get All Walls (Class-based)">Example 1: Get All Walls (Class-based)</a></li><li><a href=#example-2-get-windows-category-based---more-common aria-label="Example 2: Get Windows (Category-based - More Common)">Example 2: Get Windows (Category-based - More Common)</a></li><li><a href=#example-3-get-windows-belt--suspenders-approach aria-label="Example 3: Get Windows (Belt & Suspenders Approach)">Example 3: Get Windows (Belt & Suspenders Approach)</a></li><li><a href=#example-4-get-all-family-instances-any-category aria-label="Example 4: Get ALL Family Instances (Any Category)">Example 4: Get ALL Family Instances (Any Category)</a></li></ul></li><li><a href=#understanding-whereelementisnotelementtype aria-label="Understanding .WhereElementIsNotElementType()">Understanding .WhereElementIsNotElementType()</a><ul><li><a href=#element-types-vs-element-instances aria-label="Element Types vs Element Instances">Element Types vs Element Instances</a></li><li><a href=#the-methods aria-label="The Methods">The Methods</a></li><li><a href=#why-this-matters aria-label="Why This Matters">Why This Matters</a></li><li><a href=#common-use-cases aria-label="Common Use Cases">Common Use Cases</a></li><li><a href=#pro-tip-some-classes-are-always-types aria-label="Pro Tip: Some Classes Are Always Types">Pro Tip: Some Classes Are Always Types</a></li><li><a href=#memory-aid aria-label="Memory Aid">Memory Aid</a></li><li><a href=#example-5-to-get-all-elements-visible-in-a-specific-view aria-label="Example 5: To Get All Elements Visible in a Specific View">Example 5: To Get All Elements Visible in a Specific View</a></li></ul></li><li><a href=#custom-filters aria-label="Custom Filters">Custom Filters</a><ul><li><a href=#understanding-wherepasses-and-custom-filters aria-label="Understanding .WherePasses() and Custom Filters">Understanding .WherePasses() and Custom Filters</a></li><li><a href=#wherepasses-syntax aria-label=".WherePasses() Syntax">.WherePasses() Syntax</a></li><li><a href=#elementlevelfilter-example-6 aria-label="ElementLevelFilter Example 6">ElementLevelFilter Example 6</a></li><li><a href=#complete-working-example-7 aria-label="Complete Working Example 7">Complete Working Example 7</a></li><li><a href=#other-common-custom-filters aria-label="Other Common Custom Filters">Other Common Custom Filters</a></li><li><a href=#when-to-use-wherepasses aria-label="When to Use .WherePasses()">When to Use .WherePasses()</a></li><li><a href=#performance-tip aria-label="Performance Tip">Performance Tip</a></li></ul></li><li><a href=#formatting-for-readability aria-label="Formatting for Readability">Formatting for Readability</a></li><li><a href=#benefits-of-method-chaining aria-label="Benefits of Method Chaining">Benefits of Method Chaining</a></li><li><a href=#common-patterns aria-label="Common Patterns">Common Patterns</a><ul><li><a href=#pattern-1-filter--refine--collect aria-label="Pattern 1: Filter → Refine → Collect">Pattern 1: Filter → Refine → Collect</a></li><li><a href=#pattern-2-category--type--custom-filter aria-label="Pattern 2: Category → Type → Custom Filter">Pattern 2: Category → Type → Custom Filter</a></li><li><a href=#pattern-3-count-elements aria-label="Pattern 3: Count Elements">Pattern 3: Count Elements</a></li></ul></li><li><a href=#important-notes aria-label="Important Notes">Important Notes</a></li><li><a href=#practice-exercise aria-label="Practice Exercise">Practice Exercise</a></li></ul></li><li><a href=#homework aria-label=Homework>Homework</a></li><li><a href=#solution aria-label=Solution>Solution</a></li></ul></div></details></div><div class=post-content><h1 id=goal>Goal<a hidden class=anchor aria-hidden=true href=#goal>#</a></h1><ul><li>In most Revit add-ins, your first step will be to <strong>collect elements from the model</strong>.</li><li>The go-to tool for this is the <code>FilteredElementCollector</code>, which lets you gather elements and then refine your selection using a variety of filtering techniques in C#.</li></ul><h2 id=to-explore-everything-there-is-to-know-about>To explore everything there is to know about:<a hidden class=anchor aria-hidden=true href=#to-explore-everything-there-is-to-know-about>#</a></h2><h2 id=filteredelementcollector><code>FilteredElementCollector</code><a hidden class=anchor aria-hidden=true href=#filteredelementcollector>#</a></h2><ul><li>The <code>FilteredElementCollector</code> is a special Revit API class that works much like running a <strong>database query</strong>, with your Revit document acting as the database.</li><li>It allows you to start with a broad set of elements and then refine your results using various filtering methods to target exactly what you need.</li></ul><h3 id=declaring-a-collector><strong>Declaring a Collector</strong><a hidden class=anchor aria-hidden=true href=#declaring-a-collector>#</a></h3><ul><li>To create a collector for the entire document:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>If you only want elements visible in a specific view, pass the view’s Id:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>view</span><span class=p>.</span><span class=n>Id</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=revit-api>Revit API<a hidden class=anchor aria-hidden=true href=#revit-api>#</a></h1><h3 id=filteredelementcollector-constructors><code>FilteredElementCollector</code> Constructors<a hidden class=anchor aria-hidden=true href=#filteredelementcollector-constructors>#</a></h3><p>The <code>FilteredElementCollector</code> provides multiple constructor overloads, allowing you to start your collection from different scopes depending on your needs.</p><br><p><strong>1. Constructor with Document</strong></p><p>The most common constructor — collects elements from the entire document.</p><ul><li><code>FilteredElementCollector</code> Constructor (<code>Document</code>):</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=n>FilteredElementCollector</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	    <span class=n>Document</span> <span class=n>document</span> <span class=c1>// The document to search in.</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Example:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><br><br><p><strong>2. Constructor with Document and ElementId (View)</strong></p><p>Collects only elements <strong>visible in a specific view</strong>, identified by its ElementId.</p><ul><li><code>FilteredElementCollector</code> Constructor (<code>Document</code>, <code>ElementId</code>)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=n>FilteredElementCollector</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	    <span class=n>Document</span> <span class=n>document</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>ElementId</span> <span class=n>viewId</span> <span class=c1>// The view’s ID.</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Example:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>view</span><span class=p>.</span><span class=n>Id</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><br><br><p><strong>3. Constructor with <code>Document</code> and <code>ICollection&lt;ElementId></code></strong></p><p>Filters a <strong>predefined set of elements</strong>. Useful when you’ve already gathered certain elements and want to further refine that list.</p><ul><li><code>FilteredElementCollector</code> Constructor (<code>Document</code>, <code>ICollection(ElementId)</code>)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=n>FilteredElementCollector</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	    <span class=n>Document</span> <span class=n>document</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>ICollection</span><span class=p>&lt;</span><span class=n>ElementId</span><span class=p>&gt;</span> <span class=n>elementIds</span> <span class=c1>// A set of element IDs to filter.</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Example:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>myElementIds</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><br><br><p><strong>4. Constructor with <code>Document</code>, <code>ElementId (View)</code>, and <code>ElementId (Link)</code></strong></p><p>Filters elements within a <strong>linked Revit model</strong>, scoped to a specific view.</p><ul><li><code>FilteredElementCollector</code> Constructor (<code>Document</code>, <code>ElementId</code>, <code>ElementId</code>)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=n>FilteredElementCollector</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	    <span class=n>Document</span> <span class=n>document</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>ElementId</span> <span class=n>viewId</span><span class=p>,</span>  <span class=c1>// The view ID in the host document.</span>
</span></span><span class=line><span class=cl>	    <span class=n>ElementId</span> <span class=n>linkId</span>   <span class=c1>// The Revit link instance ID in the host document.</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Example:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>view</span><span class=p>.</span><span class=n>Id</span><span class=p>,</span> <span class=n>linkInstance</span><span class=p>.</span><span class=n>Id</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=filteredelementcollector-methods><code>FilteredElementCollector</code> Methods<a hidden class=anchor aria-hidden=true href=#filteredelementcollector-methods>#</a></h3><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href=https://www.revitapidocs.com/2025/92a2be0f-f632-2337-5bdd-ae3e832f3c33.htm>ContainedInDesignOption</a></td><td>Applies an ElementDesignOptionFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/c23c8781-f645-c059-7db5-d0cfd732dda1.htm>Dispose</a></td><td></td></tr><tr><td><a href=https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)>Equals</a></td><td>Determines whether the specified object is equal to the current object. <br>(Inherited from <a href=https://learn.microsoft.com/dotnet/api/system.object>Object</a> )</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/80e23fdc-c005-163b-5643-38d84411a73d.htm>Excluding</a></td><td>Applies an ExclusionFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/c8c1cae0-4ac8-a309-e915-6d491137d47e.htm>FirstElement</a></td><td>Returns the first element to pass the filter(s).</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/b1b42ac5-e816-983a-f44d-5cf441ca1ad9.htm>FirstElementId</a></td><td>Returns the id of the first element to pass the filter(s).</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/07236f22-1721-1f6e-0fb6-f03709923430.htm>GetBasicIEnumerator</a></td><td>Returns an enumerator that iterates through a collection.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/886aabfd-ea87-e54c-d108-37d09a44d612.htm>GetElementCount</a></td><td>Gets the number of elements in your current filter.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/0b1cdbeb-21ce-a4c5-6cae-253595818085.htm>GetElementIdIterator</a></td><td>Returns an element id iterator to the elements passing the filters.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/7113e21c-90f8-8f58-3b00-407fc1cd56e0.htm>GetElementIterator</a></td><td>Returns an element iterator to the elements passing the filters.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/746ac65b-35c2-d0db-53d7-4fe0fd61ab1f.htm>GetEnumerator</a></td><td>Returns an enumerator that iterates through a collection.</td></tr><tr><td><a href=https://learn.microsoft.com/dotnet/api/system.object.gethashcode#system-object-gethashcode>GetHashCode</a></td><td>Serves as the default hash function. <br>(Inherited from <a href=https://learn.microsoft.com/dotnet/api/system.object>Object</a> )</td></tr><tr><td><a href=https://learn.microsoft.com/dotnet/api/system.object.gettype#system-object-gettype>GetType</a></td><td>Gets the <a href=https://learn.microsoft.com/dotnet/api/system.type>Type</a> of the current instance. <br>(Inherited from <a href=https://learn.microsoft.com/dotnet/api/system.object>Object</a> )</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/5b204fc8-7702-cf7e-346a-3a4c1767924b.htm>IntersectWith</a></td><td>Intersects the set of elements passing the filter in this collector with the set of elements passing the filter in another collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/9c7f3f9c-aa8a-8077-9235-ff1058c8b20b.htm>IsViewValidForElementIteration</a></td><td>Identifies if the particular element is valid for iteration of drawn elements.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/c3523c35-4a07-9723-3c28-de3cc47b2ad0.htm>OfCategory</a></td><td>Applies an ElementCategoryFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/63304108-73f8-844e-82fc-5b8fad9839b0.htm>OfCategoryId</a></td><td>Applies an ElementCategoryFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/b0a5f22c-6951-c3af-cd29-1f28f574035d.htm>OfClass</a></td><td>Applies an ElementClassFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/54f2107a-bd87-41fe-dd00-385253ba5915.htm>OwnedByView</a></td><td>Applies an ElementOwnerViewFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/bfb8c8a2-aa2f-b1bc-7d57-7e3f7d39fcae.htm>ToElementIds</a></td><td>Returns the complete set of element ids that pass the filter(s).</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/732b4a0d-62d8-b86d-120b-8ea3d9713b34.htm>ToElements</a></td><td>Returns the complete set of elements that pass the filter(s).</td></tr><tr><td><a href=https://learn.microsoft.com/dotnet/api/system.object.tostring#system-object-tostring>ToString</a></td><td>Returns a string that represents the current object. <br>(Inherited from <a href=https://learn.microsoft.com/dotnet/api/system.object>Object</a> )</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/957cc5cb-5c7f-cac9-ec86-35afe824c432.htm>UnionWith</a></td><td>Unites the set of elements passing the filter in this collector with the set of elements passing the filter in another collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/3f3269fc-367c-1fec-9ddb-d0b54ecc4f0e.htm>WhereElementIsCurveDriven</a></td><td>Applies an ElementIsCurveDrivenFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/77793daa-5a26-b4d6-9019-4d998a55099e.htm>WhereElementIsElementType</a></td><td>Applies an ElementIsElementTypeFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/061cbbb9-26f1-a8f8-a4b2-3d7ff0105199.htm>WhereElementIsNotElementType</a></td><td>Applies an inverted ElementIsElementTypeFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/38b15459-9ffe-204a-0193-47c3a1b5e6e2.htm>WhereElementIsViewIndependent</a></td><td>Applies an ElementOwnerViewFilter to the collector.</td></tr><tr><td><a href=https://www.revitapidocs.com/2025/42d4eef3-55a1-2739-0ef8-6bc1d9fc2755.htm>WherePasses</a></td><td>Applies an element filter to the collector.</td></tr></tbody></table><hr><h1 id=method-chaining-in-c>Method Chaining in C#<a hidden class=anchor aria-hidden=true href=#method-chaining-in-c>#</a></h1><h2 id=what-is-method-chaining>What is Method Chaining?<a hidden class=anchor aria-hidden=true href=#what-is-method-chaining>#</a></h2><p>Method chaining allows you to call multiple methods on an object in a single statement by linking them together with dots (<code>.</code>). Each method returns an object that the next method can be called on.</p><p>Think of it like a conveyor belt in a factory - each station (method) processes the item and passes it to the next station.</p><h2 id=basic-concept>Basic Concept<a hidden class=anchor aria-hidden=true href=#basic-concept>#</a></h2><p>Instead of writing multiple separate lines:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Without chaining (multiple lines)</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>collector</span> <span class=p>=</span> <span class=n>collector</span><span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>collector</span> <span class=p>=</span> <span class=n>collector</span><span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>elements</span> <span class=p>=</span> <span class=n>collector</span><span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>You can chain methods together:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// With chaining (single statement)</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>elements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=how-method-chaining-works>How Method Chaining Works<a hidden class=anchor aria-hidden=true href=#how-method-chaining-works>#</a></h2><ol><li><strong>Return Value</strong>: Each method in the chain returns an object (often the same type)</li><li><strong>Dot Notation</strong>: Use <code>.</code> to call the next method on the returned object</li><li><strong>Left-to-Right</strong>: Methods execute from left to right (or top to bottom when formatted)</li></ol><h2 id=understanding-ofclass-vs-ofcategory>Understanding <code>.OfClass</code> vs <code>.OfCategory</code><a hidden class=anchor aria-hidden=true href=#understanding-ofclass-vs-ofcategory>#</a></h2><p>This is <strong>crucial</strong> to understand! These two methods filter eleme=nts in completely different ways:</p><h3 id=ofclass---filters-by-c-class-type><code>.OfClass()</code> - Filters by C# Class Type<a hidden class=anchor aria-hidden=true href=#ofclass---filters-by-c-class-type>#</a></h3><ul><li>Filters based on the <strong>underlying programming class</strong> in the Revit API</li><li>Examples: <code>Wall</code>, <code>Floor</code>, <code>FamilyInstance</code>, <code>TextNote</code>, etc.</li><li><strong>One class can contain multiple categories</strong></li></ul><h3 id=ofcategory---filters-by-revit-category><code>.OfCategory()</code> - Filters by Revit Category<a hidden class=anchor aria-hidden=true href=#ofcategory---filters-by-revit-category>#</a></h3><ul><li>Filters based on the <strong>visual category</strong> you see in Revit&rsquo;s interface</li><li>Examples: <code>OST_Walls</code>, <code>OST_Doors</code>, <code>OST_Windows</code>, <code>OST_Floors</code>, etc.</li><li><strong>More specific than class filtering</strong></li></ul><h3 id=key-insight-familyinstance-class>Key Insight: <code>FamilyInstance</code> Class<a hidden class=anchor aria-hidden=true href=#key-insight-familyinstance-class>#</a></h3><p>Many different Revit elements share the same class but have different categories:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// These are ALL FamilyInstance class, but different categories:</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doors</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>FamilyInstance</span><span class=p>))</span>           <span class=c1>// Class: FamilyInstance</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>     <span class=c1>// Category: Doors</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>windows</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>FamilyInstance</span><span class=p>))</span>           <span class=c1>// Class: FamilyInstance  </span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Windows</span><span class=p>)</span>   <span class=c1>// Category: Windows</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>furniture</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>FamilyInstance</span><span class=p>))</span>           <span class=c1>// Class: FamilyInstance</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Furniture</span><span class=p>)</span> <span class=c1>// Category: Furniture</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=when-to-use-which>When to Use Which?<a hidden class=anchor aria-hidden=true href=#when-to-use-which>#</a></h3><p><strong>Use <code>.OfClass()</code> when:</strong></p><ul><li>You want ALL elements of a specific programming type</li><li>The class directly matches what you want (like <code>Wall</code>, <code>Floor</code>)</li></ul><p><strong>Use <code>.OfCategory()</code> when:</strong></p><ul><li>You want elements from a specific Revit category</li><li>You&rsquo;re working with FamilyInstances and need to specify which type</li></ul><p><strong>Use <code>BOTH</code> when:</strong></p><ul><li>You want to be very specific and ensure you get exactly what you expect</li></ul><hr><h2 id=understanding-builtincategory-and-alternatives>Understanding <code>BuiltInCategory</code> and Alternatives<a hidden class=anchor aria-hidden=true href=#understanding-builtincategory-and-alternatives>#</a></h2><h3 id=what-is-builtincategory>What is BuiltInCategory?<a hidden class=anchor aria-hidden=true href=#what-is-builtincategory>#</a></h3><p><code>BuiltInCategory</code> is an <strong>enumeration</strong> (enum) provided by the Revit API that contains predefined constants for all the standard Revit categories. Think of it as a list of &ldquo;official category names&rdquo; that Revit recognizes.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// BuiltInCategory is an enum with values like:</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Walls</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span>  
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Windows</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Floors</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Furniture</span>
</span></span><span class=line><span class=cl><span class=c1>// ... and hundreds more</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=why-use-builtincategory-recommended-approach>Why Use <code>BuiltInCategory</code>? (Recommended Approach)<a hidden class=anchor aria-hidden=true href=#why-use-builtincategory-recommended-approach>#</a></h3><p><strong>Advantages:</strong></p><ul><li><strong>Type Safety</strong>: The compiler catches typos</li><li><strong>IntelliSense</strong>: Auto-complete shows you available options</li><li><strong>No Spelling Errors</strong>: Can&rsquo;t misspell category names</li><li><strong>Language Independent</strong>: Works regardless of Revit&rsquo;s display language</li><li><strong>Future Proof</strong>: Updates automatically with new Revit versions</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// ✅ GOOD: Using BuiltInCategory</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doors</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>  <span class=c1>// IntelliSense helps, no typos possible</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=alternative-1-using-category-objects>Alternative 1: Using Category <code>Objects</code><a hidden class=anchor aria-hidden=true href=#alternative-1-using-category-objects>#</a></h3><p>You can get Category objects and use their ElementId:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Find category by name</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorCategory</span> <span class=p>=</span> <span class=n>doc</span><span class=p>.</span><span class=n>Categories</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>Cast</span><span class=p>&lt;</span><span class=n>Category</span><span class=p>&gt;()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>FirstOrDefault</span><span class=p>(</span><span class=n>c</span> <span class=p>=&gt;</span> <span class=n>c</span><span class=p>.</span><span class=n>Name</span> <span class=p>==</span> <span class=s>&#34;Doors&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>doorCategory</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>doors</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>OfCategoryId</span><span class=p>(</span><span class=n>doorCategory</span><span class=p>.</span><span class=n>Id</span><span class=p>)</span>  <span class=c1>// Using ElementId</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>When to use:</strong></p><ul><li>Working with custom categories created by users</li><li>Dynamic category selection based on user input</li><li>When you need access to Category properties</li></ul><h3 id=alternative-2-using-category-names-not-recommended>Alternative 2: Using Category <code>Names</code> (Not Recommended)<a hidden class=anchor aria-hidden=true href=#alternative-2-using-category-names-not-recommended>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// ❌ PROBLEMATIC: This approach has issues</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>allCategories</span> <span class=p>=</span> <span class=n>doc</span><span class=p>.</span><span class=n>Categories</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=n>Category</span> <span class=n>cat</span> <span class=k>in</span> <span class=n>allCategories</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>cat</span><span class=p>.</span><span class=n>Name</span> <span class=p>==</span> <span class=s>&#34;Doors&#34;</span><span class=p>)</span>  <span class=c1>// Depends on Revit language!</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>doors</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>OfCategoryId</span><span class=p>(</span><span class=n>cat</span><span class=p>.</span><span class=n>Id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Problems with this approach:</strong></p><ul><li><strong>Language Dependent</strong>: &ldquo;Doors&rdquo; in English, &ldquo;Portes&rdquo; in French, &ldquo;Türen&rdquo; in German</li><li><strong>Typo Prone</strong>: Easy to misspell category names</li><li><strong>Performance</strong>: Requires searching through all categories</li><li><strong>Fragile</strong>: Breaks if category names change</li></ul><h3 id=alternative-3-converting-between-approaches>Alternative 3: Converting Between Approaches<a hidden class=anchor aria-hidden=true href=#alternative-3-converting-between-approaches>#</a></h3><p>Sometimes you need to convert between different category representations:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Convert BuiltInCategory to Category object</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>builtInCat</span> <span class=p>=</span> <span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>category</span> <span class=p>=</span> <span class=n>Category</span><span class=p>.</span><span class=n>GetCategory</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>builtInCat</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Convert BuiltInCategory to ElementId</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>elementId</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ElementId</span><span class=p>(</span><span class=n>builtInCat</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Use either approach:</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doors1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>builtInCat</span><span class=p>)</span>      <span class=c1>// Direct BuiltInCategory</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doors2</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategoryId</span><span class=p>(</span><span class=n>elementId</span><span class=p>)</span>     <span class=c1>// Using ElementId</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=practical-example-user-defined-categories>Practical Example: <code>User-Defined</code> Categories<a hidden class=anchor aria-hidden=true href=#practical-example-user-defined-categories>#</a></h3><p>When dealing with custom categories (created by users), you&rsquo;ll need the Category object approach:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Example: Get elements from a custom category</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=n>IList</span><span class=p>&lt;</span><span class=n>Element</span><span class=p>&gt;</span> <span class=n>GetElementsFromCustomCategory</span><span class=p>(</span><span class=n>Document</span> <span class=n>doc</span><span class=p>,</span> <span class=kt>string</span> <span class=n>categoryName</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Find the custom category</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>customCategory</span> <span class=p>=</span> <span class=n>doc</span><span class=p>.</span><span class=n>Categories</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Cast</span><span class=p>&lt;</span><span class=n>Category</span><span class=p>&gt;()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>FirstOrDefault</span><span class=p>(</span><span class=n>c</span> <span class=p>=&gt;</span> <span class=n>c</span><span class=p>.</span><span class=n>Name</span><span class=p>.</span><span class=n>Equals</span><span class=p>(</span><span class=n>categoryName</span><span class=p>,</span> <span class=n>StringComparison</span><span class=p>.</span><span class=n>OrdinalIgnoreCase</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>customCategory</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>OfCategoryId</span><span class=p>(</span><span class=n>customCategory</span><span class=p>.</span><span class=n>Id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>Element</span><span class=p>&gt;();</span> <span class=c1>// Return empty list if category not found</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=best-practice-summary>Best Practice Summary<a hidden class=anchor aria-hidden=true href=#best-practice-summary>#</a></h3><p><strong>Use <code>BuiltInCategory</code> for standard Revit categories</strong> (95% of cases):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Use <code>Category</code> objects for custom or dynamic scenarios</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=p>.</span><span class=n>OfCategoryId</span><span class=p>(</span><span class=n>customCategory</span><span class=p>.</span><span class=n>Id</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Avoid string-based category searching</strong> unless absolutely necessary.</p><h3 id=common-builtincategory-values>Common <code>BuiltInCategory</code> Values<a hidden class=anchor aria-hidden=true href=#common-builtincategory-values>#</a></h3><p>Here are some frequently used categories for reference:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Architectural</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Walls</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span>  
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Windows</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Floors</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Roofs</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Ceilings</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Stairs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// MEP</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_DuctCurves</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_PipeCurves</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_ElectricalFixtures</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_LightingFixtures</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Structural  </span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_StructuralColumns</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_StructuralFraming</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_StructuralFoundation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Furniture &amp; Equipment</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Furniture</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_SpecialityEquipment</span>
</span></span><span class=line><span class=cl><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_PlumbingFixtures</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=filteredelementcollector-examples><code>FilteredElementCollector</code> Examples<a hidden class=anchor aria-hidden=true href=#filteredelementcollector-examples>#</a></h2><h3 id=example-1-get-all-walls-class-based>Example 1: Get All <code>Walls</code> (Class-based)<a hidden class=anchor aria-hidden=true href=#example-1-get-all-walls-class-based>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>walls</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>))</span>                <span class=c1>// Wall class = Wall category</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=example-2-get-windows-category-based---more-common>Example 2: Get <code>Windows</code> (Category-based - More Common)<a hidden class=anchor aria-hidden=true href=#example-2-get-windows-category-based---more-common>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>windows</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Windows</span><span class=p>)</span>  <span class=c1>// Category filtering</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=example-3-get-windows-belt--suspenders-approach>Example 3: Get <code>Windows</code> (Belt & Suspenders Approach)<a hidden class=anchor aria-hidden=true href=#example-3-get-windows-belt--suspenders-approach>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>windows</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>FamilyInstance</span><span class=p>))</span>          <span class=c1>// Class filtering</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Windows</span><span class=p>)</span>  <span class=c1>// Category filtering  </span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=example-4-get-all-family-instances-any-category>Example 4: Get ALL Family Instances (Any Category)<a hidden class=anchor aria-hidden=true href=#example-4-get-all-family-instances-any-category>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>allFamilyInstances</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>FamilyInstance</span><span class=p>))</span>     <span class=c1>// Gets doors, windows, furniture, etc.</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=understanding-whereelementisnotelementtype>Understanding <code>.WhereElementIsNotElementType()</code><a hidden class=anchor aria-hidden=true href=#understanding-whereelementisnotelementtype>#</a></h2><p>This method is <strong>extremely important</strong> and addresses a fundamental concept in Revit: the difference between <strong><code>Element Types</code></strong> and <strong><code>Element Instances</code></strong>.</p><h3 id=element-types-vs-element-instances>Element Types vs Element Instances<a hidden class=anchor aria-hidden=true href=#element-types-vs-element-instances>#</a></h3><p><strong><code>Element Types</code></strong> (Templates/Definitions):</p><ul><li>These are the &ldquo;recipes&rdquo; or &ldquo;templates&rdquo; for elements</li><li>Examples: &ldquo;Interior Door 36&rdquo;×84"", &ldquo;Exterior Wall - Brick&rdquo;, &ldquo;Standard Table&rdquo;</li><li>You see these in the Project Browser under &ldquo;Families&rdquo;</li><li>They define properties but aren&rsquo;t physical objects in your model</li></ul><p><strong><code>Element Instances</code></strong> (Actual Placed Elements):</p><ul><li>These are the actual elements placed in your model</li><li>Examples: The specific door at coordinate (10, 5), the wall from point A to B</li><li>These are what you see and select in your 3D/plan views</li><li>They reference a type but exist at specific locations</li></ul><h3 id=the-methods>The Methods<a hidden class=anchor aria-hidden=true href=#the-methods>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Gets ONLY element instances (the actual placed elements)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Gets ONLY element types (the definitions/templates)  </span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=n>WhereElementIsElementType</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=why-this-matters>Why This Matters<a hidden class=anchor aria-hidden=true href=#why-this-matters>#</a></h3><p>When you collect elements without these filters, you get <strong>BOTH</strong> types and instances:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// WITHOUT filtering - gets both types and instances</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>everything</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// Result: Door types AND door instances mixed together</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// WITH instance filtering - gets only placed doors</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>actualDoors</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>    <span class=c1>// Only instances</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// Result: Only the actual doors placed in the model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// WITH type filtering - gets only door type definitions</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorTypes</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsElementType</span><span class=p>()</span>       <span class=c1>// Only types</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// Result: Only the door type definitions</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=common-use-cases>Common Use Cases<a hidden class=anchor aria-hidden=true href=#common-use-cases>#</a></h3><p><strong>Most Common: Get Instances (<code>.WhereElementIsNotElementType()</code>)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Count how many doors are actually placed in the model</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorCount</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>GetElementCount</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Get all placed walls to analyze their geometry</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>walls</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Sometimes Needed: Get Types (<code>.WhereElementIsElementType()</code>)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Get all door types to list available options</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorTypes</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Get all wall types to copy to another project</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>wallTypes</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>WallType</span><span class=p>))</span>           <span class=c1>// WallType class</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsElementType</span><span class=p>()</span>         <span class=c1>// Redundant but explicit</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=pro-tip-some-classes-are-always-types>Pro Tip: Some Classes Are Always Types<a hidden class=anchor aria-hidden=true href=#pro-tip-some-classes-are-always-types>#</a></h3><p>Some classes like <code>WallType</code>, <code>FloorType</code>, <code>FamilySymbol</code> are <strong>always</strong> types, so <code>.WhereElementIsElementType()</code> is redundant (but harmless):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// These are equivalent for type classes:</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>wallTypes1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>WallType</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>wallTypes2</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>WallType</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsElementType</span><span class=p>()</span>    <span class=c1>// Redundant but OK</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=memory-aid>Memory Aid<a hidden class=anchor aria-hidden=true href=#memory-aid>#</a></h3><ul><li><strong><code>Instance</code></strong> = &ldquo;In-stance&rdquo; = <strong>IN</strong> the model (placed/physical)</li><li><strong><code>Type</code></strong> = &ldquo;Template&rdquo; = <strong>NOT</strong> placed (definition only)</li></ul><p><strong>Rule of thumb</strong>: 99% of the time you want <code>.WhereElementIsNotElementType()</code> because you&rsquo;re working with actual placed elements!</p><h3 id=example-5-to-get-all-elements-visible-in-a-specific-view>Example 5: To Get All Elements Visible in a Specific View<a hidden class=anchor aria-hidden=true href=#example-5-to-get-all-elements-visible-in-a-specific-view>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>visibleElements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>viewId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>FamilyInstance</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElementIds</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=custom-filters>Custom Filters<a hidden class=anchor aria-hidden=true href=#custom-filters>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>filteredElements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>ElementLevelFilter</span><span class=p>(</span><span class=n>levelId</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=understanding-wherepasses-and-custom-filters>Understanding <code>.WherePasses()</code> and Custom Filters<a hidden class=anchor aria-hidden=true href=#understanding-wherepasses-and-custom-filters>#</a></h3><p>The <code>.WherePasses()</code> method allows you to apply <strong>custom filters</strong> that go beyond the basic filtering capabilities of <code>.OfClass()</code> and <code>.OfCategory()</code>. This is where you can get very specific about which elements you want.</p><h3 id=wherepasses-syntax><code>.WherePasses()</code> Syntax<a hidden class=anchor aria-hidden=true href=#wherepasses-syntax>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>SomeFilter</span><span class=p>(</span><span class=n>parameters</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=elementlevelfilter-example-6><code>ElementLevelFilter</code> Example 6<a hidden class=anchor aria-hidden=true href=#elementlevelfilter-example-6>#</a></h3><p>The <code>ElementLevelFilter</code> filters elements based on which <strong>level</strong> they belong to:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Get all doors on Level 1</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>level1Doors</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>ElementLevelFilter</span><span class=p>(</span><span class=n>levelId</span><span class=p>))</span>    <span class=c1>// Only elements on this level</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>What you need:</strong></p><ul><li><code>levelId</code> - The ElementId of the specific level you want to filter by</li></ul><p><strong>How to get a levelId:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Option 1: Find level by name</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>level1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Level</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>Cast</span><span class=p>&lt;</span><span class=n>Level</span><span class=p>&gt;()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>FirstOrDefault</span><span class=p>(</span><span class=n>l</span> <span class=p>=&gt;</span> <span class=n>l</span><span class=p>.</span><span class=n>Name</span> <span class=p>==</span> <span class=s>&#34;Level 1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>levelId</span> <span class=p>=</span> <span class=n>level1</span><span class=p>?.</span><span class=n>Id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Option 2: Get all levels and pick one</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>allLevels</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Level</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>levelId</span> <span class=p>=</span> <span class=n>allLevels</span><span class=p>.</span><span class=n>First</span><span class=p>().</span><span class=n>Id</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=complete-working-example-7>Complete Working Example 7<a hidden class=anchor aria-hidden=true href=#complete-working-example-7>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Step 1: Get the level we want</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>targetLevel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Level</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>Cast</span><span class=p>&lt;</span><span class=n>Level</span><span class=p>&gt;()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>FirstOrDefault</span><span class=p>(</span><span class=n>l</span> <span class=p>=&gt;</span> <span class=n>l</span><span class=p>.</span><span class=n>Name</span> <span class=p>==</span> <span class=s>&#34;Level 1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>targetLevel</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Step 2: Get all doors on that level</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>level1Doors</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>ElementLevelFilter</span><span class=p>(</span><span class=n>targetLevel</span><span class=p>.</span><span class=n>Id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Now you have only doors that exist on Level 1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=other-common-custom-filters>Other Common Custom Filters<a hidden class=anchor aria-hidden=true href=#other-common-custom-filters>#</a></h3><p><strong><code>ElementClassFilter</code></strong> (alternative to <code>.OfClass()</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>ElementClassFilter</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><p><strong><code>ElementCategoryFilter</code></strong> (alternative to .<code>OfCategory()</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>ElementCategoryFilter</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Walls</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><strong><code>LogicalAndFilter</code></strong> (combine multiple filters with <code>AND</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>filter1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ElementLevelFilter</span><span class=p>(</span><span class=n>levelId</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>filter2</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ElementCategoryFilter</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>combinedFilter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>LogicalAndFilter</span><span class=p>(</span><span class=n>filter1</span><span class=p>,</span> <span class=n>filter2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>result</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=n>combinedFilter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p><strong><code>LogicalOrFilter</code></strong> (combine multiple filters with <code>OR</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorsFilter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ElementCategoryFilter</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>windowsFilter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ElementCategoryFilter</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Windows</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorsOrWindows</span> <span class=p>=</span> <span class=k>new</span> <span class=n>LogicalOrFilter</span><span class=p>(</span><span class=n>doorsFilter</span><span class=p>,</span> <span class=n>windowsFilter</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>result</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=n>doorsOrWindows</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=when-to-use-wherepasses>When to Use <code>.WherePasses()</code><a hidden class=anchor aria-hidden=true href=#when-to-use-wherepasses>#</a></h3><p><strong>Use <code>.WherePasses()</code> when:</strong></p><ul><li>Built-in methods (<code>.OfClass()</code>, <code>.OfCategory()</code>) aren&rsquo;t specific enough</li><li>You need to filter by <code>level</code>, <code>view</code>, or other specific <code>properties</code></li><li>You need to combine multiple filter conditions</li><li>You&rsquo;re working with complex filtering logic</li></ul><p><strong>Stick with <code>built-in</code> methods when:</strong></p><ul><li>Simple category or class filtering is sufficient</li><li>You want cleaner, more readable code</li></ul><h3 id=performance-tip>Performance Tip<a hidden class=anchor aria-hidden=true href=#performance-tip>#</a></h3><p>Apply the most restrictive filters first, then use <code>.WherePasses()</code> for fine-tuning:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Good: Filter by category first, then by level</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>efficientQuery</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>          <span class=c1>// Narrow down first</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>ElementLevelFilter</span><span class=p>(</span><span class=n>levelId</span><span class=p>))</span>   <span class=c1>// Fine-tune</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Less efficient: Custom filter on everything</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>lessEfficientQuery</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=k>new</span> <span class=n>ElementLevelFilter</span><span class=p>(</span><span class=n>levelId</span><span class=p>))</span>   <span class=c1>// Filter everything first</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>          <span class=c1>// Then narrow down</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=formatting-for-readability>Formatting for Readability<a hidden class=anchor aria-hidden=true href=#formatting-for-readability>#</a></h2><p>When chaining gets long, format it vertically for better readability:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Good formatting - easy to read</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>elements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Walls</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=n>someFilter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Bad formatting - hard to read</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>elements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>).</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>)).</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Walls</span><span class=p>).</span><span class=n>WhereElementIsNotElementType</span><span class=p>().</span><span class=n>WherePasses</span><span class=p>(</span><span class=n>someFilter</span><span class=p>).</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=benefits-of-method-chaining>Benefits of Method Chaining<a hidden class=anchor aria-hidden=true href=#benefits-of-method-chaining>#</a></h2><ol><li><strong>Concise Code</strong>: Less lines, more readable</li><li><strong>Fluent Interface</strong>: Reads almost like natural language</li><li><strong>Performance</strong>: Can be more efficient (no intermediate variables)</li><li><strong>Less Variables</strong>: No need to store intermediate results</li></ol><h2 id=common-patterns>Common Patterns<a hidden class=anchor aria-hidden=true href=#common-patterns>#</a></h2><h3 id=pattern-1-filter--refine--collect>Pattern 1: Filter → Refine → Collect<a hidden class=anchor aria-hidden=true href=#pattern-1-filter--refine--collect>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>result</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>SomeClass</span><span class=p>))</span>           <span class=c1>// Filter by class</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>       <span class=c1>// Refine selection</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>                        <span class=c1>// Collect results</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=pattern-2-category--type--custom-filter>Pattern 2: Category → Type → Custom Filter<a hidden class=anchor aria-hidden=true href=#pattern-2-category--type--custom-filter>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>result</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Walls</span><span class=p>)</span>  <span class=c1>// Filter by category</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>         <span class=c1>// Exclude types</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WherePasses</span><span class=p>(</span><span class=n>customFilter</span><span class=p>)</span>              <span class=c1>// Apply custom filter</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>                          <span class=c1>// Collect results</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=pattern-3-count-elements>Pattern 3: Count Elements<a hidden class=anchor aria-hidden=true href=#pattern-3-count-elements>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>count</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>Wall</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>GetElementCount</span><span class=p>();</span>  <span class=c1>// Just get the count, not the elements</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=important-notes>Important Notes<a hidden class=anchor aria-hidden=true href=#important-notes>#</a></h2><ul><li><strong>Order Matters</strong>: Apply the most restrictive filters first for better performance</li><li><strong>Semicolon</strong>: Don&rsquo;t forget the <code>;</code> at the end of the statement</li><li><strong>Line Breaks</strong>: You can break lines anywhere in the chain for readability</li><li><strong>Return Types</strong>: Make sure each method returns something the next method can work with</li></ul><h2 id=practice-exercise>Practice Exercise<a hidden class=anchor aria-hidden=true href=#practice-exercise>#</a></h2><p>Try converting this non-chained code to use method chaining:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Convert this:</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>collector</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>collector</span> <span class=p>=</span> <span class=n>collector</span><span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>collector</span> <span class=p>=</span> <span class=n>collector</span><span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorElements</span> <span class=p>=</span> <span class=n>collector</span><span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// To this format:</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorElements</span> <span class=p>=</span> <span class=c1>// Your chained solution here</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Solution:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>doorElements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_Doors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsNotElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToElements</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Method chaining makes your Revit add-in code cleaner and more professional!</p></blockquote><h1 id=homework>Homework<a hidden class=anchor aria-hidden=true href=#homework>#</a></h1><h1 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h1></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.aydrafting.com/tags/c%23/>C#</a></li><li><a href=https://blog.aydrafting.com/tags/revit/>Revit</a></li><li><a href=https://blog.aydrafting.com/tags/tutorial/>Tutorial</a></li></ul><nav class=paginav><a class=next href=https://blog.aydrafting.com/posts/post-11/><span class=title>Next »</span><br><span>C# + Revit API: Lesson 11 - Stacking Buttons</span></a></nav></footer></article></main><footer class=footer><span>© 2025 AYDrafting. All rights reserved.</span> ·
<span>Powered by
<a href=https://aydrafting.com/ rel="noopener noreferrer" target=_blank>AYDrafting</a> &
<a href=https://github.com/aydimir95/ rel=noopener target=_blank>GitHub</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>