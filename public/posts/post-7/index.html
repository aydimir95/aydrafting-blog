<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>C# + Revit API: Lesson 7 - Introduction to Classes | Blog</title><meta name=keywords content="C#,Revit,Tutorial"><meta name=description content="1. Introduction
Project Folder Structure

Commands
Extensions
Forms
General
Resources
Utilities
These are folders which contain various files that our toolbar will utilize.


Note that these are not necessarily aligned with namespaces (which will be covered later)


2. What is a Class?

In C#, classes are templates related to the creation and management of objects. There are many predefined classes available in C# and the Revit API.
We use them for a wide range of things and will regularly be creating and developing our own classes.


Accessing properties / methods of a Class

Property:

object.Property -> to access a property


Method:

Object.Method(argument1, argument2, etc) -> to access a method



Namespaces

When we create classes, we first tell them where they belong in our project.
Namespaces can be nested within others using a dot separator, eventually tied back to our .addin namespace.

// Revit API
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// geeWiz - internal project objects
using geeWiz.Extensions;
using geeWiz = geeWiz.Forms;
using geeWiz = geeWiz.Utilities.Workshare_Utils;

// The class belongs to the Commands namespace
namespace geeWiz.Cmds_Audit
{
	// Cmd_DeletePatterns
	// Cmd_PurgeRooms
	// Cmd_PurgeTemplates
	// Cmd_PurgeFilters
}
Basic Class Anatomy

modifers class ClassName : Interface(s)

Constructor (optional)
Properties (optional)
Methods (optional)




Access modifiers control how this code can be accessed inside and outside your project.
You will typically need to declare at least on of public/private,

And sometimes static for the purposes we will use them for early on.



Static Modifier

The static access modifier is a difficult concept to grasp at first, so we will simplify it somewhat.

Classes with a static modifier do not support the creation of objects of that class (instantiated).
We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us.




So basically, the Static modifier is one instrument that you could use to build a complex script with."><meta name=author content><link rel=canonical href=https://blog.aydrafting.com/posts/post-7/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.aydrafting.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.aydrafting.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.aydrafting.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.aydrafting.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.aydrafting.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.aydrafting.com/posts/post-7/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.aydrafting.com/posts/post-7/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="C# + Revit API: Lesson 7 - Introduction to Classes"><meta property="og:description" content="1. Introduction Project Folder Structure Commands Extensions Forms General Resources Utilities These are folders which contain various files that our toolbar will utilize. Note that these are not necessarily aligned with namespaces (which will be covered later) 2. What is a Class? In C#, classes are templates related to the creation and management of objects. There are many predefined classes available in C# and the Revit API. We use them for a wide range of things and will regularly be creating and developing our own classes. Accessing properties / methods of a Class Property: object.Property -> to access a property Method: Object.Method(argument1, argument2, etc) -> to access a method Namespaces When we create classes, we first tell them where they belong in our project. Namespaces can be nested within others using a dot separator, eventually tied back to our .addin namespace. // Revit API using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // geeWiz - internal project objects using geeWiz.Extensions; using geeWiz = geeWiz.Forms; using geeWiz = geeWiz.Utilities.Workshare_Utils; // The class belongs to the Commands namespace namespace geeWiz.Cmds_Audit { // Cmd_DeletePatterns // Cmd_PurgeRooms // Cmd_PurgeTemplates // Cmd_PurgeFilters } Basic Class Anatomy modifers class ClassName : Interface(s) Constructor (optional) Properties (optional) Methods (optional) Access modifiers control how this code can be accessed inside and outside your project. You will typically need to declare at least on of public/private, And sometimes static for the purposes we will use them for early on. Static Modifier The static access modifier is a difficult concept to grasp at first, so we will simplify it somewhat. Classes with a static modifier do not support the creation of objects of that class (instantiated). We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us. So basically, the Static modifier is one instrument that you could use to build a complex script with."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-08T13:06:57+03:00"><meta property="article:modified_time" content="2025-08-08T13:06:57+03:00"><meta property="article:tag" content="C#"><meta property="article:tag" content="Revit"><meta property="article:tag" content="Tutorial"><meta property="og:image" content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:title content="C# + Revit API: Lesson 7 - Introduction to Classes"><meta name=twitter:description content="1. Introduction
Project Folder Structure

Commands
Extensions
Forms
General
Resources
Utilities
These are folders which contain various files that our toolbar will utilize.


Note that these are not necessarily aligned with namespaces (which will be covered later)


2. What is a Class?

In C#, classes are templates related to the creation and management of objects. There are many predefined classes available in C# and the Revit API.
We use them for a wide range of things and will regularly be creating and developing our own classes.


Accessing properties / methods of a Class

Property:

object.Property -> to access a property


Method:

Object.Method(argument1, argument2, etc) -> to access a method



Namespaces

When we create classes, we first tell them where they belong in our project.
Namespaces can be nested within others using a dot separator, eventually tied back to our .addin namespace.

// Revit API
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// geeWiz - internal project objects
using geeWiz.Extensions;
using geeWiz = geeWiz.Forms;
using geeWiz = geeWiz.Utilities.Workshare_Utils;

// The class belongs to the Commands namespace
namespace geeWiz.Cmds_Audit
{
	// Cmd_DeletePatterns
	// Cmd_PurgeRooms
	// Cmd_PurgeTemplates
	// Cmd_PurgeFilters
}
Basic Class Anatomy

modifers class ClassName : Interface(s)

Constructor (optional)
Properties (optional)
Methods (optional)




Access modifiers control how this code can be accessed inside and outside your project.
You will typically need to declare at least on of public/private,

And sometimes static for the purposes we will use them for early on.



Static Modifier

The static access modifier is a difficult concept to grasp at first, so we will simplify it somewhat.

Classes with a static modifier do not support the creation of objects of that class (instantiated).
We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us.




So basically, the Static modifier is one instrument that you could use to build a complex script with."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.aydrafting.com/posts/"},{"@type":"ListItem","position":2,"name":"C# + Revit API: Lesson 7 - Introduction to Classes","item":"https://blog.aydrafting.com/posts/post-7/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"C# + Revit API: Lesson 7 - Introduction to Classes","name":"C# \u002b Revit API: Lesson 7 - Introduction to Classes","description":"1. Introduction Project Folder Structure Commands Extensions Forms General Resources Utilities These are folders which contain various files that our toolbar will utilize. Note that these are not necessarily aligned with namespaces (which will be covered later) 2. What is a Class? In C#, classes are templates related to the creation and management of objects. There are many predefined classes available in C# and the Revit API. We use them for a wide range of things and will regularly be creating and developing our own classes. Accessing properties / methods of a Class Property: object.Property -\u0026gt; to access a property Method: Object.Method(argument1, argument2, etc) -\u0026gt; to access a method Namespaces When we create classes, we first tell them where they belong in our project. Namespaces can be nested within others using a dot separator, eventually tied back to our .addin namespace. // Revit API using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // geeWiz - internal project objects using geeWiz.Extensions; using geeWiz = geeWiz.Forms; using geeWiz = geeWiz.Utilities.Workshare_Utils; // The class belongs to the Commands namespace namespace geeWiz.Cmds_Audit { // Cmd_DeletePatterns // Cmd_PurgeRooms // Cmd_PurgeTemplates // Cmd_PurgeFilters } Basic Class Anatomy modifers class ClassName : Interface(s) Constructor (optional) Properties (optional) Methods (optional) Access modifiers control how this code can be accessed inside and outside your project. You will typically need to declare at least on of public/private, And sometimes static for the purposes we will use them for early on. Static Modifier The static access modifier is a difficult concept to grasp at first, so we will simplify it somewhat. Classes with a static modifier do not support the creation of objects of that class (instantiated). We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us. So basically, the Static modifier is one instrument that you could use to build a complex script with.\n","keywords":["C#","Revit","Tutorial"],"articleBody":"1. Introduction Project Folder Structure Commands Extensions Forms General Resources Utilities These are folders which contain various files that our toolbar will utilize. Note that these are not necessarily aligned with namespaces (which will be covered later) 2. What is a Class? In C#, classes are templates related to the creation and management of objects. There are many predefined classes available in C# and the Revit API. We use them for a wide range of things and will regularly be creating and developing our own classes. Accessing properties / methods of a Class Property: object.Property -\u003e to access a property Method: Object.Method(argument1, argument2, etc) -\u003e to access a method Namespaces When we create classes, we first tell them where they belong in our project. Namespaces can be nested within others using a dot separator, eventually tied back to our .addin namespace. // Revit API using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // geeWiz - internal project objects using geeWiz.Extensions; using geeWiz = geeWiz.Forms; using geeWiz = geeWiz.Utilities.Workshare_Utils; // The class belongs to the Commands namespace namespace geeWiz.Cmds_Audit { // Cmd_DeletePatterns // Cmd_PurgeRooms // Cmd_PurgeTemplates // Cmd_PurgeFilters } Basic Class Anatomy modifers class ClassName : Interface(s) Constructor (optional) Properties (optional) Methods (optional) Access modifiers control how this code can be accessed inside and outside your project. You will typically need to declare at least on of public/private, And sometimes static for the purposes we will use them for early on. Static Modifier The static access modifier is a difficult concept to grasp at first, so we will simplify it somewhat. Classes with a static modifier do not support the creation of objects of that class (instantiated). We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us. So basically, the Static modifier is one instrument that you could use to build a complex script with.\nPublic and Private Modifier The public modifier lets you access something anywhere in your project. The private modifier limits access to the same class instead (generally for behind-the-scenes code in the class itself). There are other modifiers, but let‚Äôs keep it simple.\nClass Declaration modifiers class ClassName : Interface(s)\nAfter our modifiers we must define our class by using the keyword ‚Äòclass‚Äô, followed by a Class Name.\nGenerally, most people use PascalCase for class names, and you should choose names which are not reserved elsewhere.\nInterface(s) (Optional) modifiers class ClassName : Interface(s)\nInterface - acts as a template that a class should follow. It‚Äôs like a contract that is formed with your class -\u003e the class must have certain methods / properties / behaviours that this interface would provide to it.\nFormally:\nInterfaces are optional agreements that the class must form with predefined class templates. They usually provide methods and properties which would otherwise be cumbersome to access/define, as well as ensuring the class follows some requirements. Referencing a Class Static example (access without creating an instance): var myInstance = ClassName; A static class or member belongs to the class itself, not to any specific object. You use the class name to access it directly. You can call its methods or properties right away ‚Äî no need to create an object. Because it‚Äôs static, you cannot use new to make an instance of it. Example:\n// Accessing a static property without creating Math object Console.WriteLine(Math.PI); Non-static example ‚Äì Create and use an object var myInstance = new ClassName(); A non-static class needs to be instantiated (created) before you can use it. You create a new object using the new keyword and parentheses () to run its constructor. The variable myInstance now refers to this new object, and you can use its methods and properties. The var keyword tells the compiler to figure out the variable‚Äôs type automatically. Example:\nvar car = new Car(); car.Drive(); // Calling an instance method Homework Let‚Äôs do the following:\nSet up a class file (.cs) in our project, Create a namespace for it, Define our class (non-static, public). Its purpose is to store and process results from forms we create.\nSolution // 1. Create a new folder (if you haven't already) and call it 'Forms' // 2. Add a new item to 'Forms' -\u003e pick the 'Class' type -\u003e name it: \"Custom.cs\" using System; using System.Collection.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace guRoo.Forms // try to make your namespace follow your folder structure { public static class Custom // change to 'public' + 'static' class { } public class FormResult // add another 'non-static' class { } } Here‚Äôs a cleaner, beginner-friendly rewrite with improved structure, simpler explanations, and a working example that will actually compile.\nI‚Äôve also made the terminology more precise and added a clear generic vs. specific constructor example.\n3. Constructors Optional but very useful\nA constructor is a special method that runs automatically when you create a new object from a class:\nIt tells the class how it should start ‚Äî for example, setting initial values. If you don‚Äôt add a constructor, C# uses a default constructor that simply sets properties to their default values, or formally: C# provides an implicit parameterless constructor that sets members to their type defaults. You can make your own constructor to set specific values when an object is created. A class can have multiple constructors (called constructor overloading), which is a form of polymorphism. Constructor Syntax class ClassName { // Constructor with parameters public ClassName(type parameterName) { // Initialization logic } } Example: Generic vs. Specific Constructor Let‚Äôs create a FormResult class with two constructors:\nGeneric constructor ‚Äì takes no arguments (creates a form with default values) Specific constructor ‚Äì allows setting a custom status when creating the form namespace guRoo.Forms // Use namespaces that match your folder structure { public class FormResult { public string Status { get; set; } // 1. Generic constructor (no parameters) public FormResult() { Status = \"Pending\"; // Default value } // 2. Specific constructor (with parameter) public FormResult(string status) { Status = status; } } } Using the Constructors // Using the generic constructor var form1 = new FormResult(); Console.WriteLine(form1.Status); // Output: Pending // Using the specific constructor var form2 = new FormResult(\"Cancelled\"); Console.WriteLine(form2.Status); // Output: Cancelled Homework In this exercise, you‚Äôll learn how to create two different constructors in a class ‚Äî one that uses a default value and one that accepts a custom value when creating an object.\nWe‚Äôll do this in a Revit API context by making a simple SheetResult class that stores the name of a sheet.\nYour task:\nCreate a new class called SheetResult in Custom.cs. Add: A generic constructor (no parameters) that sets the SheetName property to ‚ÄúUntitled Sheet‚Äù. A specific constructor (with a parameter) that accepts a string and sets SheetName to the provided value. Note: if you add the specific constructor, also add the parameterless one yourself. In Custom.cs, create a static method ShowSheetResultDemo() that: Creates one SheetResult using the generic constructor. Creates another SheetResult using the specific constructor with a custom name. Displays both names in a TaskDialog. In your StartupCommand.Execute() method, call Custom.ShowSheetResultDemo() to run the demo inside Revit. üí° This will help you understand how constructors work in C#, and how you can use them to set up different ways of creating an object in your Revit add-ins.\nSolution (Copy Paste -\u003e Compile \u0026 Test it in Revit) Custom.cs using Autodesk.Revit.UI; namespace guRoo.Forms { public static class Custom // helper you can call from anywhere { public static void ShowSheetResultDemo() { var sheet1 = new SheetResult(); // generic var sheet2 = new SheetResult(\"A101 - Floor Plan\");¬†// specific TaskDialog.Show(\"Sheet Results\", $\"Generic constructor: {sheet1.SheetName}\\n\" + $\"Specific constructor: {sheet2.SheetName}\"); } } public class SheetResult { public string SheetName { get; set; } // Parameterless (generic) constructor public SheetResult() =\u003e SheetName = \"Untitled Sheet\"; // Constructor with parameters (specific) public SheetResult(string sheetName) =\u003e SheetName = sheetName; } } StartupCommand.cs using guRoo.Forms; // add this public override void Execute() { // ...your existing code... Custom.ShowSheetResultDemo(); // \u003c-- shows the dialog from Custom.cs } 4. Properties Properties define the data that a class can store and expose.\nWhile you can make properties publicly accessible, best practice is to keep the underlying data private (inside the class) and control access through public get and set accessors.\nThis approach:\nKeeps the internal state of your object safe from unintended changes. Lets you add validation or extra logic when reading or writing values. In simple examples, we‚Äôll mostly use auto-implemented properties (public string Name { get; set; }), but we‚Äôll also show how to back them with private fields when you need more control.\nDeclaring a property A property is like a named piece of data that belongs to a class. The simplest form is an auto-implemented property, which C# creates for you without needing to write extra code:\nClass declaration { modifiers type PropertyName{get;set} } public class Person { public string Name { get; set; } // auto property } Using a private field Sometimes you want more control over how a property‚Äôs value is stored or changed. In that case, you can store the value in a private field and use a property to get and set it.\nclass ClassName { private type fieldName; // lowerCamelCase for fields public type PropertyName // PascalCase for properties { get { return fieldName; } set { fieldName = value; } } } Example: public class Person { private string name; // field public string Name // property { get { return name; } set { name = value; } } } üí° Tip: By convention, fields use camelCase and properties use PascalCase. This makes it easier to spot them in your code.\nHomework Properties let us store and access data in a class. In our earlier example, the SheetResult class only had a SheetName property.\nYour task:\nLet‚Äôs expand it to include more information ‚Äî for example, the SheetNumber And show both a simple auto-property and a property backed by a private field. Solution Custom.cs using Autodesk.Revit.UI; namespace guRoo.Forms { // ===== STATIC CLASS ===== public static class Custom { // ===== METHOD ===== public static void ShowSheetResultDemo() { // Create objects var sheet1 = new SheetResult(); // generic constructor var sheet2 = new SheetResult(\"A101 - Floor Plan\", \"S-001\"); // specific constructor // Show results in Revit dialog TaskDialog.Show(\"Sheet Results\", $\"Generic constructor: {sheet1.SheetName}, Number: {sheet1.SheetNumber}\\n\" + $\"Specific constructor: {sheet2.SheetName}, Number: {sheet2.SheetNumber}\"); } // ===== END METHOD ===== } // ===== END STATIC CLASS ===== // ===== CLASS ===== public class SheetResult { // ===== PROPERTIES ===== // Auto-implemented property public string SheetName { get; set; } // Private field + property with get/set logic private string sheetNumber; public string SheetNumber { get { return sheetNumber; } set { // Example: basic validation if (string.IsNullOrWhiteSpace(value)) sheetNumber = \"No Number\"; else sheetNumber = value; } } // ===== END PROPERTIES ===== // ===== CONSTRUCTORS ===== // Generic constructor public SheetResult() { SheetName = \"Untitled Sheet\"; SheetNumber = \"No Number\"; } // Specific constructor public SheetResult(string sheetName, string sheetNumber = \"No Number\") { SheetName = sheetName; SheetNumber = sheetNumber; } // ===== END CONSTRUCTORS ===== } // ===== END CLASS ===== } What Changed? Auto property: SheetName ‚Äî quick and simple, no custom logic. Property with private field: SheetNumber ‚Äî lets us add validation before saving the value. Constructors updated so both values can be set when creating a SheetResult. Result in Revit When you run StartupCommand, you‚Äôll still get your original workflow, but now the Custom.ShowSheetResultDemo() dialog will display both the sheet name and the sheet number, with ‚ÄúNo Number‚Äù automatically set if no value is given.\n5. Methods A method is an action your class can perform.\nWhile properties store data, methods usually do something ‚Äî either with the data in the class or with arguments you pass to them.\nYou call a method in a similar way to accessing a property, but methods can take arguments (optional) and can run multiple lines of logic.\nInstead of declaring a type (like a property), you declare a return type ‚Äî the type of value the method sends back to you when it finishes.\nIf the method doesn‚Äôt return anything, use the void keyword as the return type.\nDeclaring a method class ClassName { modifiers returnType MethodName(optionalArguments) { // Code logic here return objectOfType; // Only if the method returns a value } } Example: public class Calculator { public int Add(int a, int b) { return a + b; // Returns the sum } public void ShowMessage(string message) { Console.WriteLine(message); // Returns nothing (void) } } Homework Add some properties Demonstrate how to use a field Demonstrate how to make a method Call on our class in some code Disposal Later on, we will look into other things we can make use of, such as specifying what happens to our class instances when they are disposed. Generally, an object will be disposed when it us not needed anymore. The compiler tracks and determines when this occurs for us, but we can also manually dispose of or with the disposal of objects. From there, we‚Äôve learnt all about classes!\nWe now have a basic understanding of:\nClasses in C# Access modifiers Initialization Properties and methods Namespaces 6. Interfaces Interfaces provide abstract templates (sometimes called contracts) by which classes must more specifically implement them. By the end of this lesson we will have implemented two in our add-in. Interface Example This interface entails that any class implementing it must have 2 properties and methods. They are abstractly provided and are specifically built in the class itself. // Pseudo Code IAnimal int Legs; string Name; void MakeNoise(); // Real Implementation class Dog: IAnimal int Legs = 4; string Name = \"Dog\"; void MakeNoise() { Dog.Woof(); } We provide the interface to the Dog class, which will in turn expect the properties and method to be specified further. You can add more than 1 interface to a class and we usually name interfaces with a prefix of ‚ÄòI‚Äô. Argument provision Many Interfaces provided by the Revit API have further code support included for us. For example, Interfaces commonly provide methods which are triggered by events. We do not have to set up the sender/receiver methods if we implement the interface, only specify what happens when the event occurs. Application Variants When we implement our two interfaces, we will be using some special types. UIControlledApplication Provides access to the Revit application, is commonly on startup and shutdown, where a document is not yet available. ControlledApplication Represents the application service, giving us access to documents, options, and application specific settings (e.g. language). UIApplication Similar to UIControlledApplication, but it is available during our session. We will be using this a lot and in a future lesson we will register it to a globally accessible variable. UIDocument Represents the current document at a UI level, providing access to aspects such as selection and opened views. Document Represents the current document, providing access to many Revit API classes, methods, and properties at the document level, e.g. collecting elements in the document. How we can access them? uiCtlApp // Available at start-up/shutdown ctlApp // uiCtlApp.ControlledApplication uiApp // Idling event / via commands uiDoc // uiApp.ActiveUIDocument doc // uiDoc.Document Homework Implement IExternalApplication Implement IExternalCommand Collect the ControlledApplication Collect the Document in a command We now have a basic understanding of:\nInterfaces IExternalApplication IExternalCommand Application Classes Document Classes 7. Create a PushButton Let‚Äôs set up a button we can run our command from (we had this before, but we‚Äôre doing it the typical way vs the Nice3Point way). We will create a tab, a panel, a button and finally set up a basic command that runs when we press it. Understanding Names RibbonTab RibbonPanel Ribbon PushButton What do we need to do? Create our add-in Tab Add a RibbonPanel to the Tab Add a PushButton to the Ribbon Panel Related API Classes: UIControlledApplication \u003e Tab Tab \u003e RibbonPannel RibbonPanel \u003e PushButtonData \u003e PushButton Properties of a PushButton AssemblyName - Assembly Path of the Button AvailabilityClassName - The full class name of the class providing the entry point to decide availability of this push button. ClassName - The name of the class containing the implementation for the command. Enabled - Gets or sets a value indicating whether the item is enabled. Image - The image of the button. IsEnabledByContext - Indicates if this button can be executed. True is the pushbutton is permitted to be executed based on the current Revit context (active doc, active view, active tool). False if the pushbutton is disabled because of the active context. ItemText - Gets or sets the text displayed of the item. ItemType - Get the item type. LargeImage - The large image shown on the button. LongDescription - Long description of the command tooltip. Name - The name of the item. ToolTip - The description that appears as a ToolTip for the item. ToolTipImage - The image to show as a part of the button extended tooltip. Visible - Gets or sets a value indicating whether the item is visible. One Important Method -\u003e GetRibbonPanels GetRibbonPannels - Get all the custom Panels on Add-Ins Tab of Revit. GetRibbonPannels(String) - Get all the custom Panels on a designated Revit Tab. GetRibbonPannel(Tab) - Get all the custom Panels on a designated standard Revit Tab. Executing Assembly When our add-in is running, all the classes, resources and code we have produced are executed as an Assembly. We will access this to connect commands to buttons. using System.Reflection Assembly.GetExecutingAssembly() Homework Create a static utility class Add methods to static utility class that we need Run these methods in OnStartup method In the next video, we will add to this:\nCreate and assign icons and tooltips, Develop a naming system to simplify it all. 8. Global Variables Some programming languages support ‚Äòglobal‚Äô variables, which can be accessed anywhere at any time once set in the project.\nTo my knowledge, C# does not have a dedicated system for this. We can still achieve this by utilizing a static class that is dedicated to storing and providing these, however.\nLet‚Äôs set up a Globals Class, which will give us access to objects that would otherwise be inaccessible from various areas of our project. We will also look at how we can use an event to capture the UIApplication. Why can‚Äôt we get the UiApp? We will collect most variables on startup, but the UiApplication is not available during this time in Revit. In order to collect it we will take advantage of the OnIdling Event.\nEvents 101 Events provide us the ability to have code that executes when various events occur in an application. For example, run a code whenever the view is changed. When Revit is available, it is said to be Idling (not doing anything). The OnIdling event is commonly used to run some code as soon as Revit is available for code to be run. Basic Sub/Unsub syntax Subscribe to Idling event UICtlApp.Idling += MethodName\nUnsubsribe from idling event UICtlApp.Idling -= MethodName\nIn most cases, you will want your method to unsubscribe itself once it has run.\nHomework Create a static Globals Class Add properties and registration Register the UiApp using IdlingEvent These tutorials were inspired by the work of Aussie BIM Guru. If you‚Äôre looking for a deeper dive into the topics, check out his channel for detailed explanations.\n","wordCount":"3238","inLanguage":"en","image":"https://blog.aydrafting.com/LogoAYD.png","datePublished":"2025-08-08T13:06:57+03:00","dateModified":"2025-08-08T13:06:57+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.aydrafting.com/posts/post-7/"},"publisher":{"@type":"Organization","name":"Blog","logo":{"@type":"ImageObject","url":"https://blog.aydrafting.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.aydrafting.com/ accesskey=h title="Blog (Alt + H)">Blog</a></div><div class="logo main-logo"><a href=https://aydrafting.com target=_blank><img src=/LogoAYD.png alt=Blog height=40></a></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.aydrafting.com/>Home</a>&nbsp;¬ª&nbsp;<a href=https://blog.aydrafting.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">C# + Revit API: Lesson 7 - Introduction to Classes</h1><div class=post-meta><span title='2025-08-08 13:06:57 +0300 MSK'>August 8, 2025</span>&nbsp;¬∑&nbsp;16 min&nbsp;|&nbsp;<a href=mailto:aydimir@aydrafting.com/posts/Post%20%e2%84%967.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-introduction aria-label="1. Introduction">1. Introduction</a><ul><ul><li><a href=#project-folder-structure aria-label="Project Folder Structure">Project Folder Structure</a></li></ul></ul></li><li><a href=#2-what-is-a-class aria-label="2. What is a Class?">2. What is a Class?</a><ul><ul><li><a href=#accessing-properties--methods-of-a-class aria-label="Accessing properties / methods of a Class">Accessing properties / methods of a Class</a></li><li><a href=#namespaces aria-label=Namespaces>Namespaces</a></li><li><a href=#basic-class-anatomy aria-label="Basic Class Anatomy">Basic Class Anatomy</a></li><li><a href=#static-modifier aria-label="Static Modifier">Static Modifier</a></li><li><a href=#public-and-private-modifier aria-label="Public and Private Modifier">Public and Private Modifier</a></li><li><a href=#class-declaration aria-label="Class Declaration">Class Declaration</a></li><li><a href=#interfaces-optional aria-label="Interface(s) (Optional)">Interface(s) (Optional)</a></li></ul><li><a href=#referencing-a-class aria-label="Referencing a Class">Referencing a Class</a><ul><li><a href=#static-example-access-without-creating-an-instance aria-label="Static example (access without creating an instance):">Static example (access without creating an instance):</a></li><li><a href=#non-static-example--create-and-use-an-object aria-label="Non-static example ‚Äì Create and use an object">Non-static example ‚Äì Create and use an object</a></li><li><a href=#homework aria-label=Homework>Homework</a></li><li><a href=#solution aria-label=Solution>Solution</a></li></ul></li></ul></li><li><a href=#3-constructors aria-label="3. Constructors">3. Constructors</a><ul><ul><li><a href=#constructor-syntax aria-label="Constructor Syntax">Constructor Syntax</a></li><li><a href=#example-generic-vs-specific-constructor aria-label="Example: Generic vs. Specific Constructor">Example: Generic vs. Specific Constructor</a></li><li><a href=#using-the-constructors aria-label="Using the Constructors">Using the Constructors</a></li><li><a href=#homework-1 aria-label=Homework>Homework</a><ul><li><a href=#solution-copy-paste---compile--test-it-in-revit aria-label="Solution (Copy Paste -> Compile & Test it in Revit)">Solution (Copy Paste -> Compile & Test it in Revit)</a></li><li><a href=#customcs aria-label=Custom.cs>Custom.cs</a></li><li><a href=#startupcommandcs aria-label=StartupCommand.cs>StartupCommand.cs</a></li></ul></li></ul></ul></li><li><a href=#4-properties aria-label="4. Properties">4. Properties</a><ul><ul><li><a href=#declaring-a-property aria-label="Declaring a property">Declaring a property</a></li><li><a href=#using-a-private-field aria-label="Using a private field">Using a private field</a></li><li><a href=#example aria-label=Example:>Example:</a></li><li><a href=#homework-2 aria-label=Homework>Homework</a></li><li><a href=#solution-1 aria-label=Solution>Solution</a><ul><li><a href=#customcs-1 aria-label=Custom.cs>Custom.cs</a></li><li><a href=#what-changed aria-label="What Changed?">What Changed?</a></li><li><a href=#result-in-revit aria-label="Result in Revit">Result in Revit</a></li></ul></li></ul></ul></li><li><a href=#5-methods aria-label="5. Methods">5. Methods</a><ul><ul><li><a href=#declaring-a-method aria-label="Declaring a method">Declaring a method</a></li><li><a href=#example-1 aria-label=Example:>Example:</a></li><li><a href=#homework-3 aria-label=Homework>Homework</a></li><li><a href=#disposal aria-label=Disposal>Disposal</a></li></ul></ul></li><li><a href=#6-interfaces aria-label="6. Interfaces">6. Interfaces</a><ul><ul><li><a href=#interface-example aria-label="Interface Example">Interface Example</a></li><li><a href=#argument-provision aria-label="Argument provision">Argument provision</a></li></ul><li><a href=#application-variants aria-label="Application Variants">Application Variants</a><ul><ul><li><a href=#uicontrolledapplication aria-label=UIControlledApplication>UIControlledApplication</a></li><li><a href=#controlledapplication aria-label=ControlledApplication>ControlledApplication</a></li><li><a href=#uiapplication aria-label=UIApplication>UIApplication</a></li><li><a href=#uidocument aria-label=UIDocument>UIDocument</a></li><li><a href=#document aria-label=Document>Document</a></li></ul><li><a href=#how-we-can-access-them aria-label="How we can access them?">How we can access them?</a></li><li><a href=#homework-4 aria-label=Homework>Homework</a></li></ul></li></ul></li><li><a href=#7-create-a-pushbutton aria-label="7. Create a PushButton">7. Create a PushButton</a><ul><li><a href=#understanding-names aria-label="Understanding Names">Understanding Names</a><ul><li><a href=#what-do-we-need-to-do aria-label="What do we need to do?">What do we need to do?</a><ul><li><a href=#related-api-classes aria-label="Related API Classes:">Related API Classes:</a></li><li><a href=#properties-of-a-pushbutton aria-label="Properties of a PushButton">Properties of a PushButton</a></li><li><a href=#one-important-method---getribbonpanels aria-label="One Important Method -> GetRibbonPanels">One Important Method -> GetRibbonPanels</a></li></ul></li></ul></li><li><a href=#executing-assembly aria-label="Executing Assembly">Executing Assembly</a></li><li><a href=#homework-5 aria-label=Homework>Homework</a></li></ul></li><li><a href=#8-global-variables aria-label="8. Global Variables">8. Global Variables</a><ul><ul><li><a href=#why-cant-we-get-the-uiapp aria-label="Why can&rsquo;t we get the UiApp?">Why can&rsquo;t we get the UiApp?</a></li></ul><li><a href=#events-101 aria-label="Events 101">Events 101</a></li><li><a href=#basic-subunsub-syntax aria-label="Basic Sub/Unsub syntax">Basic Sub/Unsub syntax</a></li><li><a href=#homework-6 aria-label=Homework>Homework</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=1-introduction>1. Introduction<a hidden class=anchor aria-hidden=true href=#1-introduction>#</a></h1><h3 id=project-folder-structure>Project Folder Structure<a hidden class=anchor aria-hidden=true href=#project-folder-structure>#</a></h3><ol><li>Commands</li><li>Extensions</li><li>Forms</li><li>General</li><li>Resources</li><li>Utilities
<em>These are <code>folders</code> which contain various files that our toolbar will utilize.</em></li></ol><ul><li><em>Note that these are not necessarily aligned with <code>namespaces</code> (which will be covered later)</em></li></ul><hr><h1 id=2-what-is-a-class>2. What is a Class?<a hidden class=anchor aria-hidden=true href=#2-what-is-a-class>#</a></h1><ol><li>In C#, classes are templates related to the creation and management of objects. There are many predefined <code>classes</code> available in C# and the Revit API.</li><li>We use them for a wide range of things and will regularly be creating and developing our own classes.</li></ol><hr><h3 id=accessing-properties--methods-of-a-class>Accessing properties / methods of a Class<a hidden class=anchor aria-hidden=true href=#accessing-properties--methods-of-a-class>#</a></h3><ol><li>Property:<ol><li><code>object.Property</code> -> to access a property</li></ol></li><li>Method:<ol><li><code>Object.Method(argument1, argument2, etc)</code> -> to access a method</li></ol></li></ol><h3 id=namespaces>Namespaces<a hidden class=anchor aria-hidden=true href=#namespaces>#</a></h3><ol><li>When we create classes, we first tell them where they belong in our project.</li><li><code>Namespaces</code> can be nested within others using a dot separator, eventually tied back to our <code>.addin</code> namespace.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#75715e>// Revit API</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> Autodesk.Revit.Attributes;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> Autodesk.Revit.UI;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// geeWiz - internal project objects</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> geeWiz.Extensions;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> geeWiz = geeWiz.Forms;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> geeWiz = geeWiz.Utilities.Workshare_Utils;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// The class belongs to the Commands namespace</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> geeWiz.Cmds_Audit
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Cmd_DeletePatterns</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Cmd_PurgeRooms</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Cmd_PurgeTemplates</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Cmd_PurgeFilters</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=basic-class-anatomy>Basic Class Anatomy<a hidden class=anchor aria-hidden=true href=#basic-class-anatomy>#</a></h3><ol><li><code>modifers class ClassName : Interface(s)</code><ol><li>Constructor (optional)</li><li>Properties (optional)</li><li>Methods (optional)</li></ol></li></ol><ul><li><code>Access modifiers</code> control how this code can be accessed inside and outside your project.</li><li>You will typically need to declare at least on of <em><strong><code>public/private</code></strong></em>,<ul><li>And sometimes <em><strong><code>static</code></strong></em> for the purposes we will use them for early on.</li></ul></li></ul><h3 id=static-modifier><code>Static</code> Modifier<a hidden class=anchor aria-hidden=true href=#static-modifier>#</a></h3><ul><li>The <code>static</code> <code>access</code> <code>modifier</code> is a difficult concept to grasp at first, so we will simplify it somewhat.<ul><li>Classes with a <code>static</code> <code>modifier</code> do not support the creation of <code>objects</code> of that <code>class</code> (instantiated).</li><li>We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us.</li></ul></li></ul><blockquote><p>So basically, the <code>Static</code> <code>modifier</code> is one instrument that you could use to build a complex script with.</p></blockquote><h3 id=public-and-private-modifier><code>Public</code> and <code>Private</code> Modifier<a hidden class=anchor aria-hidden=true href=#public-and-private-modifier>#</a></h3><ul><li>The <em><strong><code>public</code></strong></em> modifier lets you access something anywhere in your project.</li><li>The <em><strong><code>private</code></strong></em> modifier limits access to the same class instead (generally for behind-the-scenes code in the class itself).</li></ul><p><em>There are <code>other modifiers</code>, but let&rsquo;s keep it simple.</em></p><h3 id=class-declaration>Class Declaration<a hidden class=anchor aria-hidden=true href=#class-declaration>#</a></h3><p><code>modifiers class ClassName : Interface(s)</code></p><p>After our modifiers we must define our class by using the keyword &lsquo;class&rsquo;, followed by a Class Name.</p><p>Generally, most people use <code>PascalCase</code> for class names, and you should choose names which are not reserved elsewhere.</p><h3 id=interfaces-optional>Interface(s) (Optional)<a hidden class=anchor aria-hidden=true href=#interfaces-optional>#</a></h3><p><code>modifiers class ClassName : Interface(s)</code></p><p><code>Interface</code> - acts as a template that a class should follow. It&rsquo;s like a contract that is formed with your class -> the class must have certain methods / properties / behaviours that this interface would provide to it.</p><p><strong>Formally:</strong></p><ul><li><code>Interfaces</code> are optional agreements that the class must form with predefined <code>class</code> templates.</li><li>They usually provide <code>methods</code> and <code>properties</code> which would otherwise be cumbersome to access/define, as well as ensuring the class follows some requirements.</li></ul><h2 id=referencing-a-class>Referencing a Class<a hidden class=anchor aria-hidden=true href=#referencing-a-class>#</a></h2><h3 id=static-example-access-without-creating-an-instance><code>Static</code> example (access without creating an instance):<a hidden class=anchor aria-hidden=true href=#static-example-access-without-creating-an-instance>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>var</span> myInstance = ClassName;
</span></span></code></pre></div><ul><li>A <strong><code>static</code></strong> class or member belongs to the <strong>class itself</strong>, not to any specific object.</li><li>You use the <strong><code>class name</code></strong> to access it directly.</li><li>You can call its <code>methods</code> or <code>properties</code> right away ‚Äî no need to create an object.</li><li>Because it‚Äôs static, you <strong>cannot</strong> use new to make an instance of it.</li></ul><p><em>Example:</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#75715e>// Accessing a static property without creating Math object</span>
</span></span><span style=display:flex><span>Console.WriteLine(Math.PI); 
</span></span></code></pre></div><h3 id=non-static-example--create-and-use-an-object><code>Non-static</code> example ‚Äì Create and use an object<a hidden class=anchor aria-hidden=true href=#non-static-example--create-and-use-an-object>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>var</span> myInstance = <span style=color:#66d9ef>new</span> ClassName();
</span></span></code></pre></div><ul><li>A <strong><code>non-static</code></strong> class needs to be <strong>instantiated</strong> (created) before you can use it.</li><li>You create a new object using the new keyword and parentheses () to run its <code>constructor</code>.</li><li>The variable <code>myInstance</code> now <strong>refers to this new object</strong>, and you can use its methods and properties.</li><li>The var keyword tells the compiler to figure out the variable‚Äôs type automatically.</li></ul><p><em>Example:</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>var</span> car = <span style=color:#66d9ef>new</span> Car();  
</span></span><span style=display:flex><span>car.Drive(); <span style=color:#75715e>// Calling an instance method</span>
</span></span></code></pre></div><h3 id=homework>Homework<a hidden class=anchor aria-hidden=true href=#homework>#</a></h3><p>Let&rsquo;s do the following:</p><ul><li>Set up a <code>class</code> file (.cs) in our project,</li><li>Create a <code>namespace</code> for it,</li><li>Define our class (<code>non-static</code>, <code>public</code>).</li></ul><p><em>Its purpose is to store and process results from forms we create.</em></p><h3 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#75715e>// 1. Create a new folder (if you haven&#39;t already) and call it &#39;Forms&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 2. Add a new item to &#39;Forms&#39; -&gt; pick the &#39;Class&#39; type -&gt; name it: &#34;Custom.cs&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collection.Generic;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Linq;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Text;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Threading.Tasks;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> guRoo.Forms <span style=color:#75715e>// try to make your namespace follow your folder structure</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Custom</span> <span style=color:#75715e>// change to &#39;public&#39; + &#39;static&#39; class </span>
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormResult</span> <span style=color:#75715e>// add another &#39;non-static&#39; class</span>
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><p>Here‚Äôs a cleaner, beginner-friendly rewrite with improved structure, simpler explanations, and a working example that will actually compile.</p><p>I‚Äôve also made the terminology more precise and added a clear <strong>generic vs. specific constructor</strong> example.</p><hr><h1 id=3-constructors>3. Constructors<a hidden class=anchor aria-hidden=true href=#3-constructors>#</a></h1><blockquote><p>Optional but very useful</p></blockquote><p>A <code>constructor</code> is a special method that runs automatically when you create a new object from a class:</p><ul><li>It <strong>tells the <code>class</code> how it should start</strong> ‚Äî for example, setting initial values.</li><li>If you don‚Äôt add a constructor, C# uses a <strong>default constructor</strong> that simply sets <code>properties</code> to their default values, or formally: C# provides an <strong>implicit <code>parameterless</code> constructor</strong> that sets members to their type defaults.</li><li>You can make your own constructor to set specific values when an object is created.</li><li>A class can have <strong>multiple constructors</strong> (called <strong>constructor overloading</strong>), which is a form of <code>polymorphism</code>.</li></ul><hr><h3 id=constructor-syntax>Constructor Syntax<a hidden class=anchor aria-hidden=true href=#constructor-syntax>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ClassName</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Constructor with parameters</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ClassName(type parameterName)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Initialization logic</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h3 id=example-generic-vs-specific-constructor><strong>Example: Generic vs. Specific Constructor</strong><a hidden class=anchor aria-hidden=true href=#example-generic-vs-specific-constructor>#</a></h3><p>Let‚Äôs create a FormResult class with two constructors:</p><ol><li><strong><code>Generic</code> constructor</strong> ‚Äì takes no arguments (creates a form with default values)</li><li><strong><code>Specific</code> constructor</strong> ‚Äì allows setting a custom status when creating the form</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>namespace</span> guRoo.Forms <span style=color:#75715e>// Use namespaces that match your folder structure</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormResult</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Status { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 1. Generic constructor (no parameters)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> FormResult()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Status = <span style=color:#e6db74>&#34;Pending&#34;</span>; <span style=color:#75715e>// Default value</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 2. Specific constructor (with parameter)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> FormResult(<span style=color:#66d9ef>string</span> status)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Status = status;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h3 id=using-the-constructors><strong>Using the Constructors</strong><a hidden class=anchor aria-hidden=true href=#using-the-constructors>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#75715e>// Using the generic constructor</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> form1 = <span style=color:#66d9ef>new</span> FormResult();
</span></span><span style=display:flex><span>Console.WriteLine(form1.Status); <span style=color:#75715e>// Output: Pending</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Using the specific constructor</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> form2 = <span style=color:#66d9ef>new</span> FormResult(<span style=color:#e6db74>&#34;Cancelled&#34;</span>);
</span></span><span style=display:flex><span>Console.WriteLine(form2.Status); <span style=color:#75715e>// Output: Cancelled</span>
</span></span></code></pre></div><hr><h3 id=homework-1><strong>Homework</strong><a hidden class=anchor aria-hidden=true href=#homework-1>#</a></h3><p>In this exercise, you‚Äôll learn how to create <strong>two different constructors</strong> in a class ‚Äî one that uses a <strong>default value</strong> and one that accepts a <strong>custom value</strong> when creating an object.</p><p>We‚Äôll do this in a <strong>Revit API context</strong> by making a simple SheetResult class that stores the <strong>name of a sheet</strong>.</p><p><strong>Your task:</strong></p><ol><li>Create a new class called SheetResult in <code>Custom.cs</code>.</li><li>Add:<ul><li>A <code>generic</code> constructor (no parameters) that sets the <code>SheetName</code> property to &ldquo;Untitled Sheet&rdquo;.</li><li>A <code>specific</code> constructor (with a parameter) that accepts a string and sets <code>SheetName</code> to the provided value.<ul><li>Note: if you add the <code>specific</code> constructor, also add the <code>parameterless</code> one yourself.</li></ul></li></ul></li><li>In <code>Custom.cs</code>, create a static method <code>ShowSheetResultDemo()</code> that:<ul><li>Creates one <code>SheetResult</code> using the <code>generic</code> constructor.</li><li>Creates another <code>SheetResult</code> using the <code>specific</code> constructor with a <code>custom name</code>.</li><li>Displays both names in a <code>TaskDialog</code>.</li></ul></li><li>In your <code>StartupCommand.Execute()</code> method, call <code>Custom.ShowSheetResultDemo()</code> to run the demo inside Revit.</li></ol><p>üí° <em>This will help you understand how constructors work in C#, and how you can use them to set up different ways of creating an object in your Revit add-ins.</em></p><h4 id=solution-copy-paste---compile--test-it-in-revit>Solution (Copy Paste -> Compile & Test it in Revit)<a hidden class=anchor aria-hidden=true href=#solution-copy-paste---compile--test-it-in-revit>#</a></h4><h4 id=customcs><code>Custom.cs</code><a hidden class=anchor aria-hidden=true href=#customcs>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>using</span> Autodesk.Revit.UI;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> guRoo.Forms
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Custom</span> <span style=color:#75715e>// helper you can call from anywhere</span>
</span></span><span style=display:flex><span>¬† ¬† {
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> ShowSheetResultDemo()
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† {
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#66d9ef>var</span> sheet1 = <span style=color:#66d9ef>new</span> SheetResult(); ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e>// generic</span>
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#66d9ef>var</span> sheet2 = <span style=color:#66d9ef>new</span> SheetResult(<span style=color:#e6db74>&#34;A101 - Floor Plan&#34;</span>);¬† <span style=color:#75715e>// specific</span>
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† ¬† ¬† 
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† ¬† ¬† TaskDialog.Show(<span style=color:#e6db74>&#34;Sheet Results&#34;</span>,
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#e6db74>$&#34;Generic constructor: {sheet1.SheetName}\n&#34;</span> +
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#e6db74>$&#34;Specific constructor: {sheet2.SheetName}&#34;</span>);
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† }
</span></span><span style=display:flex><span>¬† ¬† }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SheetResult</span>
</span></span><span style=display:flex><span>¬† ¬† {
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> SheetName { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Parameterless (generic) constructor</span>
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† <span style=color:#66d9ef>public</span> SheetResult() =&gt; SheetName = <span style=color:#e6db74>&#34;Untitled Sheet&#34;</span>; ¬† ¬† 
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Constructor with parameters (specific)</span>
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† <span style=color:#66d9ef>public</span> SheetResult(<span style=color:#66d9ef>string</span> sheetName) =&gt; SheetName = sheetName; 
</span></span><span style=display:flex><span>¬† ¬† }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=startupcommandcs><code>StartupCommand.cs</code><a hidden class=anchor aria-hidden=true href=#startupcommandcs>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>using</span> guRoo.Forms; <span style=color:#75715e>// add this</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>void</span> Execute()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...your existing code...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Custom.ShowSheetResultDemo(); <span style=color:#75715e>// &lt;-- shows the dialog from Custom.cs</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h1 id=4-properties>4. Properties<a hidden class=anchor aria-hidden=true href=#4-properties>#</a></h1><p>Properties define the <strong>data</strong> that a <code>class</code> can store and expose.</p><p>While you <em>can</em> make properties publicly accessible, best practice is to keep the underlying data <strong><code>private</code></strong> (inside the class) and control access through <strong>public</strong> get and set accessors.</p><p>This approach:</p><ul><li>Keeps the internal state of your object safe from unintended changes.</li><li>Lets you add validation or extra logic when reading or writing values.</li></ul><p>In simple examples, we‚Äôll mostly use <strong>auto-implemented properties</strong> (<code>public string Name { get; set; }</code>), but we‚Äôll also show how to back them with <strong><code>private fields</code></strong> when you need more control.</p><h3 id=declaring-a-property>Declaring a property<a hidden class=anchor aria-hidden=true href=#declaring-a-property>#</a></h3><p>A property is like a <strong>named piece of data</strong> that belongs to a <code>class</code>. The simplest form is an <strong>auto-implemented property</strong>, which C# creates for you without needing to write extra code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span>Class declaration
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	modifiers type PropertyName{<span style=color:#66d9ef>get</span>;<span style=color:#66d9ef>set</span>}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; } <span style=color:#75715e>// auto property</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=using-a-private-field>Using a private field<a hidden class=anchor aria-hidden=true href=#using-a-private-field>#</a></h3><p>Sometimes you want more control over how a property‚Äôs value is stored or changed. In that case, you can store the value in a <strong>private field</strong> and use a property to <strong>get</strong> and <strong>set</strong> it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ClassName</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> type fieldName; <span style=color:#75715e>// lowerCamelCase for fields</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> type PropertyName <span style=color:#75715e>// PascalCase for properties</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> fieldName; }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>set</span> { fieldName = <span style=color:#66d9ef>value</span>; }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=example>Example:<a hidden class=anchor aria-hidden=true href=#example>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>string</span> name; <span style=color:#75715e>// field</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name   <span style=color:#75715e>// property</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> name; }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>set</span> { name = <span style=color:#66d9ef>value</span>; }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>üí° <em>Tip:</em> By convention, <strong>fields</strong> use camelCase and <strong>properties</strong> use PascalCase. This makes it easier to spot them in your code.</p></blockquote><h3 id=homework-2>Homework<a hidden class=anchor aria-hidden=true href=#homework-2>#</a></h3><p>Properties let us store and access data in a class. In our earlier example, the <code>SheetResult</code> class only had a <code>SheetName</code> property.</p><p><strong>Your task:</strong></p><ul><li>Let‚Äôs expand it to include more information ‚Äî for example, the <code>SheetNumber</code></li><li>And show both a simple <code>auto-property</code> and a property backed by a <code>private field</code>.</li></ul><hr><h3 id=solution-1>Solution<a hidden class=anchor aria-hidden=true href=#solution-1>#</a></h3><h4 id=customcs-1><code>Custom.cs</code><a hidden class=anchor aria-hidden=true href=#customcs-1>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>using</span> Autodesk.Revit.UI;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> guRoo.Forms
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ===== STATIC CLASS =====</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Custom</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ===== METHOD =====</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> ShowSheetResultDemo()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Create objects</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> sheet1 = <span style=color:#66d9ef>new</span> SheetResult(); <span style=color:#75715e>// generic constructor</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> sheet2 = <span style=color:#66d9ef>new</span> SheetResult(<span style=color:#e6db74>&#34;A101 - Floor Plan&#34;</span>, <span style=color:#e6db74>&#34;S-001&#34;</span>); <span style=color:#75715e>// specific constructor</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Show results in Revit dialog</span>
</span></span><span style=display:flex><span>            TaskDialog.Show(<span style=color:#e6db74>&#34;Sheet Results&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>$&#34;Generic constructor: {sheet1.SheetName}, Number: {sheet1.SheetNumber}\n&#34;</span> +
</span></span><span style=display:flex><span>                <span style=color:#e6db74>$&#34;Specific constructor: {sheet2.SheetName}, Number: {sheet2.SheetNumber}&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ===== END METHOD =====</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ===== END STATIC CLASS =====</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ===== CLASS =====</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SheetResult</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ===== PROPERTIES =====</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Auto-implemented property</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> SheetName { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Private field + property with get/set logic</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>string</span> sheetNumber;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> SheetNumber
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> sheetNumber; }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>set</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Example: basic validation</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>string</span>.IsNullOrWhiteSpace(<span style=color:#66d9ef>value</span>))
</span></span><span style=display:flex><span>                    sheetNumber = <span style=color:#e6db74>&#34;No Number&#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                    sheetNumber = <span style=color:#66d9ef>value</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ===== END PROPERTIES =====</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ===== CONSTRUCTORS =====</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Generic constructor</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> SheetResult()
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            SheetName = <span style=color:#e6db74>&#34;Untitled Sheet&#34;</span>;
</span></span><span style=display:flex><span>            SheetNumber = <span style=color:#e6db74>&#34;No Number&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Specific constructor</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> SheetResult(<span style=color:#66d9ef>string</span> sheetName, <span style=color:#66d9ef>string</span> sheetNumber = <span style=color:#e6db74>&#34;No Number&#34;</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            SheetName = sheetName;
</span></span><span style=display:flex><span>            SheetNumber = sheetNumber;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ===== END CONSTRUCTORS =====</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ===== END CLASS =====</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=what-changed><strong>What Changed?</strong><a hidden class=anchor aria-hidden=true href=#what-changed>#</a></h4><ul><li><strong>Auto property</strong>: <code>SheetName</code> ‚Äî quick and simple, no custom logic.</li><li><strong>Property with private field</strong>: <code>SheetNumber</code> ‚Äî lets us add validation before saving the value.</li><li><strong>Constructors updated</strong> so both values can be set when creating a <code>SheetResult</code>.</li></ul><h4 id=result-in-revit><strong>Result in Revit</strong><a hidden class=anchor aria-hidden=true href=#result-in-revit>#</a></h4><p>When you run <code>StartupCommand</code>, you‚Äôll still get your original workflow, but now the <code>Custom.ShowSheetResultDemo()</code> dialog will display <strong>both the sheet name and the sheet number</strong>, with ‚ÄúNo Number‚Äù automatically set if no value is given.</p><hr><h1 id=5-methods>5. Methods<a hidden class=anchor aria-hidden=true href=#5-methods>#</a></h1><p>A <strong>method</strong> is an action your <code>class</code> can perform.</p><p>While <strong>properties</strong> store data, <strong>methods</strong> usually <em>do something</em> ‚Äî either with the data in the class or with arguments you pass to them.</p><ul><li><p>You <strong>call</strong> a method in a similar way to accessing a property, but methods can take <strong>arguments</strong> (optional) and can run multiple lines of logic.</p></li><li><p>Instead of declaring a <em>type</em> (like a property), you declare a <code>return</code> <strong>type</strong> ‚Äî the type of value the method sends back to you when it finishes.</p></li><li><p>If the method doesn‚Äôt return anything, use the <code>void</code> keyword as the return type.</p></li></ul><h3 id=declaring-a-method>Declaring a method<a hidden class=anchor aria-hidden=true href=#declaring-a-method>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ClassName</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    modifiers returnType MethodName(optionalArguments)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Code logic here</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> objectOfType; <span style=color:#75715e>// Only if the method returns a value</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=example-1>Example:<a hidden class=anchor aria-hidden=true href=#example-1>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Calculator</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Add(<span style=color:#66d9ef>int</span> a, <span style=color:#66d9ef>int</span> b)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> a + b; <span style=color:#75715e>// Returns the sum</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> ShowMessage(<span style=color:#66d9ef>string</span> message)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Console.WriteLine(message); <span style=color:#75715e>// Returns nothing (void)</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=homework-3>Homework<a hidden class=anchor aria-hidden=true href=#homework-3>#</a></h3><ul><li>Add some <code>properties</code></li><li>Demonstrate how to use a <code>field</code></li><li>Demonstrate how to make a <code>method</code></li><li>Call on our <code>class</code> in some code</li></ul><h3 id=disposal>Disposal<a hidden class=anchor aria-hidden=true href=#disposal>#</a></h3><ul><li>Later on, we will look into other things we can make use of, such as specifying what happens to our class instances when they are <code>disposed</code>.</li><li>Generally, an object will be <code>disposed</code> when it us not needed anymore. The compiler tracks and determines when this occurs for us, but we can also manually dispose of or with the disposal of objects.</li></ul><p><em><strong>From there, we&rsquo;ve learnt all about classes!</strong></em></p><p>We now have a basic understanding of:</p><ol><li><code>Classes</code> in C#</li><li>Access <code>modifiers</code></li><li><code>Initialization</code></li><li><code>Properties</code> and <code>methods</code></li><li><code>Namespaces</code></li></ol><h1 id=6-interfaces>6. Interfaces<a hidden class=anchor aria-hidden=true href=#6-interfaces>#</a></h1><ul><li>Interfaces provide abstract templates (sometimes called contracts) by which classes must more specifically implement them.</li><li>By the end of this lesson we will have implemented two in our add-in.</li></ul><h3 id=interface-example>Interface Example<a hidden class=anchor aria-hidden=true href=#interface-example>#</a></h3><ul><li>This interface entails that any class implementing it must have 2 properties and methods.</li><li>They are abstractly provided and are specifically built in the class itself.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#75715e>// Pseudo Code</span>
</span></span><span style=display:flex><span>IAnimal 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> Legs;
</span></span><span style=display:flex><span><span style=color:#66d9ef>string</span> Name;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> MakeNoise();
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#75715e>// Real Implementation</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Dog</span>: IAnimal
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> Legs = <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>string</span> Name = <span style=color:#e6db74>&#34;Dog&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> MakeNoise()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	Dog.Woof();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>We provide the interface to the <code>Dog class</code>, which will in turn expect the properties and method to be specified further.</li><li>You can add more than 1 interface to a class and we usually name interfaces with a prefix of &lsquo;<code>I</code>&rsquo;.</li></ul><h3 id=argument-provision>Argument provision<a hidden class=anchor aria-hidden=true href=#argument-provision>#</a></h3><ul><li>Many Interfaces provided by the Revit API have further code support included for us.</li><li>For example, Interfaces commonly provide methods which are triggered by events. We do not have to set up the sender/receiver methods if we implement the interface, only specify what happens when the event occurs.</li></ul><h2 id=application-variants>Application Variants<a hidden class=anchor aria-hidden=true href=#application-variants>#</a></h2><ul><li>When we implement our two interfaces, we will be using some special types.</li></ul><h4 id=uicontrolledapplication><em><strong><code>UIControlledApplication</code></strong></em><a hidden class=anchor aria-hidden=true href=#uicontrolledapplication>#</a></h4><ul><li>Provides access to the Revit application, is commonly on startup and shutdown, where a document is not yet available.</li></ul><h4 id=controlledapplication><em><strong><code>ControlledApplication</code></strong></em><a hidden class=anchor aria-hidden=true href=#controlledapplication>#</a></h4><ul><li>Represents the application service, giving us access to documents, options, and application specific settings (e.g. language).</li></ul><h4 id=uiapplication><em><strong><code>UIApplication</code></strong></em><a hidden class=anchor aria-hidden=true href=#uiapplication>#</a></h4><ul><li>Similar to UIControlledApplication, but it is available during our session. We will be using this a lot and in a future lesson we will register it to a globally accessible variable.</li></ul><h4 id=uidocument><em><strong><code>UIDocument</code></strong></em><a hidden class=anchor aria-hidden=true href=#uidocument>#</a></h4><ul><li>Represents the current document at a UI level, providing access to aspects such as selection and opened views.</li></ul><h4 id=document><em><strong><code>Document</code></strong></em><a hidden class=anchor aria-hidden=true href=#document>#</a></h4><ul><li>Represents the current document, providing access to many Revit API classes, methods, and properties at the document level, e.g. collecting elements in the document.</li></ul><h3 id=how-we-can-access-them>How we can access them?<a hidden class=anchor aria-hidden=true href=#how-we-can-access-them>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span>uiCtlApp <span style=color:#75715e>// Available at start-up/shutdown</span>
</span></span><span style=display:flex><span>ctlApp   <span style=color:#75715e>// uiCtlApp.ControlledApplication</span>
</span></span><span style=display:flex><span>uiApp    <span style=color:#75715e>// Idling event / via commands</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>uiDoc    <span style=color:#75715e>// uiApp.ActiveUIDocument </span>
</span></span><span style=display:flex><span>doc      <span style=color:#75715e>// uiDoc.Document</span>
</span></span></code></pre></div><h3 id=homework-4>Homework<a hidden class=anchor aria-hidden=true href=#homework-4>#</a></h3><ul><li>Implement <em><strong><code>IExternalApplication</code></strong></em></li><li>Implement <em><strong><code>IExternalCommand</code></strong></em></li><li>Collect the <em><strong><code>ControlledApplication</code></strong></em></li><li>Collect the <em><strong><code>Document</code></strong></em> in a command</li></ul><p><strong>We now have a basic understanding of:</strong></p><ul><li><code>Interfaces</code></li><li><code>IExternalApplication</code></li><li><code>IExternalCommand</code></li><li><code>Application</code> Classes</li><li><code>Document</code> Classes</li></ul><h1 id=7-create-a-pushbutton>7. Create a <code>PushButton</code><a hidden class=anchor aria-hidden=true href=#7-create-a-pushbutton>#</a></h1><ul><li>Let&rsquo;s set up a button we can run our command from (we had this before, but we&rsquo;re doing it the typical way vs the <code>Nice3Point</code> way).</li><li>We will create a tab, a panel, a button and finally set up a basic command that runs when we press it.</li></ul><h2 id=understanding-names>Understanding Names<a hidden class=anchor aria-hidden=true href=#understanding-names>#</a></h2><ol><li><code>RibbonTab</code></li><li><code>RibbonPanel</code><ol><li><code>Ribbon</code></li></ol></li><li><code>PushButton</code></li></ol><h3 id=what-do-we-need-to-do>What do we need to do?<a hidden class=anchor aria-hidden=true href=#what-do-we-need-to-do>#</a></h3><ol><li>Create our <code>add-in</code> Tab</li><li>Add a <code>RibbonPanel</code> to the Tab</li><li>Add a <code>PushButton</code> to the Ribbon Panel</li></ol><h4 id=related-api-classes><em>Related API Classes:</em><a hidden class=anchor aria-hidden=true href=#related-api-classes>#</a></h4><ol><li><code>UIControlledApplication</code> > Tab</li><li><code>Tab</code> > <code>RibbonPannel</code></li><li><code>RibbonPanel</code> > <code>PushButtonData</code> > <code>PushButton</code></li></ol><h4 id=properties-of-a-pushbutton><em>Properties of a PushButton</em><a hidden class=anchor aria-hidden=true href=#properties-of-a-pushbutton>#</a></h4><ol><li><strong><code>AssemblyName</code></strong> - Assembly Path of the Button</li><li><strong><code>AvailabilityClassName</code></strong> - The full class name of the class providing the entry point to decide availability of this push button.</li><li><strong><code>ClassName</code></strong> - The name of the class containing the implementation for the command.</li><li><strong><code>Enabled</code></strong> - Gets or sets a value indicating whether the item is enabled.</li><li><strong><code>Image</code></strong> - The image of the button.</li><li><strong><code>IsEnabledByContext</code></strong> - Indicates if this button can be executed. True is the pushbutton is permitted to be executed based on the current Revit context (active doc, active view, active tool). False if the pushbutton is disabled because of the active context.</li><li><strong><code>ItemText</code></strong> - Gets or sets the text displayed of the item.</li><li><strong><code>ItemType</code></strong> - Get the item type.</li><li><strong><code>LargeImage</code></strong> - The large image shown on the button.</li><li><strong><code>LongDescription</code></strong> - Long description of the command tooltip.</li><li><strong><code>Name</code></strong> - The name of the item.</li><li><strong><code>ToolTip</code></strong> - The description that appears as a ToolTip for the item.</li><li><strong><code>ToolTipImage</code></strong> - The image to show as a part of the button extended tooltip.</li><li><strong><code>Visible</code></strong> - Gets or sets a value indicating whether the item is visible.</li></ol><h4 id=one-important-method---getribbonpanels>One Important Method -> GetRibbonPanels<a hidden class=anchor aria-hidden=true href=#one-important-method---getribbonpanels>#</a></h4><ol><li><code>GetRibbonPannels</code> - Get all the custom Panels on Add-Ins Tab of Revit.</li><li><code>GetRibbonPannels</code>(String) - Get all the custom Panels on a designated Revit Tab.</li><li><code>GetRibbonPannel</code>(Tab) - Get all the custom Panels on a designated standard Revit Tab.</li></ol><h2 id=executing-assembly>Executing Assembly<a hidden class=anchor aria-hidden=true href=#executing-assembly>#</a></h2><ul><li>When our add-in is running, all the classes, resources and code we have produced are executed as an Assembly. We will access this to connect commands to buttons.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Reflection
</span></span><span style=display:flex><span>Assembly.GetExecutingAssembly()
</span></span></code></pre></div><h2 id=homework-5>Homework<a hidden class=anchor aria-hidden=true href=#homework-5>#</a></h2><ol><li>Create a <code>static</code> utility class</li><li>Add <code>methods</code> to <code>static utility class</code> that we need</li><li>Run these methods in <code>OnStartup</code> method</li></ol><p>In the next video, we will add to this:</p><ul><li>Create and assign <code>icons</code> and <code>tooltips</code>,</li><li>Develop a naming system to simplify it all.</li></ul><h1 id=8-global-variables>8. <code>Global</code> Variables<a hidden class=anchor aria-hidden=true href=#8-global-variables>#</a></h1><p>Some programming languages support &lsquo;<code>global</code>&rsquo; variables, which can be accessed anywhere at any time once set in the project.</p><p>To my knowledge, C# does not have a dedicated system for this. We can still achieve this by utilizing a static class that is dedicated to storing and providing these, however.</p><ul><li>Let&rsquo;s set up a Globals Class, which will give us access to objects that would otherwise be inaccessible from various areas of our project.</li><li>We will also look at how we can use an event to capture the <code>UIApplication</code>.</li></ul><h3 id=why-cant-we-get-the-uiapp>Why can&rsquo;t we get the <code>UiApp</code>?<a hidden class=anchor aria-hidden=true href=#why-cant-we-get-the-uiapp>#</a></h3><p>We will collect most variables on startup, but the <code>UiApplication</code> is not available during this time in Revit. In order to collect it we will take advantage of the <code>OnIdling Event</code>.</p><h2 id=events-101>Events 101<a hidden class=anchor aria-hidden=true href=#events-101>#</a></h2><ol><li>Events provide us the ability to have code that executes when various events occur in an application. For example, run a code whenever the view is changed.</li><li>When Revit is available, it is said to be <strong><code>Idling</code></strong> (not doing anything). The <strong><code>OnIdling</code></strong> event is commonly used to run some code as soon as Revit is available for code to be run.</li></ol><h2 id=basic-subunsub-syntax>Basic <code>Sub/Unsub</code> syntax<a hidden class=anchor aria-hidden=true href=#basic-subunsub-syntax>#</a></h2><p>Subscribe to <code>Idling</code> event
<code>UICtlApp.Idling += MethodName</code></p><p>Unsubsribe from <code>idling</code> event
<code>UICtlApp.Idling -= MethodName</code></p><p><em>In most cases, you will want your method to unsubscribe itself once it has run.</em></p><h2 id=homework-6>Homework<a hidden class=anchor aria-hidden=true href=#homework-6>#</a></h2><ol><li>Create a static Globals Class</li><li>Add properties and registration</li><li>Register the <code>UiApp</code> using IdlingEvent</li></ol><blockquote><p>These tutorials were inspired by the work of <a href=https://www.youtube.com/@AussieBIMGuru>Aussie BIM Guru</a>. If you‚Äôre looking for a deeper dive into the topics, check out his channel for detailed explanations.</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.aydrafting.com/tags/c%23/>C#</a></li><li><a href=https://blog.aydrafting.com/tags/revit/>Revit</a></li><li><a href=https://blog.aydrafting.com/tags/tutorial/>Tutorial</a></li></ul><nav class=paginav><a class=prev href=https://blog.aydrafting.com/posts/post-8/><span class=title>¬´ Prev</span><br><span>C# + Revit API: Lesson 8 - Tooltips & Icons -> Extension Methods</span>
</a><a class=next href=https://blog.aydrafting.com/posts/post-6/><span class=title>Next ¬ª</span><br><span>C# + Revit API: Lesson 6 - try & catch Statements</span></a></nav></footer></article></main><footer class=footer><span>¬© 2025 AYDrafting. All rights reserved.</span> ¬∑
<span>Powered by
<a href=https://aydrafting.com/ rel="noopener noreferrer" target=_blank>AYDrafting</a> &
<a href=https://github.com/aydimir95/ rel=noopener target=_blank>GitHub</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>