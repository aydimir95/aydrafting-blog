<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>C# &#43; Revit API: Lesson 6 - try &amp; catch Statements | Blog</title>
<meta name="keywords" content="C#, Revit, Tutorial">
<meta name="description" content="Pseudocode


1
2
3
4
5
6
7
8


try 
{
	try to do this;
}
catch
{
	if try gets exception, rollback and do this;
}


Exceptions

Exceptions come in many forms and Revit API Docs typically specifies the types of Exceptions we can catch for its methods. There are also system type exceptions.


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14


catch // Exception as &#34;e&#34; to print the error
{
	To catch a specific exceptions, catch as e;
}
catch
{
	To catch all exceptions, do this; 
	// but better to catch specific exceptions, 
	// otherwise you will catch all necessary and unecessary exceptions.
}
finally
{
	To run a final code regardless of outcome;
}



Use Don&rsquo;t Abuse

When you first begin using languages, try statements seem great - you can write code, and if you make a mistake your code can continue. THIS IS WRONG!">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/lesson-6/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css" integrity="sha256-bVhUcqQJqPUE5r&#43;Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/lesson-6/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/lesson-6/">
  <meta property="og:site_name" content="Blog">
  <meta property="og:title" content="C# &#43; Revit API: Lesson 6 - try & catch Statements">
  <meta property="og:description" content="Pseudocode 1 2 3 4 5 6 7 8 try { try to do this; } catch { if try gets exception, rollback and do this; } Exceptions Exceptions come in many forms and Revit API Docs typically specifies the types of Exceptions we can catch for its methods. There are also system type exceptions.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 catch // Exception as &#34;e&#34; to print the error { To catch a specific exceptions, catch as e; } catch { To catch all exceptions, do this; // but better to catch specific exceptions, // otherwise you will catch all necessary and unecessary exceptions. } finally { To run a final code regardless of outcome; } Use Don’t Abuse When you first begin using languages, try statements seem great - you can write code, and if you make a mistake your code can continue. THIS IS WRONG!">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-08T11:47:12+03:00">
    <meta property="article:modified_time" content="2025-08-08T11:47:12+03:00">
    <meta property="article:tag" content="C#">
    <meta property="article:tag" content="Revit">
    <meta property="article:tag" content="Tutorial">
    <meta property="og:image" content="http://localhost:1313/images/Pasted%20image%2020250902205255.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/Pasted%20image%2020250902205255.png">
<meta name="twitter:title" content="C# &#43; Revit API: Lesson 6 - try &amp; catch Statements">
<meta name="twitter:description" content="Pseudocode


1
2
3
4
5
6
7
8


try 
{
	try to do this;
}
catch
{
	if try gets exception, rollback and do this;
}


Exceptions

Exceptions come in many forms and Revit API Docs typically specifies the types of Exceptions we can catch for its methods. There are also system type exceptions.


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14


catch // Exception as &#34;e&#34; to print the error
{
	To catch a specific exceptions, catch as e;
}
catch
{
	To catch all exceptions, do this; 
	// but better to catch specific exceptions, 
	// otherwise you will catch all necessary and unecessary exceptions.
}
finally
{
	To run a final code regardless of outcome;
}



Use Don&rsquo;t Abuse

When you first begin using languages, try statements seem great - you can write code, and if you make a mistake your code can continue. THIS IS WRONG!">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "C# + Revit API: Lesson 6 - try \u0026 catch Statements",
      "item": "http://localhost:1313/posts/lesson-6/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C# + Revit API: Lesson 6 - try \u0026 catch Statements",
  "name": "C# \u002b Revit API: Lesson 6 - try \u0026 catch Statements",
  "description": "Pseudocode 1 2 3 4 5 6 7 8 try { try to do this; } catch { if try gets exception, rollback and do this; } Exceptions Exceptions come in many forms and Revit API Docs typically specifies the types of Exceptions we can catch for its methods. There are also system type exceptions.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 catch // Exception as \u0026#34;e\u0026#34; to print the error { To catch a specific exceptions, catch as e; } catch { To catch all exceptions, do this; // but better to catch specific exceptions, // otherwise you will catch all necessary and unecessary exceptions. } finally { To run a final code regardless of outcome; } Use Don\u0026rsquo;t Abuse When you first begin using languages, try statements seem great - you can write code, and if you make a mistake your code can continue. THIS IS WRONG!\n",
  "keywords": [
    "C#", "Revit", "Tutorial"
  ],
  "articleBody": "Pseudocode 1 2 3 4 5 6 7 8 try { try to do this; } catch { if try gets exception, rollback and do this; } Exceptions Exceptions come in many forms and Revit API Docs typically specifies the types of Exceptions we can catch for its methods. There are also system type exceptions.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 catch // Exception as \"e\" to print the error { To catch a specific exceptions, catch as e; } catch { To catch all exceptions, do this; // but better to catch specific exceptions, // otherwise you will catch all necessary and unecessary exceptions. } finally { To run a final code regardless of outcome; } Use Don’t Abuse When you first begin using languages, try statements seem great - you can write code, and if you make a mistake your code can continue. THIS IS WRONG!\nTry statements should be used only when you know there is a chance an exception could occur, and it cannot be otherwise dealt with.\nYou should make them as robust as possible, and use them only for parts of your code that need them.\nDON’T DO THIS! 1 2 3 4 5 6 7 8 try { all code; } catch { oh no, somethis went wrong; } Example – Creating a Revit Sheet with Error Handling 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 using Autodesk.Revit.DB; using Autodesk.Revit.UI; using System; public class CreateSheetExample { public void CreateSheet(Document doc, ElementId titleBlockId) { try { using (Transaction tx = new Transaction(doc, \"Create New Sheet\")) { tx.Start(); try { // Attempt to create a sheet ViewSheet sheet = ViewSheet.Create(doc, titleBlockId); TaskDialog.Show(\"Success\", $\"Sheet '{sheet.Name}' created!\"); tx.Commit(); } catch (Autodesk.Revit.Exceptions. ArgumentException argEx) { // Rollback and handle known Revit-specific error tx.RollBack(); TaskDialog.Show(\"Error\", $\"Invalid title block: {argEx.Message}\"); } catch (Exception ex) { // Rollback for unexpected system-level errors tx.RollBack(); TaskDialog.Show(\"Unexpected Error\", ex.Message); } } } finally { // Always run this, no matter success or failure TaskDialog.Show(\"Info\", \"Finished attempting to create a sheet.\"); } } } These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.\n",
  "wordCount" : "416",
  "inLanguage": "en",
  "image":"http://localhost:1313/images/Pasted%20image%2020250902205255.png","datePublished": "2025-08-08T11:47:12+03:00",
  "dateModified": "2025-08-08T11:47:12+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/lesson-6/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Blog (Alt + H)">Blog</a>
        </div>

        
        <div class="logo main-logo">
            <a href="https://aydrafting.com" target="_blank">
                <img src="/LogoAYD.png" alt="Blog" height="40">
            </a>
        </div>

        
        <div class="logo-switches">
            <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        </div>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      C# &#43; Revit API: Lesson 6 - try &amp; catch Statements
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='Created: 2025-08-08 11:47:12 +0300 MSK'>August 8, 2025</span>&nbsp;·&nbsp;2 min&nbsp;|&nbsp;<a href="mailto:%20aydimir@aydrafting.com" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/images/Pasted%20image%2020250902205255.png" alt="try & catch Statements">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#pseudocode" aria-label="Pseudocode">Pseudocode</a><ul>
                        
                <li>
                    <a href="#exceptions" aria-label="Exceptions">Exceptions</a></li>
                <li>
                    <a href="#use-dont-abuse" aria-label="Use Don&rsquo;t Abuse">Use Don&rsquo;t Abuse</a></li>
                <li>
                    <a href="#dont-do-this" aria-label="DON&rsquo;T DO THIS!">DON&rsquo;T DO THIS!</a></li></ul>
                </li>
                <li>
                    <a href="#example--creating-a-revit-sheet-with-error-handling" aria-label="Example – Creating a Revit Sheet with Error Handling">Example – Creating a Revit Sheet with Error Handling</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="pseudocode">Pseudocode<a hidden class="anchor" aria-hidden="true" href="#pseudocode">#</a></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">try</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">try</span> <span class="n">to</span> <span class="k">do</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">catch</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="k">try</span> <span class="n">gets</span> <span class="n">exception</span><span class="p">,</span> <span class="n">rollback</span> <span class="n">and</span> <span class="k">do</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="exceptions">Exceptions<a hidden class="anchor" aria-hidden="true" href="#exceptions">#</a></h2>
<blockquote>
<p>Exceptions come in many forms and Revit API Docs typically specifies the types of Exceptions we can catch for its methods. There are also system type exceptions.</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">catch</span> <span class="c1">// Exception as &#34;e&#34; to print the error</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">To</span> <span class="k">catch</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">exceptions</span><span class="p">,</span> <span class="k">catch</span> <span class="k">as</span> <span class="n">e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">catch</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">To</span> <span class="k">catch</span> <span class="n">all</span> <span class="n">exceptions</span><span class="p">,</span> <span class="k">do</span> <span class="k">this</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">	<span class="c1">// but better to catch specific exceptions, </span>
</span></span><span class="line"><span class="cl">	<span class="c1">// otherwise you will catch all necessary and unecessary exceptions.</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">finally</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">To</span> <span class="n">run</span> <span class="n">a</span> <span class="n">final</span> <span class="n">code</span> <span class="n">regardless</span> <span class="n">of</span> <span class="n">outcome</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="use-dont-abuse">Use Don&rsquo;t Abuse<a hidden class="anchor" aria-hidden="true" href="#use-dont-abuse">#</a></h2>
<blockquote>
<p>When you first begin using languages, try statements seem great - you can write code, and if you make a mistake your code can continue. THIS IS WRONG!</p></blockquote>
<blockquote>
<p>Try statements should be used only when you know there is a chance an exception could occur, and it cannot be otherwise dealt with.</p></blockquote>
<blockquote>
<p>You should make them as robust as possible, and use them only for parts of your code that need them.</p></blockquote>
<h2 id="dont-do-this">DON&rsquo;T DO THIS!<a hidden class="anchor" aria-hidden="true" href="#dont-do-this">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">try</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">all</span> <span class="n">code</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">catch</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">oh</span> <span class="n">no</span><span class="p">,</span> <span class="n">somethis</span> <span class="n">went</span> <span class="n">wrong</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="example--creating-a-revit-sheet-with-error-handling">Example – Creating a Revit Sheet with Error Handling<a hidden class="anchor" aria-hidden="true" href="#example--creating-a-revit-sheet-with-error-handling">#</a></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.DB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">CreateSheetExample</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">CreateSheet</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">,</span> <span class="n">ElementId</span> <span class="n">titleBlockId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">using</span> <span class="p">(</span><span class="n">Transaction</span> <span class="n">tx</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Transaction</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">            <span class="s">&#34;Create New Sheet&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">tx</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="k">try</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// Attempt to create a sheet</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ViewSheet</span> <span class="n">sheet</span> <span class="p">=</span> <span class="n">ViewSheet</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">titleBlockId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Success&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                    <span class="s">$&#34;Sheet &#39;{sheet.Name}&#39; created!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    <span class="n">tx</span><span class="p">.</span><span class="n">Commit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">catch</span> <span class="p">(</span><span class="n">Autodesk</span><span class="p">.</span><span class="n">Revit</span><span class="p">.</span><span class="n">Exceptions</span><span class="p">.</span>
</span></span><span class="line"><span class="cl">                <span class="n">ArgumentException</span> <span class="n">argEx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// Rollback and handle known Revit-specific error</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tx</span><span class="p">.</span><span class="n">RollBack</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Error&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                    <span class="s">$&#34;Invalid title block: {argEx.Message}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// Rollback for unexpected system-level errors</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tx</span><span class="p">.</span><span class="n">RollBack</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Unexpected Error&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                    <span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">finally</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Always run this, no matter success or failure</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Info&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">            <span class="s">&#34;Finished attempting to create a sheet.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>These tutorials were inspired by the work of <a href="https://www.youtube.com/@AussieBIMGuru">Aussie BIM Guru</a>. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.</p></blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/c%23/">C#</a></li>
      <li><a href="http://localhost:1313/tags/revit/">Revit</a></li>
      <li><a href="http://localhost:1313/tags/tutorial/">Tutorial</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/lesson-7/">
    <span class="title">« Prev</span>
    <br>
    <span>C# &#43; Revit API: Lesson 7 - Object Oriented Programming</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/lesson-5/">
    <span class="title">Next »</span>
    <br>
    <span>C# &#43; Revit API: Lesson 5 - `if` Statements</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© 2025 AYDrafting. All rights reserved.</span> · 

    <span>
        Powered by
        <a href="https://aydrafting.com/" rel="noopener noreferrer" target="_blank">AYDrafting</a> &
        <a href="https://github.com/aydimir95/" rel="noopener" target="_blank">GitHub</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
