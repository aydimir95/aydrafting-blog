<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>C# &#43; Revit API: Lesson 8 - Tooltips &amp; Icons | Blog</title>
<meta name="keywords" content="C#, Revit, Tutorial">
<meta name="description" content="In the previous lesson, we built a PushButton using classes, constructors, properties, methods, interfaces, and a few global variables. In this lesson, we’ll put that button in its proper place on the ribbon and make sure everything—panel, icon, and tooltip—works end to end:
This is what we are trying to create:

Ribbon
Panel
PushButton
Icon
Tooltip



We will cover how to manage resource/command naming,
And, how to easily manage tooltips for our tools,
As well as, the standard/large image icons,
Finally, we will test the tool in action.

Base Command Naming


1
2
3
4
5


// Command namespace
guRoo.Cmds_GroupName

//Command Class
guRoo.Cmds_GroupName.Cmd_CommandName


Preferred Method:


1
2
3
4
5
6
7
8
9


// Before: 
guRoo.Cmds_GroupName
// After:
GroupName 

//Before:
guRoo.Cmds_GroupName.Cmd_CommandName
//After
GroupName._CommandName 


The Approach we will use:


1
2
3
4
5


guRoo.Cmds_GroupName.Cmd_CommandName
// Remove guRoo.Cmds_
GroupName.Cmd_CommandName
// Remove .Cmd
GrouName_CommandName


Or you can make things even more resilient by using:


1


typeof(CommandName).FullName


Tooltipkey is base name:


1
2


GrouName
GroupName_CommandName


Icons:


1
2
3
4


GroupName##
GroupName_CommandName##

## = Reolusion in pixels (16 or 32)


How we will manage Tooltips
We will create a Resources (resx) file in C# and embed this into our project. It will be available in memory for our project whilst it runs to access. We will store the tooltip and description as a dictionary of keys and values.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/post-8/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css" integrity="sha256-bVhUcqQJqPUE5r&#43;Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/post-8/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/post-8/">
  <meta property="og:site_name" content="Blog">
  <meta property="og:title" content="C# &#43; Revit API: Lesson 8 - Tooltips & Icons">
  <meta property="og:description" content="In the previous lesson, we built a PushButton using classes, constructors, properties, methods, interfaces, and a few global variables. In this lesson, we’ll put that button in its proper place on the ribbon and make sure everything—panel, icon, and tooltip—works end to end:
This is what we are trying to create:
Ribbon Panel PushButton Icon Tooltip We will cover how to manage resource/command naming, And, how to easily manage tooltips for our tools, As well as, the standard/large image icons, Finally, we will test the tool in action. Base Command Naming 1 2 3 4 5 // Command namespace guRoo.Cmds_GroupName //Command Class guRoo.Cmds_GroupName.Cmd_CommandName Preferred Method: 1 2 3 4 5 6 7 8 9 // Before: guRoo.Cmds_GroupName // After: GroupName //Before: guRoo.Cmds_GroupName.Cmd_CommandName //After GroupName._CommandName The Approach we will use: 1 2 3 4 5 guRoo.Cmds_GroupName.Cmd_CommandName // Remove guRoo.Cmds_ GroupName.Cmd_CommandName // Remove .Cmd GrouName_CommandName Or you can make things even more resilient by using: 1 typeof(CommandName).FullName Tooltipkey is base name: 1 2 GrouName GroupName_CommandName Icons: 1 2 3 4 GroupName## GroupName_CommandName## ## = Reolusion in pixels (16 or 32) How we will manage Tooltips We will create a Resources (resx) file in C# and embed this into our project. It will be available in memory for our project whilst it runs to access. We will store the tooltip and description as a dictionary of keys and values.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-08T13:13:50+03:00">
    <meta property="article:modified_time" content="2025-08-08T13:13:50+03:00">
    <meta property="article:tag" content="C#">
    <meta property="article:tag" content="Revit">
    <meta property="article:tag" content="Tutorial">
      <meta property="og:image" content="http://localhost:1313/LogoAYD.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/LogoAYD.png">
<meta name="twitter:title" content="C# &#43; Revit API: Lesson 8 - Tooltips &amp; Icons">
<meta name="twitter:description" content="In the previous lesson, we built a PushButton using classes, constructors, properties, methods, interfaces, and a few global variables. In this lesson, we’ll put that button in its proper place on the ribbon and make sure everything—panel, icon, and tooltip—works end to end:
This is what we are trying to create:

Ribbon
Panel
PushButton
Icon
Tooltip



We will cover how to manage resource/command naming,
And, how to easily manage tooltips for our tools,
As well as, the standard/large image icons,
Finally, we will test the tool in action.

Base Command Naming


1
2
3
4
5


// Command namespace
guRoo.Cmds_GroupName

//Command Class
guRoo.Cmds_GroupName.Cmd_CommandName


Preferred Method:


1
2
3
4
5
6
7
8
9


// Before: 
guRoo.Cmds_GroupName
// After:
GroupName 

//Before:
guRoo.Cmds_GroupName.Cmd_CommandName
//After
GroupName._CommandName 


The Approach we will use:


1
2
3
4
5


guRoo.Cmds_GroupName.Cmd_CommandName
// Remove guRoo.Cmds_
GroupName.Cmd_CommandName
// Remove .Cmd
GrouName_CommandName


Or you can make things even more resilient by using:


1


typeof(CommandName).FullName


Tooltipkey is base name:


1
2


GrouName
GroupName_CommandName


Icons:


1
2
3
4


GroupName##
GroupName_CommandName##

## = Reolusion in pixels (16 or 32)


How we will manage Tooltips
We will create a Resources (resx) file in C# and embed this into our project. It will be available in memory for our project whilst it runs to access. We will store the tooltip and description as a dictionary of keys and values.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "C# + Revit API: Lesson 8 - Tooltips \u0026 Icons",
      "item": "http://localhost:1313/posts/post-8/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C# + Revit API: Lesson 8 - Tooltips \u0026 Icons",
  "name": "C# \u002b Revit API: Lesson 8 - Tooltips \u0026 Icons",
  "description": "In the previous lesson, we built a PushButton using classes, constructors, properties, methods, interfaces, and a few global variables. In this lesson, we’ll put that button in its proper place on the ribbon and make sure everything—panel, icon, and tooltip—works end to end:\nThis is what we are trying to create:\nRibbon Panel PushButton Icon Tooltip We will cover how to manage resource/command naming, And, how to easily manage tooltips for our tools, As well as, the standard/large image icons, Finally, we will test the tool in action. Base Command Naming 1 2 3 4 5 // Command namespace guRoo.Cmds_GroupName //Command Class guRoo.Cmds_GroupName.Cmd_CommandName Preferred Method: 1 2 3 4 5 6 7 8 9 // Before: guRoo.Cmds_GroupName // After: GroupName //Before: guRoo.Cmds_GroupName.Cmd_CommandName //After GroupName._CommandName The Approach we will use: 1 2 3 4 5 guRoo.Cmds_GroupName.Cmd_CommandName // Remove guRoo.Cmds_ GroupName.Cmd_CommandName // Remove .Cmd GrouName_CommandName Or you can make things even more resilient by using: 1 typeof(CommandName).FullName Tooltipkey is base name: 1 2 GrouName GroupName_CommandName Icons: 1 2 3 4 GroupName## GroupName_CommandName## ## = Reolusion in pixels (16 or 32) How we will manage Tooltips We will create a Resources (resx) file in C# and embed this into our project. It will be available in memory for our project whilst it runs to access. We will store the tooltip and description as a dictionary of keys and values.\n",
  "keywords": [
    "C#", "Revit", "Tutorial"
  ],
  "articleBody": "In the previous lesson, we built a PushButton using classes, constructors, properties, methods, interfaces, and a few global variables. In this lesson, we’ll put that button in its proper place on the ribbon and make sure everything—panel, icon, and tooltip—works end to end:\nThis is what we are trying to create:\nRibbon Panel PushButton Icon Tooltip We will cover how to manage resource/command naming, And, how to easily manage tooltips for our tools, As well as, the standard/large image icons, Finally, we will test the tool in action. Base Command Naming 1 2 3 4 5 // Command namespace guRoo.Cmds_GroupName //Command Class guRoo.Cmds_GroupName.Cmd_CommandName Preferred Method: 1 2 3 4 5 6 7 8 9 // Before: guRoo.Cmds_GroupName // After: GroupName //Before: guRoo.Cmds_GroupName.Cmd_CommandName //After GroupName._CommandName The Approach we will use: 1 2 3 4 5 guRoo.Cmds_GroupName.Cmd_CommandName // Remove guRoo.Cmds_ GroupName.Cmd_CommandName // Remove .Cmd GrouName_CommandName Or you can make things even more resilient by using: 1 typeof(CommandName).FullName Tooltipkey is base name: 1 2 GrouName GroupName_CommandName Icons: 1 2 3 4 GroupName## GroupName_CommandName## ## = Reolusion in pixels (16 or 32) How we will manage Tooltips We will create a Resources (resx) file in C# and embed this into our project. It will be available in memory for our project whilst it runs to access. We will store the tooltip and description as a dictionary of keys and values.\nWe will access this using the dedicated ResourceManager class.\nHow we will manage Icons Revit tools feature 2 icon types:\nImage -\u003e 16x16px (96dpi) icon which shows at a smaller resolution (e.g. in pulldown, quick access). LargeImage -\u003e 32x32px (96dpi) icon which shows at a larger resolution (e.g. in PushButtons). We will store our icons as embedded resources also in a PNG format. We will use a ResourceStream in order to decode these resources into a bitmap in our application.\nStreaming resources is quite common in C/C# and allows decoding of memory into suitable resources, such as an ImageSource.\nConsolidation Functionality The goal here ultimately is to make the process of adding/assigning icons to our tools as simple as possible for the user.\nThis will get around repetitive code, as well as providing a better entry environment for long text inputs such as tooltips.\nHomework Create a command \u003e base name converter Set up a tooltips resource Read, store and assign a tooltip Set up icon files in 16/32 px format Assign the Icons to our Pushbuttons Test the changes Solution Revit API PushButtonData Class - ultimately we are just setting Properties of the ButtonData. Properties we are really interested in are: Image, LargeImage, ToolTip.\nName Description AssemblyName The assembly path of the button. AvailabilityClassName The full class name for the class providing the entry point to decide availablility of this push button. ClassName The name of the Class containing the implementation for the command. Image The image of the button. LargeImage The large image of the button. LongDescription Long description of the command tooltip. Name The name of the item. Text The user-visible text of the button. ToolTip The description that appears as a ToolTip for the item. ToolTipImage The image to show as a part of the button extended tooltip. Tips:\nImage - requires an ImageSource which is a Windows C# .NET - API. icons8.com - great resource to find icons for your buttons. photopea.com - to adjust the resolution of the icons downloaded from icons8 website. Code Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e General |-\u003e Cmds_General.cs |-\u003e Forms |-\u003e General |-\u003e Globals.cs // ---------\u003e Update |-\u003e Resources |-\u003e Files //---------------\u003e Add \"Files\" Folder |-\u003e Tooltips.resx //---\u003e Add \"Resources File\" item |-\u003e Icons //---------------\u003e Add \"Icons\" Folder |-\u003e Icons16 //-------------\u003e Add \"Icons16\" Folder |-\u003e General_test16.png // Add an Icon 16px |-\u003e Icons32 //-------------\u003e Add \"Icons32\" Folder |-\u003e General_test32.png // Add an Icon 32px |-\u003e Utilities |-\u003e Ribbon_Utils.cs //-----\u003e Update |-\u003e Application.cs //----------\u003e Update |-\u003e guRoo.addin Ribbon_Utils.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 using Autodesk.Revit.UI; using System.Diagnostics; namespace guRoo.Utilities { public static class Ribbon_Utils { // Method to create a \"Tab\" public static Result AddRibbonTab(UIControlledApplication uiCtlApp,string tabName) { try { uiCtlApp.CreateRibbonTab(tabName); return Result.Succeeded; } catch { Debug.WriteLine($\"Error: Could not create a tab: {tabName}\"); return Result.Failed; } } // Method to create a \"Panel\" public static RibbonPanel AddRibbonPanelToTab(UIControlledApplication uiCtlApp, string tabName, string panelName) { try { var panel = uiCtlApp.CreateRibbonPanel(tabName, panelName); return panel; } catch { Debug.WriteLine($\"Error: Could not add {panelName} to {tabName}\"); return null; } } // Method to get that \"Panel\" public static RibbonPanel GetRibbonPanelByName(UIControlledApplication uiCtlApp, string tabName, string panelName) { var panels = uiCtlApp.GetRibbonPanels(tabName); foreach (var panel in panels) { if (panel.Name == panelName) return panel; } // Not found return null; } // Method to create a \"Button\" to \"Panel\" /// /// Fill this summary for Methods to be described on Mouse Hover. /// /// This is the RibbonPanel to add to. /// Test /// Test /// Test /// Test /// public static PushButton AddPushButtonToPanel(RibbonPanel panel, string buttonName, string className) // string internalName, -\u003e NOT NEEDED ANYMORE // string assemblyPath)-\u003e NOT NEEDED ANYMORE { if (panel is null) { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } // Open PushButtonData Constructor and check what's needed // ====The Updated Part 2 Start==== // Get the base name from below var baseName = CommandToBaseName(className); // ====The Updated Part 2 End==== // Create a PushButtonData object: var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className); // if the button was made - return it: if (panel.AddItem(pushButtonData) is PushButton pushButton) { pushButton.ToolTip = LookupTooltip(baseName); // We will come back to this: // ====The Updated Part 4 Start==== pushButton.Image = GetIcon(baseName, resolution: 16); pushButton.LargeImage = GetIcon(baseName, resolution: 32); // ====The Updated Part 4 End==== return pushButton; } else { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } } // ====The Updated Part 1 Start==== // Method to get the base name of a command: public static string CommandToBaseName(string commandName) { return commandName.Replace(\"guRoo.Cmds_\", \"\").Replace(\".Cmd\", \"\"); } // Method to get a value from a dictionary key public static string LookupTooltip(string key, string failValue = null) { failValue ??= \"No tooltip value was found.\"; // ??= -\u003e if this is null set it to the following if (Globals.Tooltips.TryGetValue(key, out string value)) { return value; } return failValue; } // ====The Updated Part 1 End==== // ====The Updated Part 3 Start==== // Method to get an icon as an image source public static ImageSource GetIcon(string baseName, int resolution = 32) { var resourcePath = $\"guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png\"; using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath)) { if (stream is null) { return null; } var decoder = new PngBitmapDecoder( stream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); if (decoder.Frames.Count \u003e 0) { return decoder.Frames.First(); } else { return null; } } } // All you have to do now, is assign these icons back where we added a PushButton // ====The Updated Part 3 End==== } } Tooltips.resx Create Tooltips.resx under …/Resources/Files/Tooltips.resx Once created, click Add Resource + button on the top left of the screen. Add the following 2 Resources: Name Value Comment General_Test This is a working tooltip.\nWe can do extra lines. General_Test2 This is a working tooltip.\nWe can do extra lines. Properties Then make sure the properties of the Tooltips.resx are set as follows: Advanced: Value Build Action Embedded resource Copy to Output Directory Do not copy Custom Tool ResXFileCodeGenerator Mics: Value File Name Tooltips.resx Full Path …/Tooltips.resx Globals.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 using Autodesk.Revit.ApplicationServices; using Autodesk.Revit.UI; using System.Collections; using System.Globalization; using System.Resources; using Assembly = System.Reflection.Assembly; namespace guRoo { public static class Globals { #region Properties // Applications public static UIControlledApplication UiCtlApp { get; set; } public static ControlledApplication CtlApp { get; set; } public static UIApplication UiApp { get; set; } // Assembly public static Assembly Assembly { get; set; } // Ambiguity or missing ref public static string AssemblyPath { get; set; } // Revit Versions public static string RevitVersion { get; set; } public static int RevitVersionInt { get; set; } // User Names public static string UsernameRevit { get; set; } public static string UsernameWindows { get; set; } // GUIDs and Versioning public static string AddinVersionNumber { get; set; } public static string AddinVersionName { get; set; } public static string AddinName { get; set; } public static string AddinGuid { get; set; } #endregion // Dictionaries for resources as a Dict Name public static Dictionary\u003cstring, string\u003e Tooltips { get; set; } = new Dictionary\u003cstring, string\u003e(); #region Register Method // Method to Register Variable Properties public static void RegisterProperties(UIControlledApplication uiCtlApp) { UiCtlApp = uiCtlApp; CtlApp = uiCtlApp.ControlledApplication; // UiApp set on idling Assembly = Assembly.GetExecutingAssembly(); AssemblyPath = Assembly.Location; RevitVersion = CtlApp.VersionNumber; RevitVersionInt = Int32.Parse(RevitVersion); // Revit Username set to idling UsernameWindows = Environment.UserName; AddinVersionNumber = \"25.08.12\"; AddinVersionName = \"WIP\"; AddinName = \"guRoo\"; AddinGuid = \"5FD7523B-5832-4AB8-9B3D-0BE7ACFE1207\"; } #endregion // Register our tooltup (Microsoft API Methods) public static void RegisterTooltips(string resourcePath) { var resourceManager = new ResourceManager(resourcePath,typeof(Application).Assembly); var resourceSet = resourceManager.GetResourceSet(CultureInfo.CurrentCulture, true, true); foreach (DictionaryEntry entry in resourceSet) { var key = entry.Key.ToString(); var value = entry.Value.ToString(); Tooltips[key] = value; // Don't forget to register our Tooltip in the Application.cs } } } } Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 // Autodesk using Autodesk.Revit.UI; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // ===========Register Tooltips=========== Globals.RegisterTooltips(\"guRoo.Resources.Files.Tooltips\"); #endregion #region Removed because we added the Global Variables: // Collect the controlled application: // var ctlApp = uiCtlApp.ControlledApplication; // var assembly = Assembly.GetExecutingAssembly(); // avr assemblyPath = assembly.Location; // Variables // string tabName = \"guRoo\" #endregion #region Ribbon setup // Add RibbonTab uRib.AddRibbonTab(uiCtlApp, Globals.AddinName); // Create RibbonPanel var panelGeneral = uRib.AddRibbonPanelToTab(uiCtlApp, Globals.AddinName, \"General\"); // =====Updated Part===== // Add PushButton to RibbonPanel var buttonTest = uRib.AddPushButtonToPanel(panelGeneral, \"Testing\", \"guRoo.Cmds_General.Cmd_Test\"); // Adjust it in Ribbon_Utils.cs // =====Updated Part===== #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } Add Icons to Resources folder Add 2 folders under Resources: Icons16 Icons32 Go to Icons8.com Search and download the icons you need @ resolution 80x80. Go to Photopea.com Create a New Project 96 Width, 96 Height, 96 DPI -\u003e Create File -\u003e Open -\u003e Choose the downloaded icon Image -\u003e Image Size -\u003e Width=32, Height=32, DPI=96 -\u003e OK File -\u003e Export as -\u003e PNG Image -\u003e Image Size -\u003e Width=16, Height=16, DPI=96 -\u003e OK File -\u003e Export as -\u003e PNG Place those 2 exported images to the folders you created earlier: Icons16 Name: General_test16.png Icons32 Name: General_test32.png In the Properties of the images you have to make sure: Build Action -\u003e Embedded Resource To make things even easier, we can make sure the Build Action gets set to Embedded Resource for all images added to the Icons folders, here how you would do that:\nGo to the Solution Explorer and double click on your project name guRoo in this case. Then you should find the following: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u003cPropertyGroup\u003e \u003cIsRepackable\u003etrue\u003c/IsRepackable\u003e \u003cDeployRevitAddin\u003etrue\u003c/DeployRevitAddin\u003e \u003c/PropertyGroup\u003e \u003cItemGroup\u003e \u003cNone Remove=\"Resources\\Icons16\\General_test16.png\" /\u003e \u003cNone Remove=\"Resources\\Icons32\\General_test32.png\" /\u003e \u003c/ItemGroup\u003e \u003cItemGroup\u003e \u003cEmbeddedResource Include=\"Resources\\Icons16\\General_test16.png\" /\u003e \u003cEmbeddedResource Include=\"Resources\\Icons32\\General_test32.png\" /\u003e \u003c/ItemGroup\u003e You should just replace the name of the images with a star *: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u003cPropertyGroup\u003e \u003cIsRepackable\u003etrue\u003c/IsRepackable\u003e \u003cDeployRevitAddin\u003etrue\u003c/DeployRevitAddin\u003e \u003c/PropertyGroup\u003e \u003cItemGroup\u003e \u003cNone Remove=\"Resources\\Icons16\\*.png\" /\u003e \u003cNone Remove=\"Resources\\Icons32\\*.png\" /\u003e \u003c/ItemGroup\u003e \u003cItemGroup\u003e \u003cEmbeddedResource Include=\"Resources\\Icons16\\*.png\" /\u003e \u003cEmbeddedResource Include=\"Resources\\Icons32\\*.png\" /\u003e \u003c/ItemGroup\u003e That’s it, now every image you are going to place under these folders would automatically be Embedded as Resources after you Build this project. Now we are going to add a Method to get an icon as an image source back in the Ribbon_Utils.cs. Summary All of this was done to make it super easy for you to create new buttons, from now on, you will be able to create a new button, simply by: Going to Application.cs Find this part: 1 2 3 4 5 6 // Add PushButton to RibbonPanel var buttonTest = uRib.AddPushButtonToPanel( panelGeneral, \"Testing\", \"guRoo.Cmds_General.Cmd_Test\"); And just Make sure to: Get the Command Class right = guRoo.Cmds_General.Cmd_Test Give it a Name = Testing And specify what Panel is it going on = panelGeneral Finally, add the Icons \u0026 Tooltips, that’s it, you have a New Button. These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.\n",
  "wordCount" : "2524",
  "inLanguage": "en",
  "image": "http://localhost:1313/LogoAYD.png","datePublished": "2025-08-08T13:13:50+03:00",
  "dateModified": "2025-08-08T13:13:50+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/post-8/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Blog (Alt + H)">Blog</a>
        </div>

        
        <div class="logo main-logo">
            <a href="https://aydrafting.com" target="_blank">
                <img src="/LogoAYD.png" alt="Blog" height="40">
            </a>
        </div>

        
        <div class="logo-switches">
            <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        </div>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      C# &#43; Revit API: Lesson 8 - Tooltips &amp; Icons
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2025-08-08 13:13:50 +0300 MSK'>August 8, 2025</span>&nbsp;·&nbsp;12 min&nbsp;|&nbsp;<a href="mailto:%20aydimir@aydrafting.com" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#base-command-naming" aria-label="Base Command Naming">Base Command Naming</a><ul>
                        
                <li>
                    <a href="#preferred-method" aria-label="Preferred Method:">Preferred Method:</a></li>
                <li>
                    <a href="#the-approach-we-will-use" aria-label="The Approach we will use:">The Approach we will use:</a></li>
                <li>
                    <a href="#or-you-can-make-things-even-more-resilient-by-using" aria-label="Or you can make things even more resilient by using:">Or you can make things even more resilient by using:</a><ul>
                        
                <li>
                    <a href="#tooltipkey-is-base-name" aria-label="Tooltipkey is base name:">Tooltipkey is base name:</a></li>
                <li>
                    <a href="#icons" aria-label="Icons:">Icons:</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#how-we-will-manage-tooltips" aria-label="How we will manage Tooltips">How we will manage Tooltips</a></li>
                <li>
                    <a href="#how-we-will-manage-icons" aria-label="How we will manage Icons">How we will manage Icons</a><ul>
                        
                <li>
                    <a href="#consolidation-functionality" aria-label="Consolidation Functionality">Consolidation Functionality</a></li></ul>
                </li>
                <li>
                    <a href="#homework" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#revit-api" aria-label="Revit API">Revit API</a></li>
                <li>
                    <a href="#code" aria-label="Code">Code</a><ul>
                        
                <li>
                    <a href="#project-solution" aria-label="Project Solution">Project Solution</a></li>
                <li>
                    <a href="#ribbon_utilscs" aria-label="Ribbon_Utils.cs">Ribbon_Utils.cs</a></li>
                <li>
                    <a href="#tooltipsresx" aria-label="Tooltips.resx">Tooltips.resx</a><ul>
                        
                <li>
                    <a href="#properties" aria-label="Properties">Properties</a></li></ul>
                </li>
                <li>
                    <a href="#globalscs" aria-label="Globals.cs">Globals.cs</a></li>
                <li>
                    <a href="#applicationcs" aria-label="Application.cs">Application.cs</a></li>
                <li>
                    <a href="#add-icons-to-resources-folder" aria-label="Add Icons to Resources folder">Add Icons to Resources folder</a></li>
                <li>
                    <a href="#summary" aria-label="Summary">Summary</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>In the previous lesson, we built a <code>PushButton</code> using classes, constructors, properties, methods, interfaces, and a few global variables. In this lesson, we’ll put that button in its proper place on the ribbon and make sure everything—panel, icon, and tooltip—works end to end:</p>
<p><strong>This is what we are trying to create:</strong></p>
<ol>
<li><code>Ribbon</code></li>
<li><code>Panel</code></li>
<li><code>PushButton</code></li>
<li><code>Icon</code></li>
<li><code>Tooltip</code>
<img alt="Pasted image 20250813140525.png" loading="lazy" src="/images/Pasted%20image%2020250813140525.png"></li>
</ol>
<ul>
<li>We will cover how to manage <code>resource</code>/<code>command</code> naming,</li>
<li>And, how to easily manage <code>tooltips</code> for our tools,</li>
<li>As well as, the <code>standard</code>/<code>large</code> image <code>icons</code>,</li>
<li>Finally, we will test the <code>tool</code> in action.</li>
</ul>
<h1 id="base-command-naming">Base Command Naming<a hidden class="anchor" aria-hidden="true" href="#base-command-naming">#</a></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Command namespace</span>
</span></span><span class="line"><span class="cl"><span class="n">guRoo</span><span class="p">.</span><span class="n">Cmds_GroupName</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//Command Class</span>
</span></span><span class="line"><span class="cl"><span class="n">guRoo</span><span class="p">.</span><span class="n">Cmds_GroupName</span><span class="p">.</span><span class="n">Cmd_CommandName</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="preferred-method">Preferred Method:<a hidden class="anchor" aria-hidden="true" href="#preferred-method">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Before: </span>
</span></span><span class="line"><span class="cl"><span class="n">guRoo</span><span class="p">.</span><span class="n">Cmds_GroupName</span>
</span></span><span class="line"><span class="cl"><span class="c1">// After:</span>
</span></span><span class="line"><span class="cl"><span class="n">GroupName</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//Before:</span>
</span></span><span class="line"><span class="cl"><span class="n">guRoo</span><span class="p">.</span><span class="n">Cmds_GroupName</span><span class="p">.</span><span class="n">Cmd_CommandName</span>
</span></span><span class="line"><span class="cl"><span class="c1">//After</span>
</span></span><span class="line"><span class="cl"><span class="n">GroupName</span><span class="p">.</span><span class="n">_CommandName</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="the-approach-we-will-use">The Approach we will use:<a hidden class="anchor" aria-hidden="true" href="#the-approach-we-will-use">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">guRoo</span><span class="p">.</span><span class="n">Cmds_GroupName</span><span class="p">.</span><span class="n">Cmd_CommandName</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Remove guRoo.Cmds_</span>
</span></span><span class="line"><span class="cl"><span class="n">GroupName</span><span class="p">.</span><span class="n">Cmd_CommandName</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Remove .Cmd</span>
</span></span><span class="line"><span class="cl"><span class="n">GrouName_CommandName</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="or-you-can-make-things-even-more-resilient-by-using">Or you can make things even more resilient by using:<a hidden class="anchor" aria-hidden="true" href="#or-you-can-make-things-even-more-resilient-by-using">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">typeof</span><span class="p">(</span><span class="n">CommandName</span><span class="p">).</span><span class="n">FullName</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="tooltipkey-is-base-name">Tooltipkey is base name:<a hidden class="anchor" aria-hidden="true" href="#tooltipkey-is-base-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">GrouName</span>
</span></span><span class="line"><span class="cl"><span class="n">GroupName_CommandName</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="icons">Icons:<a hidden class="anchor" aria-hidden="true" href="#icons">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">GroupName</span><span class="err">##</span>
</span></span><span class="line"><span class="cl"><span class="n">GroupName_CommandName</span><span class="err">##</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="p">=</span> <span class="n">Reolusion</span> <span class="k">in</span> <span class="n">pixels</span> <span class="p">(</span><span class="m">16</span> <span class="n">or</span> <span class="m">32</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="how-we-will-manage-tooltips">How we will manage <code>Tooltips</code><a hidden class="anchor" aria-hidden="true" href="#how-we-will-manage-tooltips">#</a></h1>
<p>We will create a <code>Resources</code> (resx) file in C# and embed this into our project. It will be available in memory for our project whilst it runs to access. We will store the tooltip and description as a <code>dictionary</code> of <code>keys</code> and <code>values</code>.</p>
<p>We will access this using the dedicated <code>ResourceManager</code> class.</p>
<h1 id="how-we-will-manage-icons">How we will manage <code>Icons</code><a hidden class="anchor" aria-hidden="true" href="#how-we-will-manage-icons">#</a></h1>
<p>Revit tools feature 2 icon types:</p>
<ol>
<li><code>Image</code> -&gt; 16x16px (96dpi) icon which shows at a smaller resolution (e.g. in <code>pulldown</code>, quick access).</li>
<li><code>LargeImage</code> -&gt; 32x32px (96dpi) icon which shows at a larger resolution (e.g. in <code>PushButtons</code>).</li>
</ol>
<p>We will store our icons as embedded resources also in a <code>PNG</code> format. We will use a <strong>ResourceStream</strong> in order to decode these resources into a bitmap in our application.</p>
<p><strong>Streaming</strong> resources is quite common in C/C# and allows <code>decoding</code> of memory into suitable resources, such as an <strong>ImageSource</strong>.</p>
<h2 id="consolidation-functionality">Consolidation Functionality<a hidden class="anchor" aria-hidden="true" href="#consolidation-functionality">#</a></h2>
<blockquote>
<p>The goal here ultimately is to make the process of adding/assigning <code>icons</code> to our tools as simple as possible for the user.</p></blockquote>
<blockquote>
<p>This will get around repetitive code, as well as providing a better entry environment for long text inputs such as tooltips.</p></blockquote>
<h1 id="homework">Homework<a hidden class="anchor" aria-hidden="true" href="#homework">#</a></h1>
<ul>
<li>Create a <code>command</code> &gt; base <code>name</code> converter</li>
<li>Set up a tooltips <code>resource</code></li>
<li><code>Read</code>, <code>store</code> and <code>assign</code> a tooltip</li>
<li>Set up <code>icon</code> files in 16/32 px format</li>
<li>Assign the Icons to our <code>Pushbuttons</code></li>
<li><code>Test</code> the changes</li>
</ul>
<h1 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h1>
<h2 id="revit-api">Revit API<a hidden class="anchor" aria-hidden="true" href="#revit-api">#</a></h2>
<blockquote>
<p><code>PushButtonData</code> Class - ultimately we are just setting Properties of the ButtonData.
Properties we are really interested in are:
<code>Image</code>,
<code>LargeImage</code>,
<code>ToolTip</code>.</p></blockquote>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>AssemblyName</code></td>
          <td>The assembly path of the button.</td>
      </tr>
      <tr>
          <td><code>AvailabilityClassName</code></td>
          <td>The full class name for the class providing the entry point to decide availablility of this push button.</td>
      </tr>
      <tr>
          <td><code>ClassName</code></td>
          <td>The name of the Class containing the implementation for the command.</td>
      </tr>
      <tr>
          <td><code>Image</code></td>
          <td>The image of the button.</td>
      </tr>
      <tr>
          <td><code>LargeImage</code></td>
          <td>The large image of the button.</td>
      </tr>
      <tr>
          <td><code>LongDescription</code></td>
          <td>Long description of the command tooltip.</td>
      </tr>
      <tr>
          <td><code>Name</code></td>
          <td>The name of the item.</td>
      </tr>
      <tr>
          <td><code>Text</code></td>
          <td>The user-visible text of the button.</td>
      </tr>
      <tr>
          <td><code>ToolTip</code></td>
          <td>The description that appears as a ToolTip for the item.</td>
      </tr>
      <tr>
          <td><code>ToolTipImage</code></td>
          <td>The image to show as a part of the button extended tooltip.</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>Tips:</p></blockquote>
<ul>
<li><code>Image</code> - requires an <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.media.imagesource?view=windowsdesktop-9.0">ImageSource</a> which is a Windows C# .NET - API.</li>
<li><a href="https://icons8.com">icons8.com</a> - great resource to find icons for your buttons.</li>
<li><a href="https://www.photopea.com">photopea.com</a> - to adjust the resolution of the icons downloaded from <code>icons8</code> website.</li>
</ul>
<h2 id="code">Code<a hidden class="anchor" aria-hidden="true" href="#code">#</a></h2>
<h3 id="project-solution"><code>Project Solution</code><a hidden class="anchor" aria-hidden="true" href="#project-solution">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Solution
</span></span><span class="line"><span class="cl"><span class="p">|</span>-&gt; guRoo
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Dependencies
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Commands
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; General 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_General.cs 
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Forms
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; General 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Globals.cs // ---------&gt;  Update
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Resources
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Files //---------------&gt;  Add <span class="s2">&#34;Files&#34;</span> Folder
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Tooltips.resx //---&gt;  Add <span class="s2">&#34;Resources File&#34;</span> item
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons //---------------&gt;  Add <span class="s2">&#34;Icons&#34;</span> Folder 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons16 //-------------&gt;  Add <span class="s2">&#34;Icons16&#34;</span> Folder
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; General_test16.png // Add an Icon 16px
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons32 //-------------&gt;  Add <span class="s2">&#34;Icons32&#34;</span> Folder
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; General_test32.png // Add an Icon 32px
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Utilities
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Ribbon_Utils.cs //-----&gt;  Update
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Application.cs //----------&gt;  Update
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; guRoo.addin
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ribbon_utilscs"><code>Ribbon_Utils.cs</code><a hidden class="anchor" aria-hidden="true" href="#ribbon_utilscs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Utilities</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Ribbon_Utils</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to create a &#34;Tab&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">Result</span> <span class="n">AddRibbonTab</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">,</span><span class="kt">string</span> <span class="n">tabName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">CreateRibbonTab</span><span class="p">(</span><span class="n">tabName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">catch</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not create a tab: {tabName}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to create a &#34;Panel&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">RibbonPanel</span> <span class="n">AddRibbonPanelToTab</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">,</span> <span class="kt">string</span> <span class="n">tabName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">panel</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">CreateRibbonPanel</span><span class="p">(</span><span class="n">tabName</span><span class="p">,</span> <span class="n">panelName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">panel</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">catch</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not add {panelName} to {tabName}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to get that &#34;Panel&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">RibbonPanel</span> <span class="n">GetRibbonPanelByName</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">,</span> <span class="kt">string</span> <span class="n">tabName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">panels</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">GetRibbonPanels</span><span class="p">(</span><span class="n">tabName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">panel</span> <span class="k">in</span> <span class="n">panels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">panel</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="n">panel</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Not found</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to create a &#34;Button&#34; to &#34;Panel&#34;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// Fill this summary for Methods to be described on Mouse Hover.</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;panel&#34;&gt;This is the RibbonPanel to add to.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;buttonName&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;className&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;internalName&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;param name=&#34;assemblyPath&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">PushButton</span> <span class="n">AddPushButtonToPanel</span><span class="p">(</span><span class="n">RibbonPanel</span> <span class="n">panel</span><span class="p">,</span> <span class="kt">string</span> <span class="n">buttonName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// string internalName, -&gt; NOT NEEDED ANYMORE</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// string assemblyPath)-&gt; NOT NEEDED ANYMORE</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">panel</span> <span class="k">is</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not create {buttonName}.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Open PushButtonData Constructor and check what&#39;s needed</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 2 Start====</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Get the base name from below</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">baseName</span> <span class="p">=</span> <span class="n">CommandToBaseName</span><span class="p">(</span><span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 2 End====</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Create a PushButtonData object:</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pushButtonData</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PushButtonData</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">buttonName</span><span class="p">,</span> <span class="n">Globals</span><span class="p">.</span><span class="n">AssemblyPath</span><span class="p">,</span> <span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// if the button was made - return it:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">panel</span><span class="p">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">pushButtonData</span><span class="p">)</span> <span class="k">is</span> <span class="n">PushButton</span> <span class="n">pushButton</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">pushButton</span><span class="p">.</span><span class="n">ToolTip</span> <span class="p">=</span> <span class="n">LookupTooltip</span><span class="p">(</span><span class="n">baseName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// We will come back to this:</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 4 Start====</span>
</span></span><span class="line"><span class="cl">                <span class="n">pushButton</span><span class="p">.</span><span class="n">Image</span> <span class="p">=</span> <span class="n">GetIcon</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="m">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">pushButton</span><span class="p">.</span><span class="n">LargeImage</span> <span class="p">=</span> <span class="n">GetIcon</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="m">32</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 4 End====</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">pushButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not create {buttonName}.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 1 Start====</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to get the base name of a command:</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">CommandToBaseName</span><span class="p">(</span><span class="kt">string</span> <span class="n">commandName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">commandName</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;guRoo.Cmds_&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">).</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;.Cmd&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to get a value from a dictionary key</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">LookupTooltip</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">string</span> <span class="n">failValue</span> <span class="p">=</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">failValue</span> <span class="p">??=</span> <span class="s">&#34;No tooltip value was found.&#34;</span><span class="p">;</span> <span class="c1">// ??= -&gt; if this is null set it to the following</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">Globals</span><span class="p">.</span><span class="n">Tooltips</span><span class="p">.</span><span class="n">TryGetValue</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="k">out</span> <span class="kt">string</span> <span class="k">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">failValue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 1 End====</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 3 Start====</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to get an icon as an image source</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">ImageSource</span> <span class="n">GetIcon</span><span class="p">(</span><span class="kt">string</span> <span class="n">baseName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">resolution</span> <span class="p">=</span> <span class="m">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">resourcePath</span> <span class="p">=</span> <span class="s">$&#34;guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="k">using</span>  <span class="p">(</span><span class="kt">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">Globals</span><span class="p">.</span><span class="n">Assembly</span><span class="p">.</span><span class="n">GetManifestResourceStream</span><span class="p">(</span><span class="n">resourcePath</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="n">stream</span> <span class="k">is</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">				<span class="kt">var</span> <span class="n">decoder</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PngBitmapDecoder</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">					<span class="n">stream</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">					<span class="n">BitmapCreateOptions</span><span class="p">.</span><span class="n">PreservePixelFormat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">					<span class="n">BitmapCacheOption</span><span class="p">.</span><span class="n">Default</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="n">decoder</span><span class="p">.</span><span class="n">Frames</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="n">decoder</span><span class="p">.</span><span class="n">Frames</span><span class="p">.</span><span class="n">First</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="k">else</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// All you have to do now, is assign these icons back where we added a PushButton</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ====The Updated Part 3 End====</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="tooltipsresx"><code>Tooltips.resx</code><a hidden class="anchor" aria-hidden="true" href="#tooltipsresx">#</a></h3>
<ol>
<li>Create <code>Tooltips.resx</code>  under &hellip;/Resources/Files/Tooltips.resx</li>
<li>Once created, click Add Resource <code>+</code> button on the top left of the screen.</li>
<li>Add the following 2 Resources:</li>
</ol>
<table>
  <thead>
      <tr>
          <th style="text-align: center">Name</th>
          <th>Value</th>
          <th>Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">General_Test</td>
          <td>This is a working tooltip.<br><br>We can do extra lines.</td>
          <td></td>
      </tr>
      <tr>
          <td style="text-align: center">General_Test2</td>
          <td>This is a working tooltip.<br><br>We can do extra lines.</td>
          <td></td>
      </tr>
  </tbody>
</table>
<br>
<hr>
<h4 id="properties"><code>Properties</code><a hidden class="anchor" aria-hidden="true" href="#properties">#</a></h4>
<ol>
<li>Then make sure the properties of the Tooltips.resx are set as follows:</li>
</ol>
<table>
  <thead>
      <tr>
          <th style="text-align: center"><strong>Advanced:</strong></th>
          <th style="text-align: center"><strong>Value</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">Build Action</td>
          <td style="text-align: center"><code>Embedded resource</code></td>
      </tr>
      <tr>
          <td style="text-align: center">Copy to Output Directory</td>
          <td style="text-align: center">Do not copy</td>
      </tr>
      <tr>
          <td style="text-align: center">Custom Tool</td>
          <td style="text-align: center">ResXFileCodeGenerator</td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th style="text-align: center"><strong>Mics:</strong></th>
          <th style="text-align: center"><strong>Value</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">File Name</td>
          <td style="text-align: center">Tooltips.resx</td>
      </tr>
      <tr>
          <td style="text-align: center">Full Path</td>
          <td style="text-align: center">&hellip;/Tooltips.resx</td>
      </tr>
  </tbody>
</table>
<br>
<h3 id="globalscs"><code>Globals.cs</code><a hidden class="anchor" aria-hidden="true" href="#globalscs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.ApplicationServices</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Globalization</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Resources</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Assembly</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">Assembly</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Globals</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Properties</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Applications</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">UIControlledApplication</span> <span class="n">UiCtlApp</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">ControlledApplication</span> <span class="n">CtlApp</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">UIApplication</span> <span class="n">UiApp</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Assembly</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">Assembly</span> <span class="n">Assembly</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// Ambiguity or missing ref</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AssemblyPath</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Revit Versions</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">RevitVersion</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">RevitVersionInt</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// User Names</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">UsernameRevit</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">UsernameWindows</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// GUIDs and Versioning</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AddinVersionNumber</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AddinVersionName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AddinName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AddinGuid</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Dictionaries for resources as a Dict &lt;key, value&gt; Name</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">Tooltips</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Register</span> <span class="n">Method</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Method to Register Variable Properties</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">RegisterProperties</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">UiCtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">CtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">ControlledApplication</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// UiApp set on idling</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">Assembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="n">GetExecutingAssembly</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">AssemblyPath</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="n">Location</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">RevitVersion</span> <span class="p">=</span> <span class="n">CtlApp</span><span class="p">.</span><span class="n">VersionNumber</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">RevitVersionInt</span> <span class="p">=</span> <span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">RevitVersion</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Revit Username set to idling</span>
</span></span><span class="line"><span class="cl">            <span class="n">UsernameWindows</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">UserName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">AddinVersionNumber</span> <span class="p">=</span> <span class="s">&#34;25.08.12&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">AddinVersionName</span> <span class="p">=</span> <span class="s">&#34;WIP&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">AddinName</span> <span class="p">=</span> <span class="s">&#34;guRoo&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">AddinGuid</span> <span class="p">=</span> <span class="s">&#34;5FD7523B-5832-4AB8-9B3D-0BE7ACFE1207&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Register our tooltup (Microsoft API Methods)</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">RegisterTooltips</span><span class="p">(</span><span class="kt">string</span> <span class="n">resourcePath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">resourceManager</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ResourceManager</span><span class="p">(</span><span class="n">resourcePath</span><span class="p">,</span><span class="k">typeof</span><span class="p">(</span><span class="n">Application</span><span class="p">).</span><span class="n">Assembly</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">resourceSet</span> <span class="p">=</span> <span class="n">resourceManager</span><span class="p">.</span><span class="n">GetResourceSet</span><span class="p">(</span><span class="n">CultureInfo</span><span class="p">.</span><span class="n">CurrentCulture</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">foreach</span> <span class="p">(</span><span class="n">DictionaryEntry</span> <span class="n">entry</span> <span class="k">in</span> <span class="n">resourceSet</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">key</span> <span class="p">=</span> <span class="n">entry</span><span class="p">.</span><span class="n">Key</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="k">value</span> <span class="p">=</span> <span class="n">entry</span><span class="p">.</span><span class="n">Value</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">Tooltips</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// Don&#39;t forget to register our Tooltip in the Application.cs</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="applicationcs"><code>Application.cs</code><a hidden class="anchor" aria-hidden="true" href="#applicationcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// guRoo</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gRib</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Ribbon_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// This application belongs to the root namespace</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Implementing the interface for application.cs class</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Application</span> <span class="p">:</span> <span class="n">IExternalApplication</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// IExternalApplication for the interface</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Make a private uiCtlApp method:</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">static</span> <span class="n">UIControlledApplication</span> <span class="n">_uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//This will return a result on Startup method - requires uiCtlApp</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="cp">#region</span> <span class="n">Globals</span> <span class="n">registration</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Store _uiCtlApp, register on idling</span>
</span></span><span class="line"><span class="cl">            <span class="n">_uiCtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">+=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">catch</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Register Globals</span>
</span></span><span class="line"><span class="cl">            <span class="n">Globals</span><span class="p">.</span><span class="n">RegisterProperties</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// ===========Register Tooltips===========</span>
</span></span><span class="line"><span class="cl">            <span class="n">Globals</span><span class="p">.</span><span class="n">RegisterTooltips</span><span class="p">(</span><span class="s">&#34;guRoo.Resources.Files.Tooltips&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="cp">#region</span> <span class="n">Removed</span> <span class="n">because</span> <span class="n">we</span> <span class="n">added</span> <span class="n">the</span> <span class="n">Global</span> <span class="n">Variables</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">            <span class="c1">// Collect the controlled application:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// var ctlApp = uiCtlApp.ControlledApplication;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// var assembly = Assembly.GetExecutingAssembly();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// avr assemblyPath = assembly.Location;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Variables</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// string tabName = &#34;guRoo&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="cp">#region</span> <span class="n">Ribbon</span> <span class="n">setup</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Add RibbonTab</span>
</span></span><span class="line"><span class="cl">            <span class="n">uRib</span><span class="p">.</span><span class="n">AddRibbonTab</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">,</span> <span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">            <span class="c1">// Create RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">panelGeneral</span> <span class="p">=</span> <span class="n">uRib</span><span class="p">.</span><span class="n">AddRibbonPanelToTab</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">,</span> <span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">,</span> <span class="s">&#34;General&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// =====Updated Part=====</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Add PushButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">buttonTest</span> <span class="p">=</span> <span class="n">uRib</span><span class="p">.</span><span class="n">AddPushButtonToPanel</span><span class="p">(</span><span class="n">panelGeneral</span><span class="p">,</span> <span class="s">&#34;Testing&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_General.Cmd_Test&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Adjust it in Ribbon_Utils.cs</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// =====Updated Part=====</span>
</span></span><span class="line"><span class="cl">            <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span> <span class="c1">// or Cancelled</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">On</span> <span class="n">shutdown</span> <span class="n">method</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// This will urn on shutdown</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">OnShutdown</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Use</span> <span class="n">idling</span> <span class="n">to</span> <span class="n">register</span> <span class="n">UiApp</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// On idling, register UiApp/username</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">RegisterUiApp</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">IdlingEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">-=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">sender</span> <span class="k">is</span> <span class="n">UIApplication</span> <span class="n">uiApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="add-icons-to-resources-folder">Add <code>Icons</code> to <code>Resources</code> folder<a hidden class="anchor" aria-hidden="true" href="#add-icons-to-resources-folder">#</a></h3>
<ol>
<li>Add 2 folders under <code>Resources</code>:
<ol>
<li><code>Icons16</code></li>
<li><code>Icons32</code></li>
</ol>
</li>
<li>Go to <a href="https://icons8.com">Icons8.com</a></li>
<li>Search and download the icons you need @ resolution 80x80.</li>
<li>Go to <a href="https://www.photopea.com">Photopea.com</a>
<ol>
<li>Create a New Project</li>
<li>96 Width, 96 Height, 96 DPI -&gt; Create</li>
<li>File -&gt; Open -&gt; Choose the downloaded <code>icon</code></li>
<li>Image -&gt; Image Size -&gt; Width=32, Height=32, DPI=96 -&gt; OK</li>
<li>File -&gt; Export as -&gt; PNG</li>
<li>Image -&gt; Image Size -&gt; Width=16, Height=16, DPI=96 -&gt; OK</li>
<li>File -&gt; Export as -&gt; PNG</li>
</ol>
</li>
<li>Place those 2 exported <code>images</code> to the folders you created earlier:
<ol>
<li><code>Icons16</code>
<ol>
<li>Name: <code>General_test16.png</code></li>
</ol>
</li>
<li><code>Icons32</code>
<ol>
<li>Name: <code>General_test32.png</code></li>
</ol>
</li>
</ol>
</li>
<li>In the <code>Properties</code> of the images you have to make sure:
<ol>
<li><code>Build Action</code> -&gt; <code>Embedded Resource</code></li>
</ol>
</li>
</ol>
<blockquote>
<p>To make things even easier, we can make sure the <code>Build Action</code> gets set to <code>Embedded Resource</code> for all images added to the <code>Icons</code> folders, here how you would do that:</p></blockquote>
<ol>
<li>Go to the <code>Solution Explorer</code> and double click on your project name <code>guRoo</code> in this case.</li>
<li>Then you should find the following:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl">    <span class="p">&lt;!--</span> <span class="n">Build</span> <span class="n">configuration</span> <span class="p">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;!--</span> <span class="n">https</span><span class="p">:</span><span class="c1">//github.com/Nice3point/Revit.Build.Tasks --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="n">PropertyGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="n">IsRepackable</span><span class="p">&gt;</span><span class="kc">true</span><span class="p">&lt;/</span><span class="n">IsRepackable</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="n">DeployRevitAddin</span><span class="p">&gt;</span><span class="kc">true</span><span class="p">&lt;/</span><span class="n">DeployRevitAddin</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="n">PropertyGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">None</span> <span class="n">Remove</span><span class="p">=</span><span class="s">&#34;Resources\Icons16\General_test16.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">None</span> <span class="n">Remove</span><span class="p">=</span><span class="s">&#34;Resources\Icons32\General_test32.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">EmbeddedResource</span> <span class="n">Include</span><span class="p">=</span><span class="s">&#34;Resources\Icons16\General_test16.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">EmbeddedResource</span> <span class="n">Include</span><span class="p">=</span><span class="s">&#34;Resources\Icons32\General_test32.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>You should just replace the name of the images with a star <code>*</code>:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl">    <span class="p">&lt;!--</span> <span class="n">Build</span> <span class="n">configuration</span> <span class="p">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;!--</span> <span class="n">https</span><span class="p">:</span><span class="c1">//github.com/Nice3point/Revit.Build.Tasks --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="n">PropertyGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="n">IsRepackable</span><span class="p">&gt;</span><span class="kc">true</span><span class="p">&lt;/</span><span class="n">IsRepackable</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="n">DeployRevitAddin</span><span class="p">&gt;</span><span class="kc">true</span><span class="p">&lt;/</span><span class="n">DeployRevitAddin</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="n">PropertyGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">None</span> <span class="n">Remove</span><span class="p">=</span><span class="s">&#34;Resources\Icons16\*.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">None</span> <span class="n">Remove</span><span class="p">=</span><span class="s">&#34;Resources\Icons32\*.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">EmbeddedResource</span> <span class="n">Include</span><span class="p">=</span><span class="s">&#34;Resources\Icons16\*.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="n">EmbeddedResource</span> <span class="n">Include</span><span class="p">=</span><span class="s">&#34;Resources\Icons32\*.png&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>That&rsquo;s it, now every <code>image</code> you are going to place under these <code>folders</code> would automatically be <code>Embedded as Resources</code> after you <code>Build</code> this project.</li>
<li>Now we are going to add a <code>Method</code> to get an icon as an image source back in the <code>Ribbon_Utils.cs</code>.</li>
</ol>
<h3 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h3>
<ul>
<li>All of this was done to make it super easy for you to create new buttons, from now on, you will be able to create a new button, simply by:
<ul>
<li>Going to <code>Application.cs</code></li>
<li>Find this part:</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Add PushButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">buttonTest</span> <span class="p">=</span> <span class="n">uRib</span><span class="p">.</span><span class="n">AddPushButtonToPanel</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="n">panelGeneral</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">	<span class="s">&#34;Testing&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">	<span class="s">&#34;guRoo.Cmds_General.Cmd_Test&#34;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>And just Make sure to:
<ul>
<li>Get the <code>Command Class</code> right = <code>guRoo.Cmds_General.Cmd_Test</code></li>
<li>Give it a <code>Name</code> = <code>Testing</code></li>
<li>And specify what <code>Panel</code> is it going on = <code>panelGeneral</code></li>
<li>Finally, add the <code>Icons</code> &amp; <code>Tooltips</code>, that&rsquo;s it, you have a <code>New Button</code>.</li>
</ul>
</li>
</ul>
<br>
<blockquote>
<p>These tutorials were inspired by the work of <a href="https://www.youtube.com/@AussieBIMGuru">Aussie BIM Guru</a>. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.</p></blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/c%23/">C#</a></li>
      <li><a href="http://localhost:1313/tags/revit/">Revit</a></li>
      <li><a href="http://localhost:1313/tags/tutorial/">Tutorial</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/post-9/">
    <span class="title">« Prev</span>
    <br>
    <span>C# &#43; Revit API: Lesson 9 - Static vs. Extension Methods</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/lesson-7/">
    <span class="title">Next »</span>
    <br>
    <span>C# &#43; Revit API: Lesson 7 - Object Oriented Programming</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© 2025 AYDrafting. All rights reserved.</span> · 

    <span>
        Powered by
        <a href="https://aydrafting.com/" rel="noopener noreferrer" target="_blank">AYDrafting</a> &
        <a href="https://github.com/aydimir95/" rel="noopener" target="_blank">GitHub</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
