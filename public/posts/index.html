<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Blog</title><meta name=keywords content><meta name=description content="Posts - Blog"><meta name=author content><link rel=canonical href=https://blog.aydrafting.com/posts/><link crossorigin=anonymous href=/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css integrity="sha256-bVhUcqQJqPUE5r+Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.aydrafting.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.aydrafting.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.aydrafting.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.aydrafting.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.aydrafting.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://blog.aydrafting.com/posts/index.xml><link rel=alternate hreflang=en href=https://blog.aydrafting.com/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.aydrafting.com/posts/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="Posts"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta property="og:image" content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:title content="Posts"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.aydrafting.com/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.aydrafting.com/ accesskey=h title="Blog (Alt + H)">Blog</a></div><div class="logo main-logo"><a href=https://aydrafting.com target=_blank><img src=/LogoAYD.png alt=Blog height=40></a></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://blog.aydrafting.com/>Home</a></div><h1>Posts
<a href=/posts/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 11 - Stacking Buttons</h2></header><div class=entry-content><p>The Goal Aussie BIM Guru
Stacks can vertically contain 2 or 3 items. Homework Create a stack Access stacked items Solution Revit API AddStackedItems Method 2 overloads available, you can either add 2 items or 3 items. RibbonItemData Class - is the object that we are going to be adding: ComboBoxData Class RadioButtonClass ButtonData Class PulldownButton PushButton Tips We will be adding it to RibbonPanel But we will not create an Extension for this, since the the Method itself is sufficient to run this process. But we are going to have to access the projects once we create them as well. Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 Solution |-> guRoo |-> Dependencies |-> Commands |-> General |-> Cmds_General.cs |-> Cmds_Button.cs // Add a New Class |-> Cmds_PullDown.cs |-> Cmds_Stack1.cs // Add a New Class |-> Cmds_Stack2.cs // Add a New Class |-> Cmds_Stack3.cs // Add a New Class |-> Forms |-> General |-> Globals.cs |-> Extensions |-> UIControlledApplicaiton_Ext.cs |-> RibbonPanel_Ext.cs |-> PulldownButton_Ext.cs |-> Resources |-> Files |-> Tooltips.resx // Update |-> Icons |-> Icons16 |-> General_test16.png |-> Stack1_Button16.png // add a .png |-> Stack116.png // add a .png |-> Stack2_Button16.png // add a .png |-> Stack216.png // add a .png |-> Stack3_Button16.png // add a .png |-> Stack316.png // add a .png |-> Icons32 |-> General_test32.png // add a .png |-> Stack1_Button32.png // add a .png |-> Stack132.png // add a .png |-> Stack2_Button32.png // add a .png |-> Stack232.png // add a .png |-> Stack3_Button32.png // add a .png |-> Stack332.png // add a .png |-> Utilities |-> Ribbon_Utils.cs |-> Application.cs // Update |-> guRoo.addin Cmds_Stack1.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack1 { /// &lt;summary> /// Example command /// &lt;/summary> [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show("It's working!", doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack2.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack2 { /// &lt;summary> /// Example command /// &lt;/summary> [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show("It's working!", doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack3.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack3 { /// &lt;summary> /// Example command /// &lt;/summary> [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show("It's working!", doc.Title); // Final return return Result.Succeeded; } } } Tooltips.resx Name Value Button The user will generally not see this - it just holds the PushButton example. Button_Button This is an example of adding a PushButton to a RibbonPanel. PullDown This is an example of adding a PulldownButton to a RibbonPanel. PullDown_1Button This is button 1 of the PulldownButton. PullDown_2Button This is button 2 of the PulldownButton. PullDown_3Button This is button 3 of the PulldownButton. Stack1 This is an example of stacking buttons. Stack1_Button This is an example of stacking buttons. Stack2 This is an example of stacking buttons. Stack2_Button This is an example of stacking buttons. Stack3 This is an example of stacking buttons. Stack3_Button This is an example of stacking buttons. Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips("guRoo.Resources.Files.Tooltips"); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, "General"); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton("Testing", "guRoo.Cmds_General.Cmd_Test"); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton("PullDown", "guRoo.Cmds_PullDown"); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton("Button 1", "guRoo.Cmds_PullDown.Cmd_1Button"); pulldownTest.Ext_AddPushButton("Button 2", "guRoo.Cmds_PullDown.Cmd_2Button"); pulldownTest.Ext_AddPushButton("Button 3", "guRoo.Cmds_PullDown.Cmd_3Button"); // Create data objects for the stack var stack1Data = gRib.NewPulldownButtonData("Stack1", "guRoo.Cmds_Stack1"); var stack2Data = gRib.NewPulldownButtonData("Stack2", "guRoo.Cmds_Stack2"); var stack3Data = gRib.NewPulldownButtonData("Stack3", "guRoo.Cmds_Stack3"); // Create the Stack var stack = panelGeneral.AddStackedItems(stack1Data, stack2Data, stack3Data); var pulldownStack1 = stack[0] as PulldownButton; var pulldownStack2 = stack[1] as PulldownButton; var pulldownStack3 = stack[2] as PulldownButton; // Add buttons to stacked pulldowns pulldownStack1.Ext_AddPushButton("Button", "guRoo.Cmds_Stack1.Cmd_Button"); pulldownStack2.Ext_AddPushButton("Button", "guRoo.Cmds_Stack2.Cmd_Button"); pulldownStack3.Ext_AddPushButton("Button", "guRoo.Cmds_Stack3.Cmd_Button"); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you‚Äôre looking for a deeper dive into the topics, check out his channel for detailed explanations.
...</p></div><footer class=entry-footer><span title='2025-08-14 18:30:33 +0300 MSK'>August 14, 2025</span>&nbsp;¬∑&nbsp;6 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 11 - Stacking Buttons" href=https://blog.aydrafting.com/posts/post-11/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 10 - Create a Pulldown Button</h2></header><div class=entry-content><p>The Goal We will create a PulldownButton and add a few PushButtons to it.
We will also create some helper methods to generate ButtonData objects given we are beginning to use these in lots of places.
In the next post we will stack PulldownButtons.
Aussie BIM Guru
What we need Create a data creation methods, Add a PulldownButton to our panel, Add PushButtons to it, Add Icons Related API Classes RibbonPanel PulldownButtonData PulldownButton PushButtonData PushButton Homework Create a static utility methods on the Ribbon_Util.cs Modify a PushButton method to use static utility methods Create a PulldownButton method Create a PulldownButton method Extension class to add PushButton to PulldownButton Update the Strartup method Solution Code Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 Solution |-> guRoo |-> Dependencies |-> Commands |-> General |-> Cmds_General.cs |-> Cmds_PullDown.cs // Create a New Class |-> Forms |-> General |-> Globals.cs |-> Extensions |-> UIControlledApplicaiton_Ext.cs |-> RibbonPanel_Ext.cs // Update |-> PulldownButton_Ext.cs // Create New Extension Class |-> Resources |-> Files |-> Tooltips.resx // Update |-> Icons |-> Icons16 |-> General_test16.png |-> Icons32 |-> General_test32.png |-> Utilities |-> Ribbon_Utils.cs // Update |-> Application.cs // Update |-> guRoo.addin Cmd_PullDown.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace guRoo.Cmds_PullDown { /// &lt;summary> /// Example Command /// &lt;/summary> [Transaction(TransactionMode.Manual)] public class Cmd_1Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show("Button 1 is Working!", doc.Title); // Final return here: return Result.Succeeded; } } /// &lt;summary> /// Example Command /// &lt;/summary> [Transaction(TransactionMode.Manual)] public class Cmd_2Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show("Button 2 is Working!", doc.Title); // Final return here: return Result.Succeeded; } } /// &lt;summary> /// Example Command /// &lt;/summary> [Transaction(TransactionMode.Manual)] public class Cmd_3Button : IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { var uiApp = CommandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Code logic here: TaskDialog.Show("Button 3 is Working!", doc.Title); // Final return here: return Result.Succeeded; } } } RibbonPanel_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class RibbonPanel_Ext { # region Add Button Creation /// &lt;summary> /// Adds a Pushbutton to the panel. /// &lt;/summary> /// &lt;typeparam name="CommandClass">The related Command class.&lt;/typeparam> /// &lt;param name="ribbonPanel">The RibbonPanel (extended).&lt;/param> /// &lt;param name="buttonName">The name for the button.&lt;/param> /// &lt;param name="availability">The availability name.&lt;/param> /// &lt;param name="suffix">The icon suffix (none by default).&lt;/param> /// &lt;returns>A Pushbutton object.&lt;/returns> public static PushButton Ext_AddPushButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($"Error: Could not create {buttonName}."); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (panel.AddItem(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($"Error: Could not create {buttonName}."); return null; } } /// &lt;summary> /// Adds a PulldownButton to the panel. /// &lt;/summary> /// &lt;typeparam name="CommandClass">The related Command class.&lt;/typeparam> /// &lt;param name="ribbonPanel">The RibbonPanel (extended).&lt;/param> /// &lt;param name="buttonName">The name for the button.&lt;/param> /// &lt;param name="availability">The availability name.&lt;/param> /// &lt;param name="suffix">The icon suffix (none by default).&lt;/param> /// &lt;returns>A PulldownButton object.&lt;/returns> public static PulldownButton Ext_AddPulldownButton(this RibbonPanel panel, string buttonName, string className) { if (panel is null) { Debug.WriteLine($"Error: Could not create {buttonName}."); return null; } // Create a Data Object var pulldownButtonData = gRib.NewPulldownButtonData(buttonName, className); if (panel.AddItem(pulldownButtonData) is PulldownButton pulldownButton) { // If the button was made, return it. return pulldownButton; } else { Debug.WriteLine($"Error: Could not create {buttonName}."); return null; } } #endregion } } PulldownButton_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 using Autodesk.Revit.UI; using System.Diagnostics; using gRib = guRoo.Utilities.Ribbon_Utils; namespace guRoo.Extensions { public static class PulldownButton_Ext { # region Add Button Creation /// &lt;summary> /// Adds a PulldownButton to the panel. /// &lt;/summary> /// &lt;typeparam name="CommandClass">The related Command class.&lt;/typeparam> /// &lt;param name="pulldownButton">The RibbonPanel to add the button to (Extended).&lt;/param> /// &lt;param name="buttonName">The name for the button.&lt;/param> /// &lt;param name="className">The full class name the button runs.&lt;/param> /// &lt;returns>A PulldownButton object.&lt;/returns> public static PushButton Ext_AddPushButton(this PulldownButton pulldownButton, string buttonName, string className) { if (pulldownButton is null) { Debug.WriteLine($"Error: Could not add {buttonName} to pulldown."); return null; } // Create a Data Object var pushButtonData = gRib.NewPushButtonData(buttonName, className); if (pulldownButton.AddPushButton(pushButtonData) is PushButton pushButton) { // If the button was made, return it. return pushButton; } else { Debug.WriteLine($"Error: Could not add {buttonName} to pulldown."); return null; } } #endregion } } Tooltips.resx Name Value Comment General_Test This is a working tooltip.
We can do extra lines. General_Test2 This is a working tooltip.
We can do extra lines. PullDown This is a PulldownButton PullDown_1Button This is Button 1 of the Pulldown Button. PullDown_2Button This is Button 2 of the Pulldown Button. PullDown_3Button This is Button 3 of the Pulldown Button. Ribbon_Utils.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 using Autodesk.Revit.UI; using System; using System.Diagnostics; using System.Windows.Media; using System.Windows.Media.Imaging; namespace guRoo.Utilities { public static class Ribbon_Utils { #region PushButton Data /// &lt;summary> /// Create a PushButtonData object. /// &lt;/summary> /// &lt;param name="buttonName">The name for the button.&lt;/param> /// &lt;param name="className">The availability name.&lt;/param> /// &lt;returns>A PushButtonData object.&lt;/returns> public static PushButtonData NewPushButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className); // Set the values pushButtonData.ToolTip = LookupTooltip(baseName); pushButtonData.Image = GetIcon(baseName, resolution: 16); pushButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pushButtonData; } #endregion #region Pulldown Data /// &lt;summary> /// Create a PulldownButtonData object. /// &lt;/summary> /// &lt;param name="buttonName">The name for the button.&lt;/param> /// &lt;param name="className">The availability name.&lt;/param> /// &lt;returns>A PulldownButtonData object.&lt;/returns> public static PulldownButtonData NewPulldownButtonData(string buttonName, string className) { var baseName = CommandToBaseName(className); var pulldownButtonData = new PulldownButtonData(baseName, buttonName); // Set the values pulldownButtonData.ToolTip = LookupTooltip(baseName); pulldownButtonData.Image = GetIcon(baseName, resolution: 16); pulldownButtonData.LargeImage = GetIcon(baseName, resolution: 32); return pulldownButtonData; } #endregion #region Method to get the base name of a command public static string CommandToBaseName(string commandName) { return commandName.Replace("guRoo.Cmds_", "").Replace(".Cmd", ""); } // Method to get a value from a dictionary key public static string LookupTooltip(string key, string failValue = null) { failValue ??= "No tooltip value was found."; // ??= -> if this is null set it to the following if (Globals.Tooltips.TryGetValue(key, out string value)) { return value; } return failValue; } #endregion #region Method to get an icon as an image source public static ImageSource GetIcon(string baseName, int resolution = 32) { var resourcePath = $"guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png"; using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath)) { if (stream is null) { return null; } var decoder = new PngBitmapDecoder( stream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); if (decoder.Frames.Count > 0) { return decoder.Frames.First(); } else { return null; } } } #endregion } } Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips("guRoo.Resources.Files.Tooltips"); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, "General"); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton("Testing", "guRoo.Cmds_General.Cmd_Test"); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton("PullDown", "guRoo.Cmds_PullDown"); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton("Button 1", "guRoo.Cmds_PullDown.Cmd_1Button"); pulldownTest.Ext_AddPushButton("Button 2", "guRoo.Cmds_PullDown.Cmd_2Button"); pulldownTest.Ext_AddPushButton("Button 3", "guRoo.Cmds_PullDown.Cmd_3Button"); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you‚Äôre looking for a deeper dive into the topics, check out his channel for detailed explanations.
...</p></div><footer class=entry-footer><span title='2025-08-14 12:02:26 +0300 MSK'>August 14, 2025</span>&nbsp;¬∑&nbsp;9 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 10 - Create a Pulldown Button" href=https://blog.aydrafting.com/posts/post-10/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 9 - Static vs. Extension Methods</h2></header><div class=entry-content><p>1 2 3 4 modifiers returnType Method(this extendedType, args) { coding logic; } So far, we have been using static utility classes to store common methods to call upon. Alternatively, we can use Extension Methods to:
Make the code readable. To let you Add methods to existing types. They provide syntactic sugar (a nicer way to write code), so calls look like instance methods: 1 2 string x = "hello"; string y = x.Reverse(); // Looks built-in, but it's actually an extension if Reverse was written as a static utility method instead of an extension, it might look like this:
...</p></div><footer class=entry-footer><span title='2025-08-08 13:53:29 +0300 MSK'>August 8, 2025</span>&nbsp;¬∑&nbsp;12 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 9 - Static vs. Extension Methods" href=https://blog.aydrafting.com/posts/post-9/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 8 - Tooltips & Icons</h2></header><div class=entry-content><p>In the previous lesson, we built a PushButton using classes, constructors, properties, methods, interfaces, and a few global variables. In this lesson, we‚Äôll put that button in its proper place on the ribbon and make sure everything‚Äîpanel, icon, and tooltip‚Äîworks end to end:
This is what we are trying to create:
Ribbon Panel PushButton Icon Tooltip We will cover how to manage resource/command naming, And, how to easily manage tooltips for our tools, As well as, the standard/large image icons, Finally, we will test the tool in action. Base Command Naming 1 2 3 4 5 // Command namespace guRoo.Cmds_GroupName //Command Class guRoo.Cmds_GroupName.Cmd_CommandName Preferred Method: 1 2 3 4 5 6 7 8 9 // Before: guRoo.Cmds_GroupName // After: GroupName //Before: guRoo.Cmds_GroupName.Cmd_CommandName //After GroupName._CommandName The Approach we will use: 1 2 3 4 5 guRoo.Cmds_GroupName.Cmd_CommandName // Remove guRoo.Cmds_ GroupName.Cmd_CommandName // Remove .Cmd GrouName_CommandName Or you can make things even more resilient by using: 1 typeof(CommandName).FullName Tooltipkey is base name: 1 2 GrouName GroupName_CommandName Icons: 1 2 3 4 GroupName## GroupName_CommandName## ## = Reolusion in pixels (16 or 32) How we will manage Tooltips We will create a Resources (resx) file in C# and embed this into our project. It will be available in memory for our project whilst it runs to access. We will store the tooltip and description as a dictionary of keys and values.
...</p></div><footer class=entry-footer><span title='2025-08-08 13:13:50 +0300 MSK'>August 8, 2025</span>&nbsp;¬∑&nbsp;12 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 8 - Tooltips & Icons" href=https://blog.aydrafting.com/posts/post-8/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 7 - Creating a PushButton</h2></header><div class=entry-content><p>Game: Introduction to Classes Let‚Äôs play a little game that would help you quickly visualize a Class, Properties, Methods, and Interface. And select the interface that matches the class.
Think of the interface as a Template the Class should follow or in other words the Category the Class belongs to.
Simply, the Interface is a Category of the Class, the Class is a Template of an Object, and the Object, for example, is an actual Dog.
...</p></div><footer class=entry-footer><span title='2025-08-08 13:06:57 +0300 MSK'>August 8, 2025</span>&nbsp;¬∑&nbsp;33 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 7 - Creating a PushButton" href=https://blog.aydrafting.com/posts/post-7/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 6 - try & catch Statements</h2></header><div class=entry-content><p>Pseudocode 1 2 3 4 5 6 7 8 try { try to do this; } catch { if try gets exception, rollback and do this; } Exceptions Exceptions come in many forms and Revit API Docs typically specifies the types of Exceptions we can catch for its methods. There are also system type exceptions.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 catch // Exception as "e" to print the error { To catch a specific exceptions, catch as e; } catch { To catch all exceptions, do this; // but better to catch specific exceptions, // otherwise you will catch all necessary and unecessary exceptions. } finally { To run a final code regardless of outcome; } Use Don‚Äôt Abuse When you first begin using languages, try statements seem great - you can write code, and if you make a mistake your code can continue. THIS IS WRONG!
...</p></div><footer class=entry-footer><span title='2025-08-08 11:47:12 +0300 MSK'>August 8, 2025</span>&nbsp;¬∑&nbsp;2 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 6 - try & catch Statements" href=https://blog.aydrafting.com/posts/post-6/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 5 - `if` Statements</h2></header><div class=entry-content><p>1 2 3 4 5 6 7 8 if // Condition { run if condition is true; } else // If we have no false outcome -> we can skip 'else' branch altogether { run if condition is false; } else if Statement 1 2 3 4 5 6 7 8 9 10 11 12 if // Condition { run if condition is true; } else if // Condition { run if there are more conditions; } else // If we have no false outcome -> we can skip 'else' branch altogether { run if condition is false; } Shorthand if Statements 1 value = condition?then:else; Nearly always used for quickly setting another variable to one of two possibilities, using a conditional outcome. Only used if it‚Äôs a simple one liner task.
...</p></div><footer class=entry-footer><span title='2025-08-06 17:36:22 +0300 MSK'>August 6, 2025</span>&nbsp;¬∑&nbsp;2 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 5 - `if` Statements" href=https://blog.aydrafting.com/posts/post-5/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 4 - Logical Operators</h2></header><div class=entry-content><p>They control logic and flow in our tools. We will have a good understanding of core statements we can use to build Revit Add-ins.
Logical Operators x == y => true if x is equal to y
x != y => true if x is not equal to y
x > y => true if x is greater than y
x &lt; y => true if x is less than y
...</p></div><footer class=entry-footer><span title='2025-08-06 15:50:00 +0300 MSK'>August 6, 2025</span>&nbsp;¬∑&nbsp;2 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 4 - Logical Operators" href=https://blog.aydrafting.com/posts/post-4/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 3 - Fundamental Types of Data in C#</h2></header><div class=entry-content><p>Boolean bool true (1) false (0) Integer int Whole number:
1, 2, 3, etc.
Numbers come in different formats but by default they are signable (can be negative).
Typically, they use 32 bits based.
Double double Decimal number:
0.0, 1.5, 6.592, -5.00, etc.
Doubles use 64 bits, and are more common than floats (which use half - 32 bits). In Revit you will typically work with int and double.
Characters char ‚Äòa‚Äô, ‚Äòb‚Äô, ‚Äòc‚Äô, etc.
...</p></div><footer class=entry-footer><span title='2025-08-06 14:29:29 +0300 MSK'>August 6, 2025</span>&nbsp;¬∑&nbsp;4 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 3 - Fundamental Types of Data in C#" href=https://blog.aydrafting.com/posts/post-3/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>C# + Revit API: Lesson 2 - Bits & Bytes, ASCII Table, Pointers & Structs - Programming 101</h2></header><div class=entry-content><p>I suggest taking CS50 Course to understand the basics of Programming True & False 0 and 1 Base 2 numbering system 1 2 3 4 5 6 7 8 9 10 11 1 0 1 x x x 4 2 1 = 5 In other words: 2 2 2 x x x 2 1 0 4 2 1 = 5 1 0 1 1 2 3 We call these bits Eight bits = 1 byte Memory is addressed into bytes ASCII Tables bring meaning to what various bytes represent: 1 2 3 4 5 6 ASCII 48 = 0 (00) 110000 1 * 2^4 = 16 1 * 2^5 = 32 16 + 32 = 48 48 = 0 (in ASCII Table) Pointers = Structs (in C) Pointers are hexadecimal based values that identify an address in computer memory. If you write in C, you need to manage pointers and check memory in and out as you work. C# bypasses this using a garbage collector (GC). Pointers and structs allow us to connect bytes into lists. We can also array objects adjacently. In C#, this is all managed for you. üìä Breakdown Struct 1 (First Node): Object: Data (e.g., 10) Null: No previous node ‚Äî this is the start of the list. Pointer to next: Points to Struct 2 Struct 2 (Middle Node): Object: Data (e.g., 20) Pointer to previous: Points back to Struct 1 Pointer to next: Points forward to Struct 3 Struct 3 (Last Node): Object: Data (e.g., 30) Pointer to previous: Points back to Struct 2 Null: No next node ‚Äî this is the end of the list. üîÅ Why use this? This doubly linked list structure allows you to:
...</p></div><footer class=entry-footer><span title='2025-08-06 14:23:14 +0300 MSK'>August 6, 2025</span>&nbsp;¬∑&nbsp;5 min</footer><a class=entry-link aria-label="post link to C# + Revit API: Lesson 2 - Bits & Bytes, ASCII Table, Pointers & Structs - Programming 101" href=https://blog.aydrafting.com/posts/post-2/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://blog.aydrafting.com/posts/page/2/>Next&nbsp;&nbsp;¬ª</a></nav></footer></main><footer class=footer><span>¬© 2025 AYDrafting. All rights reserved.</span> ¬∑
<span>Powered by
<a href=https://aydrafting.com/ rel="noopener noreferrer" target=_blank>AYDrafting</a> &
<a href=https://github.com/aydimir95/ rel=noopener target=_blank>GitHub</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>