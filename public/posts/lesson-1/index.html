<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>C# + Revit API: Lesson 1 - A Simple Walkthrough of the Command | Blog</title><meta name=keywords content="C#,Revit,Tutorial"><meta name=description content="This post explains one concrete command—line by line—so a beginner can follow without extra abstractions.
What this command does when you click your add-in button:


Tries to create a sheet (using an invalid title block on purpose → shows how error handling works).


Collects up to 10 existing sheets and formats their numbers/names.


Displays the result in a WPF dialog via a ViewModel.



✅ This article focuses only on the command. It assumes you’ve already wired a ribbon button (and .addin) that triggers StartupCommand."><meta name=author content><link rel=canonical href=https://blog.aydrafting.com/posts/lesson-1/><link crossorigin=anonymous href=/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css integrity="sha256-bVhUcqQJqPUE5r+Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.aydrafting.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.aydrafting.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.aydrafting.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.aydrafting.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.aydrafting.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.aydrafting.com/posts/lesson-1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.aydrafting.com/posts/lesson-1/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="C# + Revit API: Lesson 1 - A Simple Walkthrough of the Command"><meta property="og:description" content="This post explains one concrete command—line by line—so a beginner can follow without extra abstractions.
What this command does when you click your add-in button:
Tries to create a sheet (using an invalid title block on purpose → shows how error handling works).
Collects up to 10 existing sheets and formats their numbers/names.
Displays the result in a WPF dialog via a ViewModel.
✅ This article focuses only on the command. It assumes you’ve already wired a ribbon button (and .addin) that triggers StartupCommand."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-06T01:00:00+03:00"><meta property="article:modified_time" content="2025-08-06T01:00:00+03:00"><meta property="article:tag" content="C#"><meta property="article:tag" content="Revit"><meta property="article:tag" content="Tutorial"><meta property="og:image" content="https://blog.aydrafting.com/images/Pasted%20image%2020250902204444.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.aydrafting.com/images/Pasted%20image%2020250902204444.png"><meta name=twitter:title content="C# + Revit API: Lesson 1 - A Simple Walkthrough of the Command"><meta name=twitter:description content="This post explains one concrete command—line by line—so a beginner can follow without extra abstractions.
What this command does when you click your add-in button:


Tries to create a sheet (using an invalid title block on purpose → shows how error handling works).


Collects up to 10 existing sheets and formats their numbers/names.


Displays the result in a WPF dialog via a ViewModel.



✅ This article focuses only on the command. It assumes you’ve already wired a ribbon button (and .addin) that triggers StartupCommand."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.aydrafting.com/posts/"},{"@type":"ListItem","position":2,"name":"C# + Revit API: Lesson 1 - A Simple Walkthrough of the Command","item":"https://blog.aydrafting.com/posts/lesson-1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"C# + Revit API: Lesson 1 - A Simple Walkthrough of the Command","name":"C# \u002b Revit API: Lesson 1 - A Simple Walkthrough of the Command","description":"This post explains one concrete command—line by line—so a beginner can follow without extra abstractions.\nWhat this command does when you click your add-in button:\nTries to create a sheet (using an invalid title block on purpose → shows how error handling works).\nCollects up to 10 existing sheets and formats their numbers/names.\nDisplays the result in a WPF dialog via a ViewModel.\n✅ This article focuses only on the command. It assumes you’ve already wired a ribbon button (and .addin) that triggers StartupCommand.\n","keywords":["C#","Revit","Tutorial"],"articleBody":"This post explains one concrete command—line by line—so a beginner can follow without extra abstractions.\nWhat this command does when you click your add-in button:\nTries to create a sheet (using an invalid title block on purpose → shows how error handling works).\nCollects up to 10 existing sheets and formats their numbers/names.\nDisplays the result in a WPF dialog via a ViewModel.\n✅ This article focuses only on the command. It assumes you’ve already wired a ribbon button (and .addin) that triggers StartupCommand.\nIf you have no knowledge of how to set this up, I would suggest just skimming through - just for reference and going to the next post, where I will start from scratch.\nThe Command (Full Code) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 using Autodesk.Revit.Attributes; using Nice3point.Revit.Toolkit.External; using guRoo.Views; using guRoo.ViewModels; namespace guRoo.Commands { /// /// External command entry point /// [UsedImplicitly] [Transaction(TransactionMode.Manual)] public class StartupCommand : ExternalCommand { public override void Execute() { var viewModel = Host.GetService\u003cguRooViewModel\u003e(); var titleBlockId = ElementId.InvalidElementId; string resultMessage = \"\"; using (var transaction = new Transaction(Document, \"Create Sheet\")) { transaction.Start(); try { var sheet = ViewSheet.Create(Document, titleBlockId); transaction.Commit(); resultMessage = \"Sheet created successfully!\"; } catch (Autodesk.Revit.Exceptions.ArgumentException ex) { transaction.RollBack(); resultMessage = $\"Sheet could not be made: {ex.Message}\"; } catch (Exception ex) { transaction.RollBack(); resultMessage = $\"Error: {ex.Message}\"; } } // Get sheet information to display var allSheets = new FilteredElementCollector(Document). OfClass(typeof(ViewSheet)). ToElements(). ToList(); if (allSheets.Count \u003e 0) { var sheetNames = new List\u003cstring\u003e(); for (int i = 0; i \u003c Math.Min(10, allSheets.Count); i++) { var sheet = allSheets[i] as ViewSheet; sheetNames.Add($\"{sheet.SheetNumber} - {sheet.Name}\"); } resultMessage += $\"\\n\\nFound {allSheets.Count} sheets: \\n\" + string.Join(\"\\n\", sheetNames); } else { resultMessage += \"\\n\\nNo sheets found in document.\"; } viewModel.ResultMessage = resultMessage; var view = new guRooView(viewModel); view.ShowDialog(); } } } What Each Part Does (Beginner-Friendly) 1) Imports 1 2 3 4 using Autodesk.Revit.Attributes; // [Transaction(...)] attribute using Nice3point.Revit.Toolkit.External; // ExternalCommand base + Host DI using guRoo.Views; // WPF Window (guRooView) using guRoo.ViewModels; // ViewModel (guRooViewModel) Revit attributes let you declare transaction behaviour.\nNice3point Toolkit provides a simplified ExternalCommand base (gives you Document) and DI access via Host.GetService().\nViews/ViewModels are your WPF MVVM types.\n2) Class \u0026 Attributes 1 2 3 [UsedImplicitly] [Transaction(TransactionMode.Manual)] public class StartupCommand : ExternalCommand StartupCommand runs when the user clicks your button.\n[Transaction(TransactionMode.Manual)] = you start/commit/rollback changes.\nExternalCommand (Nice3point) simplifies the Revit command pattern.\nUsedImplicitly is an analyzer hint (e.g., JetBrains) so tooling doesn’t flag it as “unused.”\n3) Getting the ViewModel 1 var viewModel = Host.GetService\u003cUguRooViewModel\u003e(); Pulls a ViewModel instance from DI so the dialog can display results via data binding. 4) Intentionally Invalid Title Block 1 2 3 4 var titleBlockId = ElementId.InvalidElementId; // invalid on purpose string resultMessage = \"\"; We force a failure to demonstrate safe error handling. resultMessage will collect feedback for the user. 5) Transaction + Error Handling Around ViewSheet.Create 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 using (var transaction = new Transaction(Document, \"Create Sheet\")) { transaction.Start(); try { var sheet = ViewSheet.Create(Document, titleBlockId); transaction.Commit(); resultMessage = \"Sheet created successfully!\"; } catch (Autodesk.Revit.Exceptions.ArgumentException ex) { transaction.RollBack(); resultMessage = $\"Sheet could not be made: {ex.Message}\"; } catch (Exception ex) { transaction.RollBack(); resultMessage = $\"Error: {ex.Message}\"; } } Revit is read-only unless you’re inside a Transaction. Creating a sheet with an invalid title block throws ArgumentException → we rollback safely and show the message. Any unexpected error also triggers a rollback. This is the core pattern you’ll reuse for any change in Revit: Start → Do work → Commit or RollBack on error.\n6) Collecting Existing Sheets 1 2 3 4 var allSheets = new FilteredElementCollector(Document) .OfClass(typeof(ViewSheet)) .ToElements() .ToList(); Use FilteredElementCollector to find elements in the document. Here we collect all sheets. Then we format a short list for display:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 if (allSheets.Count \u003e 0) { var sheetNames = new List\u003cstring\u003e(); for (int i = 0; i \u003c Math.Min(10, allSheets.Count); i++) { var sheet = allSheets[i] as ViewSheet; sheetNames.Add($\"{sheet.SheetNumber} - {sheet.Name}\"); } resultMessage += $\"\\n\\nFound {allSheets.Count} sheets:\\n\" + string.Join(\"\\n\", sheetNames); } else { resultMessage += \"\\n\\nNo sheets found in document.\"; } We show up to 10 sheets as “A101 - Floor Plan”. If there are none, we display that clearly. 7) Show the Result in WPF 1 2 3 4 viewModel.ResultMessage = resultMessage; var view = new guRooView(viewModel); view.ShowDialog(); Set the ViewModel property (MVVM). Open your WPF dialog to show the message. Why the Sheet Creation “Fails” (and How to Make It Succeed) It fails because we passed ElementId.InvalidElementId. To actually create a sheet, find a real title block type first:\n1 2 3 4 var titleBlockId = new FilteredElementCollector(Document) .OfCategory(BuiltInCategory.OST_TitleBlocks) .WhereElementIsElementType() .FirstElementId(); // throws if none exist Replace the invalid id with this titleBlockId before ViewSheet.Create(...) and the command will create a sheet (assuming at least one title block type is loaded).\nOptional Cleanups (Beginner-Safe) Safer casting with LINQ: 1 2 3 4 var sheets = new FilteredElementCollector(Document) .OfClass(typeof(ViewSheet)) .Cast\u003cViewSheet\u003e() .ToList(); StringBuilder for long messages (not required, just tidy for larger outputs). Key Takeaways Always use a Transaction to modify the model. Handle exceptions and rollback on failure—never leave a transaction open. Collectors are how you find elements efficiently. MVVM + WPF: set data on the ViewModel; the dialog updates automatically. For creating sheets, you need a valid title block type (OST_TitleBlocks). These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.\n","wordCount":"1000","inLanguage":"en","image":"https://blog.aydrafting.com/images/Pasted%20image%2020250902204444.png","datePublished":"2025-08-06T01:00:00+03:00","dateModified":"2025-08-06T01:00:00+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.aydrafting.com/posts/lesson-1/"},"publisher":{"@type":"Organization","name":"Blog","logo":{"@type":"ImageObject","url":"https://blog.aydrafting.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.aydrafting.com/ accesskey=h title="Blog (Alt + H)">Blog</a></div><div class="logo main-logo"><a href=https://aydrafting.com target=_blank><img src=/LogoAYD.png alt=Blog height=40></a></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.aydrafting.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.aydrafting.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">C# + Revit API: Lesson 1 - A Simple Walkthrough of the Command</h1><div class=post-meta><span title='2025-08-06 01:00:00 +0300 MSK'>August 6, 2025</span>&nbsp;·&nbsp;5 min&nbsp;|&nbsp;<a href=mailto:%20aydimir@aydrafting.com rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=https://blog.aydrafting.com/images/Pasted%20image%2020250902204444.png alt="What Each Part Does (Beginner-Friendly)"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#the-command-full-code aria-label="The Command (Full Code)">The Command (Full Code)</a></li><li><a href=#what-each-part-does-beginner-friendly aria-label="What Each Part Does (Beginner-Friendly)">What Each Part Does (Beginner-Friendly)</a><ul><li><a href=#1-imports aria-label="1) Imports">1) Imports</a></li><li><a href=#2-class--attributes aria-label="2) Class & Attributes">2) Class & Attributes</a></li><li><a href=#3-getting-the aria-label="3) Getting the ViewModel">3) Getting the ViewModel</a></li><li><a href=#4-intentionally-invalid-title-block aria-label="4) Intentionally Invalid Title Block">4) Intentionally Invalid Title Block</a></li><li><a href=#5-transaction--error-handling-around aria-label="5) Transaction + Error Handling Around ">5) Transaction + Error Handling Around </a></li><li><a href=#viewsheetcreate aria-label=ViewSheet.Create>ViewSheet.Create</a></li><li><a href=#6-collecting-existing-sheets aria-label="6) Collecting Existing Sheets">6) Collecting Existing Sheets</a></li><li><a href=#7-show-the-result-in-wpf aria-label="7) Show the Result in WPF">7) Show the Result in WPF</a></li></ul></li><li><a href=#why-the-sheet-creation-fails-and-how-to-make-it-succeed aria-label="Why the Sheet Creation “Fails” (and How to Make It Succeed)">Why the Sheet Creation “Fails” (and How to Make It Succeed)</a></li><li><a href=#optional-cleanups-beginner-safe aria-label="Optional Cleanups (Beginner-Safe)">Optional Cleanups (Beginner-Safe)</a></li><li><a href=#key-takeaways aria-label="Key Takeaways">Key Takeaways</a></li></ul></div></details></div><div class=post-content><p>This post explains <strong>one concrete command</strong>—line by line—so a beginner can follow without extra abstractions.</p><p><strong>What this command does when you click your add-in button:</strong></p><ol><li><p>Tries to create a <strong>sheet</strong> (using an <strong>invalid</strong> title block on purpose → shows how error handling works).</p></li><li><p>Collects up to <strong>10 existing sheets</strong> and formats their numbers/names.</p></li><li><p>Displays the result in a <strong>WPF dialog</strong> via a ViewModel.</p></li></ol><blockquote><p>✅ This article focuses only on the command. It assumes you’ve already wired a ribbon button (and .addin) that triggers <code>StartupCommand</code>.</p><p>If you have no knowledge of how to set this up, I would suggest just skimming through - just for reference and going to the next post, where I will start from scratch.</p></blockquote><hr><h2 id=the-command-full-code><strong>The Command (Full Code)</strong><a hidden class=anchor aria-hidden=true href=#the-command-full-code>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=nn>Autodesk.Revit.Attributes</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>Nice3point.Revit.Toolkit.External</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>guRoo.Views</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>guRoo.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>guRoo.Commands</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>///     External command entry point</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=na>    [UsedImplicitly]</span>
</span></span><span class=line><span class=cl><span class=na>    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>class</span> <span class=nc>StartupCommand</span> <span class=p>:</span> <span class=n>ExternalCommand</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>Execute</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>viewModel</span> <span class=p>=</span> <span class=n>Host</span><span class=p>.</span><span class=n>GetService</span><span class=p>&lt;</span><span class=n>guRooViewModel</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>titleBlockId</span> <span class=p>=</span> <span class=n>ElementId</span><span class=p>.</span><span class=n>InvalidElementId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>string</span> <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>using</span> <span class=p>(</span><span class=kt>var</span> <span class=n>transaction</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Transaction</span><span class=p>(</span><span class=n>Document</span><span class=p>,</span> <span class=s>&#34;Create Sheet&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>transaction</span><span class=p>.</span><span class=n>Start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>try</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kt>var</span> <span class=n>sheet</span> <span class=p>=</span> <span class=n>ViewSheet</span><span class=p>.</span><span class=n>Create</span><span class=p>(</span><span class=n>Document</span><span class=p>,</span> <span class=n>titleBlockId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>transaction</span><span class=p>.</span><span class=n>Commit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>&#34;Sheet created successfully!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>catch</span> <span class=p>(</span><span class=n>Autodesk</span><span class=p>.</span><span class=n>Revit</span><span class=p>.</span><span class=n>Exceptions</span><span class=p>.</span><span class=n>ArgumentException</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>transaction</span><span class=p>.</span><span class=n>RollBack</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>$&#34;Sheet could not be made: {ex.Message}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>transaction</span><span class=p>.</span><span class=n>RollBack</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>$&#34;Error: {ex.Message}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// Get sheet information to display</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>allSheets</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>Document</span><span class=p>).</span>
</span></span><span class=line><span class=cl>					            <span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>ViewSheet</span><span class=p>)).</span>
</span></span><span class=line><span class=cl>					            <span class=n>ToElements</span><span class=p>().</span>
</span></span><span class=line><span class=cl>					            <span class=n>ToList</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>allSheets</span><span class=p>.</span><span class=n>Count</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kt>var</span> <span class=n>sheetNames</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=n>Math</span><span class=p>.</span><span class=n>Min</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=n>allSheets</span><span class=p>.</span><span class=n>Count</span><span class=p>);</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kt>var</span> <span class=n>sheet</span> <span class=p>=</span> <span class=n>allSheets</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>as</span> <span class=n>ViewSheet</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>sheetNames</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>$&#34;{sheet.SheetNumber} - {sheet.Name}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>resultMessage</span> <span class=p>+=</span> <span class=s>$&#34;\n\nFound {allSheets.Count} sheets:
</span></span></span><span class=line><span class=cl><span class=s>					               \n&#34;</span> <span class=p>+</span> <span class=kt>string</span><span class=p>.</span><span class=n>Join</span><span class=p>(</span><span class=s>&#34;\n&#34;</span><span class=p>,</span> <span class=n>sheetNames</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>resultMessage</span> <span class=p>+=</span> <span class=s>&#34;\n\nNo sheets found in document.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>viewModel</span><span class=p>.</span><span class=n>ResultMessage</span> <span class=p>=</span> <span class=n>resultMessage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>view</span> <span class=p>=</span> <span class=k>new</span> <span class=n>guRooView</span><span class=p>(</span><span class=n>viewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>view</span><span class=p>.</span><span class=n>ShowDialog</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=what-each-part-does-beginner-friendly><strong>What Each Part Does (Beginner-Friendly)</strong><a hidden class=anchor aria-hidden=true href=#what-each-part-does-beginner-friendly>#</a></h2><h3 id=1-imports><strong>1) Imports</strong><a hidden class=anchor aria-hidden=true href=#1-imports>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=nn>Autodesk.Revit.Attributes</span><span class=p>;</span>         <span class=c1>// [Transaction(...)] attribute</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>Nice3point.Revit.Toolkit.External</span><span class=p>;</span> <span class=c1>// ExternalCommand base + Host DI</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>guRoo.Views</span><span class=p>;</span>                        <span class=c1>// WPF Window (guRooView)</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>guRoo.ViewModels</span><span class=p>;</span>                   <span class=c1>// ViewModel (guRooViewModel)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p><strong>Revit attributes</strong> let you declare transaction behaviour.</p></li><li><p><strong>Nice3point Toolkit</strong> provides a simplified ExternalCommand base (gives you Document) and DI access via <code>Host.GetService&lt;T>().</code></p></li><li><p><strong>Views/ViewModels</strong> are your WPF MVVM types.</p></li></ul><hr><h3 id=2-class--attributes><strong>2) Class & Attributes</strong><a hidden class=anchor aria-hidden=true href=#2-class--attributes>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=na>[UsedImplicitly]</span>
</span></span><span class=line><span class=cl><span class=na>[Transaction(TransactionMode.Manual)]</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>StartupCommand</span> <span class=p>:</span> <span class=n>ExternalCommand</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p><code>StartupCommand</code> runs <strong>when the user clicks</strong> your button.</p></li><li><p><code>[Transaction(TransactionMode.Manual)]</code> = <strong>you</strong> start/commit/rollback changes.</p></li><li><p><code>ExternalCommand</code> (Nice3point) simplifies the Revit command pattern.</p></li></ul><blockquote><p><code>UsedImplicitly</code> is an analyzer hint (e.g., JetBrains) so tooling doesn’t flag it as “unused.”</p></blockquote><hr><h3 id=3-getting-the><strong>3) Getting the <code>ViewModel</code></strong><a hidden class=anchor aria-hidden=true href=#3-getting-the>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>viewModel</span> <span class=p>=</span> <span class=n>Host</span><span class=p>.</span><span class=n>GetService</span><span class=p>&lt;</span><span class=n>UguRooViewModel</span><span class=p>&gt;();</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Pulls a <code>ViewModel</code> instance from DI so the dialog can display results via data binding.</li></ul><hr><h3 id=4-intentionally-invalid-title-block><strong>4) Intentionally Invalid Title Block</strong><a hidden class=anchor aria-hidden=true href=#4-intentionally-invalid-title-block>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>titleBlockId</span> <span class=p>=</span> <span class=n>ElementId</span><span class=p>.</span><span class=n>InvalidElementId</span><span class=p>;</span> 
</span></span><span class=line><span class=cl><span class=c1>// invalid on purpose</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>string</span> <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>We <strong>force a failure</strong> to demonstrate safe error handling.</li><li><code>resultMessage</code> will collect feedback for the user.</li></ul><hr><h3 id=5-transaction--error-handling-around><strong>5) Transaction + Error Handling Around</strong> <a hidden class=anchor aria-hidden=true href=#5-transaction--error-handling-around>#</a></h3><h3 id=viewsheetcreate><code>ViewSheet.Create</code><a hidden class=anchor aria-hidden=true href=#viewsheetcreate>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=p>(</span><span class=kt>var</span> <span class=n>transaction</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Transaction</span><span class=p>(</span><span class=n>Document</span><span class=p>,</span> <span class=s>&#34;Create Sheet&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>transaction</span><span class=p>.</span><span class=n>Start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>sheet</span> <span class=p>=</span> <span class=n>ViewSheet</span><span class=p>.</span><span class=n>Create</span><span class=p>(</span><span class=n>Document</span><span class=p>,</span> <span class=n>titleBlockId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>transaction</span><span class=p>.</span><span class=n>Commit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>&#34;Sheet created successfully!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>Autodesk</span><span class=p>.</span><span class=n>Revit</span><span class=p>.</span><span class=n>Exceptions</span><span class=p>.</span><span class=n>ArgumentException</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>transaction</span><span class=p>.</span><span class=n>RollBack</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>$&#34;Sheet could not be made: {ex.Message}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>transaction</span><span class=p>.</span><span class=n>RollBack</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>resultMessage</span> <span class=p>=</span> <span class=s>$&#34;Error: {ex.Message}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>Revit is read-only</strong> unless you’re inside a Transaction.</li><li>Creating a sheet with an invalid title block throws <code>ArgumentException</code> → we <code>rollback</code> safely and show the message.</li><li>Any unexpected error also triggers a rollback.</li></ul><blockquote><p>This is the core pattern you’ll reuse for <strong>any change</strong> in Revit: <em>Start → Do work → Commit or RollBack on error</em>.</p></blockquote><hr><h3 id=6-collecting-existing-sheets><strong>6) Collecting Existing Sheets</strong><a hidden class=anchor aria-hidden=true href=#6-collecting-existing-sheets>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>allSheets</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>Document</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>ViewSheet</span><span class=p>))</span>
</span></span><span class=line><span class=cl>				    <span class=p>.</span><span class=n>ToElements</span><span class=p>()</span>
</span></span><span class=line><span class=cl>				    <span class=p>.</span><span class=n>ToList</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Use <code>FilteredElementCollector</code> to <strong>find elements</strong> in the document.</li><li>Here we collect <strong>all sheets</strong>.</li></ul><p>Then we format a short list for display:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>allSheets</span><span class=p>.</span><span class=n>Count</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>sheetNames</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=n>Math</span><span class=p>.</span><span class=n>Min</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=n>allSheets</span><span class=p>.</span><span class=n>Count</span><span class=p>);</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>sheet</span> <span class=p>=</span> <span class=n>allSheets</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>as</span> <span class=n>ViewSheet</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>sheetNames</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>$&#34;{sheet.SheetNumber} - {sheet.Name}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>resultMessage</span> <span class=p>+=</span> <span class=s>$&#34;\n\nFound {allSheets.Count} sheets:\n&#34;</span> <span class=p>+</span> <span class=kt>string</span><span class=p>.</span><span class=n>Join</span><span class=p>(</span><span class=s>&#34;\n&#34;</span><span class=p>,</span> <span class=n>sheetNames</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>resultMessage</span> <span class=p>+=</span> <span class=s>&#34;\n\nNo sheets found in document.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>We show <strong>up to 10</strong> sheets as &ldquo;A101 - Floor Plan&rdquo;.</li><li>If there are none, we display that clearly.</li></ul><hr><h3 id=7-show-the-result-in-wpf><strong>7) Show the Result in WPF</strong><a hidden class=anchor aria-hidden=true href=#7-show-the-result-in-wpf>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>viewModel</span><span class=p>.</span><span class=n>ResultMessage</span> <span class=p>=</span> <span class=n>resultMessage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>view</span> <span class=p>=</span> <span class=k>new</span> <span class=n>guRooView</span><span class=p>(</span><span class=n>viewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>view</span><span class=p>.</span><span class=n>ShowDialog</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Set the <code>ViewModel</code> <strong>property</strong> (MVVM).</li><li>Open your WPF <strong>dialog</strong> to show the message.</li></ul><hr><h2 id=why-the-sheet-creation-fails-and-how-to-make-it-succeed><strong>Why the Sheet Creation “Fails” (and How to Make It Succeed)</strong><a hidden class=anchor aria-hidden=true href=#why-the-sheet-creation-fails-and-how-to-make-it-succeed>#</a></h2><p>It fails because we passed <code>ElementId.InvalidElementId</code>. To actually create a sheet, find a <strong>real title block type</strong> first:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>titleBlockId</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>Document</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfCategory</span><span class=p>(</span><span class=n>BuiltInCategory</span><span class=p>.</span><span class=n>OST_TitleBlocks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WhereElementIsElementType</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>FirstElementId</span><span class=p>();</span> <span class=c1>// throws if none exist</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Replace the invalid id with this titleBlockId before <code>ViewSheet.Create(...)</code> and the command will create a sheet (assuming at least one title block type is loaded).</p></blockquote><hr><h2 id=optional-cleanups-beginner-safe><strong>Optional Cleanups (Beginner-Safe)</strong><a hidden class=anchor aria-hidden=true href=#optional-cleanups-beginner-safe>#</a></h2><ul><li><strong>Safer casting with LINQ</strong>:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>var</span> <span class=n>sheets</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FilteredElementCollector</span><span class=p>(</span><span class=n>Document</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>OfClass</span><span class=p>(</span><span class=k>typeof</span><span class=p>(</span><span class=n>ViewSheet</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>Cast</span><span class=p>&lt;</span><span class=n>ViewSheet</span><span class=p>&gt;()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>ToList</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>StringBuilder</code> for long messages (not required, just tidy for larger outputs).</li></ul><hr><h2 id=key-takeaways><strong>Key Takeaways</strong><a hidden class=anchor aria-hidden=true href=#key-takeaways>#</a></h2><ul><li><strong>Always use a Transaction</strong> to modify the model.</li><li><strong>Handle exceptions</strong> and <strong>rollback</strong> on failure—never leave a transaction open.</li><li><strong>Collectors</strong> are how you <strong>find elements</strong> efficiently.</li><li><strong>MVVM + WPF</strong>: set data on the ViewModel; the dialog updates automatically.</li><li>For creating sheets, you need a <strong>valid title block type</strong> (<code>OST_TitleBlocks</code>).</li></ul><blockquote><p>These tutorials were inspired by the work of <a href=https://www.youtube.com/@AussieBIMGuru>Aussie BIM Guru</a>. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.aydrafting.com/tags/c%23/>C#</a></li><li><a href=https://blog.aydrafting.com/tags/revit/>Revit</a></li><li><a href=https://blog.aydrafting.com/tags/tutorial/>Tutorial</a></li></ul><nav class=paginav><a class=next href=https://blog.aydrafting.com/posts/lesson-0/><span class=title>Next »</span><br><span>C# + Revit API: Lesson 0</span></a></nav></footer></article></main><footer class=footer><span>© 2025 AYDrafting. All rights reserved.</span> ·
<span>Powered by
<a href=https://aydrafting.com/ rel="noopener noreferrer" target=_blank>AYDrafting</a> &
<a href=https://github.com/aydimir95/ rel=noopener target=_blank>GitHub</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>