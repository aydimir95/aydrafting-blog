<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>C# &#43; Revit API: Lesson 7 - Object Oriented Programming | Blog</title>
<meta name="keywords" content="C#, Revit, Tutorial">
<meta name="description" content="Game: Introduction to Classes

Let&rsquo;s play a little game that would help you quickly visualize a Class, Properties, Methods, and Interface. And select the interface that matches the class.
Think of the interface as a Template the Class should follow or in other words the Category the Class belongs to.
Simply, the Interface is a Category of the Class, the Class is a Template of an Object, and the Object, for example, is an actual Dog.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/lesson-7/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css" integrity="sha256-bVhUcqQJqPUE5r&#43;Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/lesson-7/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/lesson-7/">
  <meta property="og:site_name" content="Blog">
  <meta property="og:title" content="C# &#43; Revit API: Lesson 7 - Object Oriented Programming">
  <meta property="og:description" content="Game: Introduction to Classes Let‚Äôs play a little game that would help you quickly visualize a Class, Properties, Methods, and Interface. And select the interface that matches the class.
Think of the interface as a Template the Class should follow or in other words the Category the Class belongs to.
Simply, the Interface is a Category of the Class, the Class is a Template of an Object, and the Object, for example, is an actual Dog.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-08T13:06:57+03:00">
    <meta property="article:modified_time" content="2025-08-08T13:06:57+03:00">
    <meta property="article:tag" content="C#">
    <meta property="article:tag" content="Revit">
    <meta property="article:tag" content="Tutorial">
    <meta property="og:image" content="http://localhost:1313/images/Pasted%20image%2020250902205414.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/Pasted%20image%2020250902205414.png">
<meta name="twitter:title" content="C# &#43; Revit API: Lesson 7 - Object Oriented Programming">
<meta name="twitter:description" content="Game: Introduction to Classes

Let&rsquo;s play a little game that would help you quickly visualize a Class, Properties, Methods, and Interface. And select the interface that matches the class.
Think of the interface as a Template the Class should follow or in other words the Category the Class belongs to.
Simply, the Interface is a Category of the Class, the Class is a Template of an Object, and the Object, for example, is an actual Dog.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "C# + Revit API: Lesson 7 - Object Oriented Programming",
      "item": "http://localhost:1313/posts/lesson-7/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C# + Revit API: Lesson 7 - Object Oriented Programming",
  "name": "C# \u002b Revit API: Lesson 7 - Object Oriented Programming",
  "description": "Game: Introduction to Classes Let\u0026rsquo;s play a little game that would help you quickly visualize a Class, Properties, Methods, and Interface. And select the interface that matches the class.\nThink of the interface as a Template the Class should follow or in other words the Category the Class belongs to.\nSimply, the Interface is a Category of the Class, the Class is a Template of an Object, and the Object, for example, is an actual Dog.\n",
  "keywords": [
    "C#", "Revit", "Tutorial"
  ],
  "articleBody": "Game: Introduction to Classes Let‚Äôs play a little game that would help you quickly visualize a Class, Properties, Methods, and Interface. And select the interface that matches the class.\nThink of the interface as a Template the Class should follow or in other words the Category the Class belongs to.\nSimply, the Interface is a Category of the Class, the Class is a Template of an Object, and the Object, for example, is an actual Dog.\nWe will explore this pattern below, let‚Äôs just play the game first, what Category or Interface does the Class:Dog belongs?\n1. Introduction Project Folder Structure 1 2 3 4 5 6 7 8 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e Forms |-\u003e Resources |-\u003e Application.cs |-\u003e guRoo.addin These are folders which contain various files that our toolbar will utilize.\nNote that these are not necessarily aligned with namespaces (which will be covered later) 2. What is a Class? In C#, classes are templates related to the creation and management of objects. There are many predefined classes available in C# and the Revit API. We use them for a wide range of things and will regularly be creating and developing our own classes. Accessing properties / methods of a Class Property: object.Property -\u003e to access a property Method: Object.Method(argument1, argument2, etc) -\u003e to access a method Namespaces When we create classes, we first tell them where they belong in our project. Namespaces can be nested within others using a dot separator, eventually tied back to our .addin namespace. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // Revit API using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // geeWiz - internal project objects using geeWiz.Extensions; using geeWiz = geeWiz.Forms; using geeWiz = geeWiz.Utilities.Workshare_Utils; // The class belongs to the Commands namespace namespace geeWiz.Cmds_Audit { // Cmd_DeletePatterns // Cmd_PurgeRooms // Cmd_PurgeTemplates // Cmd_PurgeFilters } Basic Class Anatomy modifers class ClassName : Interface(s) Constructor (optional) Properties (optional) Methods (optional) Access modifiers control how this code can be accessed inside and outside your project. You will typically need to declare at least on of public/private, And sometimes static for the purposes we will use them for early on. Static Modifier The static access modifier is a difficult concept to grasp at first, so we will simplify it somewhat. Classes with a static modifier do not support the creation of objects of that class (instantiated). We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us. So basically, the Static modifier is one instrument that you could use to build a complex script with.\nPublic and Private Modifier The public modifier lets you access something anywhere in your project. The private modifier limits access to the same class instead (generally for behind-the-scenes code in the class itself). There are other modifiers, but let‚Äôs keep it simple.\nClass Declaration modifiers class ClassName : Interface(s)\nAfter our modifiers we must define our class by using the keyword ‚Äòclass‚Äô, followed by a Class Name.\nGenerally, most people use PascalCase for class names, and you should choose names which are not reserved elsewhere.\nInterface(s) (Optional) modifiers class ClassName : Interface(s)\nInterface - acts as a template that a class should follow. It‚Äôs like a contract that is formed with your class -\u003e the class must have certain methods / properties / behaviours that this interface would provide to it.\nFormally:\nInterfaces are optional agreements that the class must form with predefined class templates. They usually provide methods and properties which would otherwise be cumbersome to access/define, as well as ensuring the class follows some requirements. Referencing a Class Static example (access without creating an instance): 1 var myInstance = ClassName; A static class or member belongs to the class itself, not to any specific object. You use the class name to access it directly. You can call its methods or properties right away ‚Äî no need to create an object. Because it‚Äôs static, you cannot use new to make an instance of it. Example:\n1 2 // Accessing a static property without creating Math object Console.WriteLine(Math.PI); Non-static example ‚Äì Create and use an object 1 var myInstance = new ClassName(); A non-static class needs to be instantiated (created) before you can use it. You create a new object using the new keyword and parentheses () to run its constructor. The variable myInstance now refers to this new object, and you can use its methods and properties. The var keyword tells the compiler to figure out the variable‚Äôs type automatically. Example:\n1 2 var car = new Car(); car.Drive(); // Calling an instance method Homework Let‚Äôs do the following:\nSet up a class file (.cs) in our project, Create a namespace for it, Define our class (non-static, public). Its purpose is to store and process results from forms we create.\nSolution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // 1. Create a new folder (if you haven't already) and call it 'Forms' // 2. Add a new item to 'Forms' -\u003e pick the 'Class' type -\u003e name it: \"Custom.cs\" using System; using System.Collection.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace guRoo.Forms // try to make your namespace follow your folder structure { public static class Custom // change to 'public' + 'static' class { } public class FormResult // add another 'non-static' class { } } Here‚Äôs a cleaner, beginner-friendly rewrite with improved structure, simpler explanations, and a working example that will actually compile.\nI‚Äôve also made the terminology more precise and added a clear generic vs. specific constructor example.\n3. Constructors Optional but very useful\nA constructor is a special method that runs automatically when you create a new object from a class:\nIt tells the class how it should start ‚Äî for example, setting initial values. If you don‚Äôt add a constructor, C# uses a default constructor that simply sets properties to their default values, or formally: C# provides an implicit parameterless constructor that sets members to their type defaults. You can make your own constructor to set specific values when an object is created. A class can have multiple constructors (called constructor overloading), which is a form of polymorphism. Constructor Syntax 1 2 3 4 5 6 7 8 class ClassName { // Constructor with parameters public ClassName(type parameterName) { // Initialization logic } } Example: Generic vs. Specific Constructor Let‚Äôs create a FormResult class with two constructors:\nGeneric constructor ‚Äì takes no arguments (creates a form with default values) Specific constructor ‚Äì allows setting a custom status when creating the form 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 namespace guRoo.Forms // Use namespaces that match your folder structure { public class FormResult { public string Status { get; set; } // 1. Generic constructor (no parameters) public FormResult() { Status = \"Pending\"; // Default value } // 2. Specific constructor (with parameter) public FormResult(string status) { Status = status; } } } Using the Constructors 1 2 3 4 5 6 7 // Using the generic constructor var form1 = new FormResult(); Console.WriteLine(form1.Status); // Output: Pending // Using the specific constructor var form2 = new FormResult(\"Cancelled\"); Console.WriteLine(form2.Status); // Output: Cancelled Homework In this exercise, you‚Äôll learn how to create two different constructors in a class ‚Äî one that uses a default value and one that accepts a custom value when creating an object.\nWe‚Äôll do this in a Revit API context by making a simple SheetResult class that stores the name of a sheet.\nYour task:\nCreate a new class called SheetResult in Custom.cs. Add: A generic constructor (no parameters) that sets the SheetName property to ‚ÄúUntitled Sheet‚Äù. A specific constructor (with a parameter) that accepts a string and sets SheetName to the provided value. Note: if you add the specific constructor, also add the parameterless one yourself. In Custom.cs, create a static method ShowSheetResultDemo() that: Creates one SheetResult using the generic constructor. Creates another SheetResult using the specific constructor with a custom name. Displays both names in a TaskDialog. In your StartupCommand.Execute() method, call Custom.ShowSheetResultDemo() to run the demo inside Revit. üí° This will help you understand how constructors work in C#, and how you can use them to set up different ways of creating an object in your Revit add-ins.\nSolution Custom.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 using Autodesk.Revit.UI; namespace guRoo.Forms { public static class Custom // helper you can call from anywhere { public static void ShowSheetResultDemo() { var sheet1 = new SheetResult(); // generic var sheet2 = new SheetResult(\"A101 - Floor Plan\");¬†// specific TaskDialog.Show(\"Sheet Results\", $\"Generic constructor: {sheet1.SheetName}\\n\" + $\"Specific constructor: {sheet2.SheetName}\"); } } public class SheetResult { public string SheetName { get; set; } // Parameterless (generic) constructor public SheetResult() =\u003e SheetName = \"Untitled Sheet\"; // Constructor with parameters (specific) public SheetResult(string sheetName) =\u003e SheetName = sheetName; } } StartupCommand.cs 1 2 3 4 5 6 7 8 using guRoo.Forms; // add this public override void Execute() { // ...your existing code... Custom.ShowSheetResultDemo(); // \u003c-- shows the dialog from Custom.cs } 4. Properties Properties define the data that a class can store and expose.\nWhile you can make properties publicly accessible, best practice is to keep the underlying data private (inside the class) and control access through public get and set accessors.\nThis approach:\nKeeps the internal state of your object safe from unintended changes. Lets you add validation or extra logic when reading or writing values. In simple examples, we‚Äôll mostly use auto-implemented properties (public string Name { get; set; }), but we‚Äôll also show how to back them with private fields when you need more control.\nDeclaring a property A property is like a named piece of data that belongs to a class. The simplest form is an auto-implemented property, which C# creates for you without needing to write extra code:\n1 2 3 4 Class declaration { modifiers type PropertyName{get;set} } 1 2 3 4 public class Person { public string Name { get; set; } // auto property } Using a private field Sometimes you want more control over how a property‚Äôs value is stored or changed. In that case, you can store the value in a private field and use a property to get and set it.\n1 2 3 4 5 6 7 8 9 10 class ClassName { private type fieldName; // lowerCamelCase for fields public type PropertyName // PascalCase for properties { get { return fieldName; } set { fieldName = value; } } } Example: 1 2 3 4 5 6 7 8 9 10 public class Person { private string name; // field public string Name // property { get { return name; } set { name = value; } } } üí° Tip: By convention, fields use camelCase and properties use PascalCase. This makes it easier to spot them in your code.\nHomework Properties let us store and access data in a class. In our earlier example, the SheetResult class only had a SheetName property.\nYour task:\nLet‚Äôs expand it to include more information ‚Äî for example, the SheetNumber And show both a simple auto-property and a property backed by a private field. Solution Custom.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 using Autodesk.Revit.UI; namespace guRoo.Forms { // ===== STATIC CLASS ===== public static class Custom { // ===== METHOD ===== public static void ShowSheetResultDemo() { // Create objects var sheet1 = new SheetResult(); // generic constructor var sheet2 = new SheetResult(\"A101 - Floor Plan\", \"S-001\"); // specific constructor // Show results in Revit dialog TaskDialog.Show(\"Sheet Results\", $\"Generic constructor: {sheet1.SheetName}, Number: {sheet1.SheetNumber}\\n\" + $\"Specific constructor: {sheet2.SheetName}, Number: {sheet2.SheetNumber}\"); } // ===== END METHOD ===== } // ===== END STATIC CLASS ===== // ===== CLASS ===== public class SheetResult { // ===== PROPERTIES ===== // Auto-implemented property public string SheetName { get; set; } // Private field + property with get/set logic private string sheetNumber; public string SheetNumber { get { return sheetNumber; } set { // Example: basic validation if (string.IsNullOrWhiteSpace(value)) sheetNumber = \"No Number\"; else sheetNumber = value; } } // ===== END PROPERTIES ===== // ===== CONSTRUCTORS ===== // Generic constructor public SheetResult() { SheetName = \"Untitled Sheet\"; SheetNumber = \"No Number\"; } // Specific constructor public SheetResult(string sheetName, string sheetNumber = \"No Number\") { SheetName = sheetName; SheetNumber = sheetNumber; } // ===== END CONSTRUCTORS ===== } // ===== END CLASS ===== } What Changed? Auto property: SheetName ‚Äî quick and simple, no custom logic. Property with private field: SheetNumber ‚Äî lets us add validation before saving the value. Constructors updated so both values can be set when creating a SheetResult. Result in Revit When you run StartupCommand, you‚Äôll still get your original workflow, but now the Custom.ShowSheetResultDemo() dialog will display both the sheet name and the sheet number, with ‚ÄúNo Number‚Äù automatically set if no value is given.\n5. Methods A method is an action your class can perform.\nThink of it this way:\nProperties = what the object is (its data). Methods = what the object does (its behavior). Key points:\nMethods can take arguments (optional). Methods have a return type. If they return nothing, use void. Declaring a method 1 2 3 4 5 6 7 8 class ClassName { modifiers returnType MethodName(optionalArguments) { // Code logic here return objectOfType; // omit if return type is void } } Example (continuing our SheetResult) We‚Äôll extend SheetResult with a method that formats its data for display. This reinforces: field + property + constructor + method working together. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 using Autodesk.Revit.UI; namespace guRoo.Forms { // ------- CALLER (static helper you can invoke from your command) ------- public static class Custom { public static void ShowSheetResultDemo() { var s1 = new SheetResult(); // generic ctor var s2 = new SheetResult(\"A101 - Floor Plan\", \"S-001\"); // specific ctor // Call a METHOD that uses the properties/field TaskDialog.Show(\"Methods Demo\", $\"s1 label: {s1.FormatLabel()}\\n\" + $\"s2 label: {s2.FormatLabel()}\"); } } // ------- DATA MODEL (class with properties, field, constructors, methods) ------- public class SheetResult { // Properties public string SheetName { get; set; } // auto-property // Private field + property with simple validation private string _sheetNumber; // field (camelCase with leading underscore is common) public string SheetNumber { get =\u003e _sheetNumber; set =\u003e _sheetNumber = string.IsNullOrWhiteSpace(value) ? \"No Number\" : value; } // Constructors public SheetResult() { SheetName = \"Untitled Sheet\"; SheetNumber = \"No Number\"; } public SheetResult(string sheetName, string sheetNumber = \"No Number\") { SheetName = sheetName; SheetNumber = sheetNumber; } // METHODS // Returns a formatted label combining the properties public string FormatLabel() { return $\"{SheetNumber} - {SheetName}\"; } // Example of a void method that changes state (optional) public void Rename(string newName) { SheetName = string.IsNullOrWhiteSpace(newName) ? SheetName : newName; } } } Homework Create a class Add some properties Give it a constructor Demonstrate how to use a field Demonstrate how to make a method Reference our class in another part of your code base Solution Custom.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 using System.Collections.Generic; using Autodesk.Revit.DB; using Autodesk.Revit.UI; namespace guRoo.Forms { public class FormResult { // ====== Field + wrapped property (best practice) ====== private bool _cancelled; public bool ExampleCancelled { get =\u003e _cancelled; set =\u003e _cancelled = value; } // ====== Properties ====== public object Payload { get; set; } public List\u003cobject\u003e Items { get; set; } public bool Cancelled { get; set; } public bool Valid { get; set; } public bool Affirmative { get; set; } // ====== Constructors ====== public FormResult() { Payload = null; Items = new List\u003cobject\u003e(); _cancelled = true; Cancelled = true; Valid = false; Affirmative = false; } public FormResult(bool isValid) { Payload = null; Items = new List\u003cobject\u003e(); _cancelled = !isValid; Cancelled = !isValid; Valid = isValid; Affirmative = isValid; } // ====== Methods ====== // Change state to invalid public void SetToInvalid() { _cancelled = true; Cancelled = true; Valid = false; Affirmative = false; } // Summary for debugging or UI public string Summary() =\u003e $\"Valid: {Valid}, Cancelled: {Cancelled}, Affirmative: {Affirmative}, Items: {Items.Count}\"; // Real-world method: tries to create a sheet based on form state public string TryCreateSheet(Document doc) { if (!Valid || Cancelled) return \"Form is invalid or cancelled. No sheet created.\"; // Grab first available title block ElementId titleBlockId = new FilteredElementCollector(doc) .OfCategory(BuiltInCategory.OST_TitleBlocks) .WhereElementIsElementType() .FirstElementId(); if (titleBlockId == ElementId.InvalidElementId) return \"No title block types found. Cannot create sheet.\"; using (Transaction tx = new Transaction(doc, \"Create Sheet\")) { tx.Start(); ViewSheet.Create(doc, titleBlockId); tx.Commit(); } return \"Sheet created successfully!\"; } } } StartupCommand.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 using Autodesk.Revit.Attributes; using Autodesk.Revit.DB; using Autodesk.Revit.UI; using Nice3point.Revit.Toolkit.External; using gFrm = guRoo.Forms; namespace guRoo.Commands { [UsedImplicitly] [Transaction(TransactionMode.Manual)] public class StartupCommand : ExternalCommand { public override void Execute() { // Example 1: Default constructor (invalid form) // var formResult = new gFrm.FormResult(); // Example 2: Affirmative constructor (valid form) var formResult = new gFrm.FormResult(true); // Attach the Revit Document to our form object formResult.Payload = Document; // Optionally, flip it to invalid to test // formResult.SetToInvalid(); // Try to create the sheet string operationResult = formResult.TryCreateSheet(Document); // Show result to the user TaskDialog.Show(\"Form + Sheet Creation\", formResult.Summary() + \"\\n\\n\" + operationResult); } } } Disposal Later on, we will look into other things we can make use of, such as specifying what happens to our class instances when they are disposed. Generally, an object will be disposed when it us not needed anymore. The compiler tracks and determines when this occurs for us, but we can also manually dispose of or with the disposal of objects. We now have a basic understanding of:\nClasses in C# Access modifiers Initialization Properties and methods Namespaces 6. Introduction to Interfaces An interface is like a contract for a class.\nIt doesn‚Äôt contain actual working code ‚Äî instead, it defines what properties and methods a class must have.\nIf a class implements an interface, it promises to include all the members that interface defines.\nThis is useful for making sure different classes follow the same pattern, even if they work in different ways inside.\nüí° Think of it as a checklist: the interface says ‚Äúyou must have these items,‚Äù and your class fills in the details.\nASCII diagram showing the real world application of interfaces: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 +-------------------+ | IAnimal | \u003c- Interface (the contract) |-------------------| | Name : string | | Age : int | | Fetch(): void | +-------------------+ ^ | +-----------+------------+ | | +------------+ +-------------+ | Dog | | Cat | \u003c- Class (blueprint) |------------| |-------------| | Name | | Name | | Age | | Age | | Breed | | Color | | Bark() | | Meow() | | Fetch() | | Fetch() | | Sleep() | | Sleep() | +------------+ +-------------+ ^ ^ | | +----------------+ +------------------+ | myDog | | myCat | \u003c- Object (instance in memory) |----------------| |------------------| | Name = \"Buddy\" | | Name = \"Mittens\" | | Age = 3 | | Age = 2 | | Breed = \"GR\" | | Color = \"Gray\" | | Bark() | | Meow() | | Fetch() | | Fetch() | | Sleep() | | Sleep() | +----------------+ +------------------+ ^ ^ +-----------+------------+ | +----------------------+ | AnimalPlayground | \u003c- Code using IAnimal |----------------------| | Play(IAnimal animal) | +----------------------+ | +-------------------------------+ | Works with ANY object that | | implements IAnimanl (myDog, | | myCat, future animals, etc.) | +-------------------------------+ Flow explanation:\nIAnimal defines the rules. Dog / Cat promise to follow them. myDog / myCat are real objects in memory created from those classes. AnimalPlayground can work with any object that implements IAnimal ‚Äî no matter what the actual class is. Interface Example If we have an interface IAnimal that says:\n‚ÄúYou must have a property Legs‚Äù ‚ÄúYou must have a property Name‚Äù ‚ÄúYou must have a method MakeNoise()‚Äù Then any class implementing IAnimal must include all of those members. 1 2 3 4 5 6 7 8 // Pseudo Code IAnimal int Legs; string Name; void MakeNoise(); Once a class implements an interface:\nYou write the actual code for the methods in that class. You can set the starting values for the interface‚Äôs properties. You can define the behavior of each method however you want. This is why interfaces are considered abstract ‚Äî they don‚Äôt tell you how to do something, only that you must have it.\nThey‚Äôre a way to guide multiple classes to share the same ‚Äútemplate‚Äù of members while letting each class have its own unique implementation.\nUsing an Interface Example.cs 1 2 3 4 5 6 7 8 9 10 11 // Class that implements the IAnimal interface public class Dog : IAnimal { public int Legs { get; set; } = 4; public string Name { get; set; } = \"Dog\"; public void MakeNoise() { Console.WriteLine(\"Woof!\"); } } Explanation:\nThe Dog class implements IAnimal. The Legs and Name properties are given real values. The MakeNoise() method is given actual behavior (printing ‚ÄúWoof!‚Äù). You can implement more than one interface in a single class. By convention, interface names start with I (e.g., IAnimal, IExternalCommand). Argument Provision Many interfaces in the Revit API come with extra built-in support.\nFor example:\nSome interfaces include methods that are automatically called when certain events happen (e.g., a command starts, the application opens, or a document changes). When you implement such an interface, you don‚Äôt have to set up the event wiring yourself ‚Äî Revit will call the method for you. Your job is simply to write the code that runs when the event occurs. üí° Think of it like Revit saying: ‚ÄúWhen this happens, I‚Äôll call your method. Just tell me what you want to do inside it.‚Äù\nApplication Variants Type Description UIControlledApplication Provides access to the Revit application, typically used on startup and shutdown when no document is yet available. ControlledApplication Represents the application service, giving access to documents, options, and application-specific settings (e.g., language). UIApplication Similar to UIControlledApplication, but available during a running session. We‚Äôll use this often, and in a future lesson we‚Äôll register it as a globally accessible variable. UIDocument Represents the current document at the UI level, giving access to things like selections and opened views. Document Represents the current document at the core API level, providing access to Revit API classes, methods, and properties (e.g., collecting elements). How we can access them? These objects are related in a cascading hierarchy ‚Äî you can get one from another:\n1 2 3 4 5 6 7 UIControlledApplication uiCtlApp; // Available at startup/shutdown ControlledApplication ctlApp = uiCtlApp.ControlledApplication; UIApplication uiApp; // Available in commands/events UIDocument uiDoc = uiApp.ActiveUIDocument; Document doc = uiDoc.Document; // The main Revit document API üí° Tip: At startup/shutdown you‚Äôll usually have UIControlledApplication.\nüí° Tip: During a command / event, you‚Äôll start with UIApplication.\nHomework Implement IExternalApplication Implement IExternalCommand Collect the ControlledApplication in your application entry point Collect the Document inside your command Solution Step 1 ‚Äî Learn the interface requirements Go to revitapidocs.com.\nYou‚Äôll see that IExternalApplication defines two methods you must implement:\nOnStartup(UIControlledApplication application) ‚Äî runs when Revit starts. OnShutdown(UIControlledApplication application) ‚Äî runs when Revit shuts down. Both methods must return a Result enum:\nResult.Succeeded ‚Äî startup/shutdown completed successfully. Result.Cancelled ‚Äî you want to cancel the process. Result.Failed ‚Äî something went wrong. Step 2 ‚Äî Understand the parameters When OnStartup() or OnShutdown() runs, Revit passes you a UIControlledApplication object.\nFrom this you can get:\nControlledApplication ‚Üí uiCtlApp.ControlledApplication Gives access to application-level settings, documents list, Revit version info, language, etc. Ribbon and UI setup methods (you can add panels and buttons here). Step 3 ‚Äî Implementation in Application.cs Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 // Autodesk using Autodesk.Revit.UI; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application: IExternalApplication // IExternalApplication for the interface { //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { var ctlApp = uiCtlApp.ControlledApplication; return Result.Succeeded; // or Cancelled } // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } } } Project Solution 1 2 3 4 5 6 7 8 9 10 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e General // Create a Ribbon Panel Folder |-\u003e Cmds_General.cs // Create a Ribbon Panel |-\u003e Forms |-\u003e Resources |-\u003e Application.cs |-\u003e guRoo.addin Cmds_General.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; namespace guRoo.Cmds_General { /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_Test: IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { UIApplication uiApp = commandData.Application; UIDocument uiDoc = uiApp.ActiveUIDocument; Document doc = uiDoc.Document; // Code logic here: // Final return here: return Result.Succeeded; } } /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_Test2: IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { UIApplication uiApp = commandData.Application; UIDocument uiDoc = uiApp.ActiveUIDocument; Document doc = uiDoc.Document; // Code logic here: // Final return here: return Result.Succeeded; } } } Typically, when working with interfaces you start with collecting information from your Revit document. We now have a basic understanding of:\nInterfaces IExternalApplication IExternalCommand Application Classes Document Classes 7. Create a PushButton Now we‚Äôll set up a button in Revit‚Äôs ribbon to run our command.\nWe‚Äôve done something similar before, but this time we‚Äôll follow the standard Revit API approach instead of the Nice3point method.\nWe‚Äôll create:\nRibbonTab RibbonPanel PushButton Command Understanding the Terms RibbonTab ‚Äì A top-level tab in the Revit ribbon interface. Each RibbonTab groups related functionality and contains one or more RibbonPanels. For example, the ‚ÄúAnnotate‚Äù tab contains tools related to dimensions, text, and tags.\nRibbonPanel ‚Äì A container within a RibbonTab that holds one or more buttons. Panels help organize commands visually and logically within a tab. For instance, the ‚ÄúText‚Äù panel inside the ‚ÄúAnnotate‚Äù tab might contain buttons for adding text, leaders, and notes.\nPushButton ‚Äì A clickable button (or a pull-down button with multiple options) that executes a specific Command. There are several related button types in the Revit API:\nPulldownButton ‚Äì Displays a drop-down list of other buttons or commands when clicked.\nPushButton ‚Äì The most common button type. To create one in an add-in, you first create a PushButtonData object to define its properties (name, tooltip, images, and linked command), then add it to a RibbonPanel with RibbonPanel.AddItem(), which returns a PushButton object.\nRadioButton ‚Äì Allows users to select one option from a set. When placed in a group, selecting one radio button automatically deselects the others.\nSplitButton ‚Äì Combines a PushButton with a PulldownButton. The top half performs a default action, while the bottom half opens a list of related actions.\nToggleButton ‚Äì Acts like an on/off switch. It maintains its state after being clicked, making it useful for settings that need to stay enabled or disabled until changed again.\nCommand ‚Äì The underlying logic that executes when a button is pressed. In Revit API development, a Command is typically implemented as a class that implements IExternalCommand, containing the Execute() method where your code runs.\nProperties of a PushButton Property Description AssemblyName Assembly path of the button. AvailabilityClassName The full class name of the class providing the entry point to decide availability of this push button. ClassName The name of the class containing the implementation for the command. Enabled Gets or sets a value indicating whether the item is enabled. Image The image of the button. IsEnabledByContext Indicates if this button can be executed. True if permitted based on the current Revit context (active doc, active view, active tool). False if disabled because of the active context. ItemText Gets or sets the text displayed on the item. ItemType Gets the item type. LargeImage The large image shown on the button. LongDescription Long description of the command tooltip. Name The name of the item. ToolTip The description that appears as a tooltip for the item. ToolTipImage The image to show as part of the button‚Äôs extended tooltip. Visible Gets or sets a value indicating whether the item is visible. Step-by-step: Create a Tab Add a RibbonPanel to the Tab Add a PushButton to the RibbonPanel Related API Classes: UIControlledApplication \u003e GetRibbonPannels Method \u003e Tab Tab \u003e RibbonPannel \u003e AddItem Method RibbonPanel \u003e PushButtonData Constructor \u003e PushButton Object \u003e Icon / Tooltip One Important Method -\u003e GetRibbonPanels : GetRibbonPannels - Get all the custom Panels on Add-Ins Tab of Revit. GetRibbonPannels(String) - Get all the custom Panels on a designated Revit Tab. GetRibbonPannel(Tab) - Get all the custom Panels on a designated standard Revit Tab. Executing Assembly When our add-in is running, all the classes, resources and code we have produced are executed as an Assembly. We will access this to connect commands to buttons. 1 2 using System.Reflection Assembly.GetExecutingAssembly() Homework Create a static utility class Add methods to static utility class that we need Run these methods in OnStartup method Solution Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e General // Create a Ribbon Panel Folder |-\u003e Cmds_General.cs // Create a Ribbon Panel |-\u003e Forms |-\u003e Resources |-\u003e Utilities // Add a New Utilities Folder |-\u003e Ribbon_Utils.cs // Add a New Ribbon Utilities Class |-\u003e Application.cs // Update Application Class |-\u003e guRoo.addin Ribbon_Utils.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Task; namespace guRoo.Utilities { public static class Ribbon_Utils { // Method to create a \"Tab\" public static Result AddRibbonTab(UIControlledApplication uiCtlApp, string tabName) { try { uiCtlApp.CreateRibbonTab(tabName) return Result.Succeeded; } catch { Debug.WriteLine($\"Error: Coulnd not create a tab: {tabName}\"); return Result.Failed; } } // Method to create a \"Panel\" public static RibbonPanel AddRibbonPanelToTab(UIControlledApplication uiCtlApp, string tabName, string panelName) { try { uiCtlApp.CreateRibbonPanel(tabName, panelName) } catch { Debug.WriteLine($\"Error: Could not add {panelName} to {tabName}\") return null; } GetRibbonPanelByName(uiCtlApp, tabName, panelName) } // Method to get that \"Panel\" public static RibbonPannel GetRibbonPanelByName(UIControlledApplication uiCtlApp, string panelName) { var panels = uiCtlApp.GetRibbonPanels(tabName); foreach (var panel in panels) { if (panel.Name == panelName) { return panel; } return null; } } // Method to create a \"Button\" to \"Panel\" /// /// Fill this summary for Methods to be described on Mouse Hover. /// /// This is the ribbonpannel to add to. /// Test /// Test /// Test /// Test /// public static PushButton AddPushButtonToPanel( RibbonPanel panel, string buttonName, string className, string internalName, string assemblyPath) { if (panel is null) { Debug.WriteLine($Error: Could not create {buttonName}.) return null; } // Open PushButtonData Constructor and check what's needed var pushButtonData = new PushButtonData( internalName, buttonName, assemblyPath, className); if (panel.AddItem(pushButtonData) is PushButton pushButton) { pushButton.ToolTip = \"Testing tooltip\"; // pushButton.Image = null; // pushButton.LargeImage = null; return pushButton; } else { Debug.WriteLine(\"$Error: Could not create {buttonName}.\") return null; } } } } Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 // System using System.Reflection; // Autodesk using Autodesk.Revit.UI; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application: IExternalApplication // IExternalApplication for the interface { //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { // Collect the controlled application: var ctlApp = uiCtlApp.ControlledApplication; var assembly = Assembly.GetExecutingAssembly(); avr assemblyPath = assembly.Location; // Variables string tabName = \"guRoo\" // Add RibbonTab gRib.AddRibbonTab(uiCtlApp, tabName); // Create RibbonPanel var panelGeneral = gRib.AddRibbonPanelToTab( uiCtlApp, tabName, \"General\"); // Add PushButton to RibbonPanel var buttonTest = gRib.AddPushButtonToPanel( panelGeneral, \"Testing\", \"guRoo.Cmds_General.Cmd_Test\", assemblyPath) // Final return: return Result.Succeeded; // or Cancelled } // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } } } Cmds_General.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; namespace guRoo.Cmds_General { /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_Test: IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { UIApplication uiApp = commandData.Application; UIDocument uiDoc = uiApp.ActiveUIDocument; Document doc = uiDoc.Document; // Code logic here: // Final return here: return Result.Succeeded; } } /// ///\tExample Command /// [Transaction(TransactionMode.Manual)] public class Cmd_Test2: IExternalCommand { public Result Execute(ExternalCommandData CommandData, ref string message, ElementSet elements) { UIApplication uiApp = commandData.Application; UIDocument uiDoc = uiApp.ActiveUIDocument; Document doc = uiDoc.Document; // Code logic here: TaskDialog.Show(\"It's Working!\", doc.Title); // Final return here: return Result.Succeeded; } } } 8. Global Variables Some programming languages support ‚Äòglobal‚Äô variables, which can be accessed anywhere at any time once set in the project.\nTo my knowledge, C# does not have a dedicated system for this. We can still achieve this by utilizing a static class that is dedicated to storing and providing these.\nLet‚Äôs set up a Globals Class, which will give us access to objects that would otherwise be inaccessible from various areas of our project. We will also look at how we can use an event to capture the UIApplication. Why can‚Äôt we get the UiApp? We will collect most variables on startup, but the UiApplication is not available during this time in Revit. In order to collect it we will take advantage of the Idling Event.\nEvents 101 Events provide us the ability to have code that executes when various events occur in an application. For example, run a code whenever the view is changed. When Revit is available, it is said to be Idling (not doing anything). The Idling event is commonly used to run some code as soon as Revit is available for code to be run. Basic Sub/Unsub syntax Subscribe to Idling event UICtlApp.Idling += MethodName\nUnsubscribe from idling event UICtlApp.Idling -= MethodName\nIn most cases, you will want your method to unsubscribe itself once it has run.\nHomework Create a static Globals Class Add properties and registration method Register the UiApp and Revit User Name using IdlingEvent Solution Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e General |-\u003e Cmds_General.cs |-\u003e Forms |-\u003e General // Add a New General Folder |-\u003e Globals.cs // Add a New Globals Class |-\u003e Resources |-\u003e Utilities |-\u003e Ribbon_Utils.cs |-\u003e Application.cs // Updated |-\u003e guRoo.addin Globals.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 using System; using System.Collection.Generic; using System.Linq; using System.Text; using System.Threading.Task; using Assembly = System.Reflection.Assembly; namespace guRoo { public static class Globals { #region Properties // Applications public static UIControlledApplication UiCtlApp {get;set;} public static ControlledApplication CtlApp {get;set;} public static UIApplication UiApp {get;set;} // Assembly public static Assembly Assembly {get;set;} // Ambiguity or missing ref piblic static string AssemblyPath{get;set;} // Revit Versions public static string RevitVersion {get;set;} public static int RevitVersionInt {get;set;} // User Names public static string UsernameRevit {get;set;} public static string UsernameWindows {get;set;} // GUIDs and Versioning public static string AdddinVersionNumber {get;set;} public static string AddinVersionName {get;set;} public static string AddinName {get;set;} public static string AddinGuid {get;set;} #endregion #region Register Method // Method to Register Variable Properties public static void RegisterProperties(UIControlledApplication uiCtlApp) { UiCtlApp = uiCtlApp; CtlApp = uiCtlApp.ContrlledApplication; // UiApp set on idling Assembly = Assembly.GetExecutingAssembly(); AssemblyPath = Assembly.Location; RevitVersion = CtlApp.VersionNumber; RevitVersionInt = Int32.Parse(RevitVersion); // Revit Username set to idling UsernameWindows = Environment.UserName; AddinVersionNumber = \"25.08.12\"; AddinVersionName = \"WIP\"; AddinName = \"guRoo\"; AddinGuid = \"5FD7523B-5832-4AB8-9B3D-0BE7ACFE1207\"; } #endregion } } Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 // Autodesk using Autodesk.Revit.UI; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application: IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Glovals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); #endregion #region Removed because we added the Global Variables: // Collect the controlled application: // var ctlApp = uiCtlApp.ControlledApplication; // var assembly = Assembly.GetExecutingAssembly(); // avr assemblyPath = assembly.Location; // Variables // string tabName = \"guRoo\" #endregion #region Ribbon setup // Add RibbonTab gRib.AddRibbonTab(uiCtlApp, Globals.AddinName); // instead of TabName // Create RibbonPanel var panelGeneral = gRib.AddRibbonPanelToTab( uiCtlApp, Globals.AddinName, // instead of TabName \"General\"); // Add PushButton to RibbonPanel var buttonTest = gRib.AddPushButtonToPanel( panelGeneral, \"Testing\", \"guRoo.Cmds_General.Cmd_Test\", Globals.AssemblyPath) // instead of assemblyPath #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEvenArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } Ambiguity - is when Windows API and Revit API has the same class name like Assembly using Assembly = System.Reflection.Assembly; - this is how to remove Ambiguity. #region \u0026 #endregion let‚Äôs you organize the code - collapses long paragraphs of code to be able to skim the logic. These tutorials were inspired by the work of Aussie BIM Guru. If you‚Äôre looking for a deeper dive into the topics, check out his channel for detailed explanations.\n",
  "wordCount" : "6904",
  "inLanguage": "en",
  "image":"http://localhost:1313/images/Pasted%20image%2020250902205414.png","datePublished": "2025-08-08T13:06:57+03:00",
  "dateModified": "2025-08-08T13:06:57+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/lesson-7/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Blog (Alt + H)">Blog</a>
        </div>

        
        <div class="logo main-logo">
            <a href="https://aydrafting.com" target="_blank">
                <img src="/LogoAYD.png" alt="Blog" height="40">
            </a>
        </div>

        
        <div class="logo-switches">
            <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        </div>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      C# &#43; Revit API: Lesson 7 - Object Oriented Programming
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='Created: 2025-08-08 13:06:57 +0300 MSK'>August 8, 2025</span>&nbsp;¬∑&nbsp;33 min&nbsp;|&nbsp;<a href="mailto:%20aydimir@aydrafting.com" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/images/Pasted%20image%2020250902205414.png" alt="Object Oriented Programming">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#game-introduction-to-classes" aria-label="Game: Introduction to Classes">Game: Introduction to Classes</a></li>
                <li>
                    <a href="#1-introduction" aria-label="1. Introduction">1. Introduction</a><ul>
                        <ul>
                        
                <li>
                    <a href="#project-folder-structure" aria-label="Project Folder Structure">Project Folder Structure</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#2-what-is-a-class" aria-label="2. What is a Class?">2. What is a Class?</a><ul>
                        <ul>
                        
                <li>
                    <a href="#accessing-properties--methods-of-a-class" aria-label="Accessing properties / methods of a Class">Accessing properties / methods of a Class</a></li>
                <li>
                    <a href="#namespaces" aria-label="Namespaces">Namespaces</a></li>
                <li>
                    <a href="#basic-class-anatomy" aria-label="Basic Class Anatomy">Basic Class Anatomy</a></li>
                <li>
                    <a href="#static-modifier" aria-label="Static Modifier">Static Modifier</a></li>
                <li>
                    <a href="#public-and-private-modifier" aria-label="Public and Private Modifier">Public and Private Modifier</a></li>
                <li>
                    <a href="#class-declaration" aria-label="Class Declaration">Class Declaration</a></li>
                <li>
                    <a href="#interfaces-optional" aria-label="Interface(s) (Optional)">Interface(s) (Optional)</a></li></ul>
                    
                <li>
                    <a href="#referencing-a-class" aria-label="Referencing a Class">Referencing a Class</a><ul>
                        
                <li>
                    <a href="#static-example-access-without-creating-an-instance" aria-label="Static example (access without creating an instance):">Static example (access without creating an instance):</a></li>
                <li>
                    <a href="#non-static-example--create-and-use-an-object" aria-label="Non-static example ‚Äì Create and use an object">Non-static example ‚Äì Create and use an object</a></li>
                <li>
                    <a href="#homework" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution" aria-label="Solution">Solution</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#3-constructors" aria-label="3. Constructors">3. Constructors</a><ul>
                        <ul>
                        
                <li>
                    <a href="#constructor-syntax" aria-label="Constructor Syntax">Constructor Syntax</a></li>
                <li>
                    <a href="#example-generic-vs-specific-constructor" aria-label="Example: Generic vs. Specific Constructor">Example: Generic vs. Specific Constructor</a></li>
                <li>
                    <a href="#using-the-constructors" aria-label="Using the Constructors">Using the Constructors</a></li>
                <li>
                    <a href="#homework-1" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution-1" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#customcs" aria-label="Custom.cs">Custom.cs</a></li>
                <li>
                    <a href="#startupcommandcs" aria-label="StartupCommand.cs">StartupCommand.cs</a></li></ul>
                </li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#4-properties" aria-label="4. Properties">4. Properties</a><ul>
                        <ul>
                        
                <li>
                    <a href="#declaring-a-property" aria-label="Declaring a property">Declaring a property</a></li>
                <li>
                    <a href="#using-a-private-field" aria-label="Using a private field">Using a private field</a></li>
                <li>
                    <a href="#example" aria-label="Example:">Example:</a></li>
                <li>
                    <a href="#homework-2" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution-2" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#customcs-1" aria-label="Custom.cs">Custom.cs</a></li>
                <li>
                    <a href="#what-changed" aria-label="What Changed?">What Changed?</a></li>
                <li>
                    <a href="#result-in-revit" aria-label="Result in Revit">Result in Revit</a></li></ul>
                </li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#5-methods" aria-label="5. Methods">5. Methods</a><ul>
                        <ul>
                        
                <li>
                    <a href="#declaring-a-method" aria-label="Declaring a method">Declaring a method</a></li></ul>
                    
                <li>
                    <a href="#example-continuing-our-sheetresult" aria-label="Example (continuing our SheetResult)">Example (continuing our SheetResult)</a></li>
                <li>
                    <a href="#homework-3" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution-3" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#customcs-2" aria-label="Custom.cs">Custom.cs</a></li>
                <li>
                    <a href="#startupcommandcs-1" aria-label="StartupCommand.cs">StartupCommand.cs</a><ul>
                        
                <li>
                    <a href="#disposal" aria-label="Disposal">Disposal</a></li></ul>
                </li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#6-introduction-to-interfaces" aria-label="6. Introduction to Interfaces">6. Introduction to Interfaces</a><ul>
                        
                <li>
                    <a href="#ascii-diagram-showing-the-real-world-application-of-interfaces" aria-label="ASCII diagram showing the real world application of interfaces:">ASCII diagram showing the real world application of interfaces:</a><ul>
                        
                <li>
                    <a href="#interface-example" aria-label="Interface Example">Interface Example</a></li>
                <li>
                    <a href="#using-an-interface-examplecs" aria-label="Using an Interface Example.cs">Using an Interface Example.cs</a></li>
                <li>
                    <a href="#argument-provision" aria-label="Argument Provision">Argument Provision</a></li></ul>
                </li>
                <li>
                    <a href="#application-variants" aria-label="Application Variants">Application Variants</a><ul>
                        
                <li>
                    <a href="#how-we-can-access-them" aria-label="How we can access them?">How we can access them?</a></li></ul>
                </li>
                <li>
                    <a href="#homework-4" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution-4" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#step-1--learn-the-interface-requirements" aria-label="Step 1 ‚Äî Learn the interface requirements">Step 1 ‚Äî Learn the interface requirements</a></li>
                <li>
                    <a href="#step-2--understand-the" aria-label="Step 2 ‚Äî Understand the parameters">Step 2 ‚Äî Understand the parameters</a></li>
                <li>
                    <a href="#step-3--implementation-in" aria-label="Step 3 ‚Äî Implementation in Application.cs">Step 3 ‚Äî Implementation in Application.cs</a></li>
                <li>
                    <a href="#applicationcs" aria-label="Application.cs">Application.cs</a></li>
                <li>
                    <a href="#project-solution" aria-label="Project Solution">Project Solution</a></li>
                <li>
                    <a href="#cmds_generalcs" aria-label="Cmds_General.cs">Cmds_General.cs</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#7-create-a-pushbutton" aria-label="7. Create a PushButton">7. Create a PushButton</a><ul>
                        
                <li>
                    <a href="#understanding-the-terms" aria-label="Understanding the Terms">Understanding the Terms</a></li>
                <li>
                    <a href="#properties-of-a-pushbutton" aria-label="Properties of a PushButton">Properties of a PushButton</a></li>
                <li>
                    <a href="#step-by-step" aria-label="Step-by-step:">Step-by-step:</a><ul>
                        
                <li>
                    <a href="#related-api-classes" aria-label="Related API Classes:">Related API Classes:</a></li>
                <li>
                    <a href="#one-important-method--" aria-label="One Important Method -&gt; GetRibbonPanels :">One Important Method -&gt; GetRibbonPanels :</a></li>
                <li>
                    <a href="#executing-assembly" aria-label="Executing Assembly">Executing Assembly</a></li></ul>
                </li>
                <li>
                    <a href="#homework-5" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution-5" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#project-solution-1" aria-label="Project Solution">Project Solution</a></li>
                <li>
                    <a href="#ribbon_utilscs" aria-label="Ribbon_Utils.cs">Ribbon_Utils.cs</a></li>
                <li>
                    <a href="#applicationcs-1" aria-label="Application.cs">Application.cs</a></li>
                <li>
                    <a href="#cmds_generalcs-1" aria-label="Cmds_General.cs">Cmds_General.cs</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#8-global-variables" aria-label="8. Global Variables">8. Global Variables</a><ul>
                        
                <li>
                    <a href="#why-cant-we-get-the-uiapp" aria-label="Why can&rsquo;t we get the UiApp?">Why can&rsquo;t we get the UiApp?</a><ul>
                        
                <li>
                    <a href="#events-101" aria-label="Events 101">Events 101</a></li>
                <li>
                    <a href="#basic-subunsub-syntax" aria-label="Basic Sub/Unsub syntax">Basic Sub/Unsub syntax</a></li></ul>
                </li>
                <li>
                    <a href="#homework-6" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution-6" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#project-solution-2" aria-label="Project Solution">Project Solution</a></li>
                <li>
                    <a href="#globalscs" aria-label="Globals.cs">Globals.cs</a></li>
                <li>
                    <a href="#applicationcs-2" aria-label="Application.cs">Application.cs</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="game-introduction-to-classes">Game: Introduction to Classes<a hidden class="anchor" aria-hidden="true" href="#game-introduction-to-classes">#</a></h1>
<blockquote>
<p>Let&rsquo;s play a little game that would help you quickly visualize a <code>Class</code>, <code>Properties</code>, <code>Methods</code>, and <code>Interface</code>. And select the <code>interface</code> that matches the <code>class</code>.</p></blockquote>
<p>Think of the <code>interface</code> as a Template the Class should follow or in other words the Category the Class belongs to.</p>
<p>Simply, the <code>Interface</code> is a Category of the Class, the <code>Class</code> is a Template of an Object, and the <code>Object</code>, for example, is an actual Dog.</p>
<p>We will explore this pattern below, let&rsquo;s just play the game first, what <code>Category</code> or <code>Interface</code> does the <code>Class</code>:<code>Dog</code> belongs?</p>
<div
  id="classcard-1756837114920964000"
  class="class-card-embed"
  data-title="SheetResult"
  data-props="string SheetName { get; set; }|string SheetNumber { get; set; }"
  data-ctors="SheetResult()|SheetResult(string sheetName, string sheetNumber = &#39;No Number&#39;)"
  data-methods="string FormatLabel()"
></div><script defer src="/js/classcard.d96b0e17868a2e53c18ff85ed31eb1a0753ef508db7d30e123d40095443b9261c8229c110e5ca2dfad5aa21bbccc74928808ad1ef3adc98a3dccf8637b2b03de.js" integrity="sha512-2WsOF4aKLlPBj/he0x6xoHU&#43;9QjbfTDhI9QAlUQ7kmHIIpwRDlyi361aohu8zHSSiAitHvOtyYo9zPhjeysD3g==" crossorigin="anonymous"></script>
<h1 id="1-introduction">1. Introduction<a hidden class="anchor" aria-hidden="true" href="#1-introduction">#</a></h1>
<h3 id="project-folder-structure">Project Folder Structure<a hidden class="anchor" aria-hidden="true" href="#project-folder-structure">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Solution
</span></span><span class="line"><span class="cl"><span class="p">|</span>-&gt; guRoo
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Dependencies
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Commands
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Forms
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Resources
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Application.cs
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; guRoo.addin
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>These are <code>folders</code> which contain various files that our toolbar will utilize.</em></p>
<ul>
<li><em>Note that these are not necessarily aligned with <code>namespaces</code> (which will be covered later)</em></li>
</ul>
<hr>
<h1 id="2-what-is-a-class">2. What is a Class?<a hidden class="anchor" aria-hidden="true" href="#2-what-is-a-class">#</a></h1>
<ol>
<li>In C#, classes are templates related to the creation and management of objects. There are many predefined <code>classes</code> available in C# and the Revit API.</li>
<li>We use them for a wide range of things and will regularly be creating and developing our own classes.</li>
</ol>
<hr>
<h3 id="accessing-properties--methods-of-a-class">Accessing properties / methods of a Class<a hidden class="anchor" aria-hidden="true" href="#accessing-properties--methods-of-a-class">#</a></h3>
<ol>
<li>Property:
<ol>
<li><code>object.Property</code> -&gt; to access a property</li>
</ol>
</li>
<li>Method:
<ol>
<li><code>Object.Method(argument1, argument2, etc)</code> -&gt; to access a method</li>
</ol>
</li>
</ol>
<h3 id="namespaces">Namespaces<a hidden class="anchor" aria-hidden="true" href="#namespaces">#</a></h3>
<ol>
<li>When we create classes, we first tell them where they belong in our project.</li>
<li><code>Namespaces</code> can be nested within others using a dot separator, eventually tied back to our <code>.addin</code> namespace.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Revit API</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// geeWiz - internal project objects</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">geeWiz.Extensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">geeWiz</span> <span class="p">=</span> <span class="n">geeWiz</span><span class="p">.</span><span class="n">Forms</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">geeWiz</span> <span class="p">=</span> <span class="n">geeWiz</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Workshare_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// The class belongs to the Commands namespace</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">geeWiz.Cmds_Audit</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Cmd_DeletePatterns</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Cmd_PurgeRooms</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Cmd_PurgeTemplates</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Cmd_PurgeFilters</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="basic-class-anatomy">Basic Class Anatomy<a hidden class="anchor" aria-hidden="true" href="#basic-class-anatomy">#</a></h3>
<ol>
<li><code>modifers class ClassName : Interface(s)</code>
<ul>
<li>Constructor (optional)</li>
<li>Properties (optional)</li>
<li>Methods (optional)</li>
</ul>
</li>
</ol>
<ul>
<li><code>Access modifiers</code> control how this code can be accessed inside and outside your project.</li>
<li>You will typically need to declare at least on of <em><code>public</code>/<code>private</code></em>,
<ul>
<li>And sometimes <em><code>static</code></em> for the purposes we will use them for early on.</li>
</ul>
</li>
</ul>
<h3 id="static-modifier"><code>Static</code> Modifier<a hidden class="anchor" aria-hidden="true" href="#static-modifier">#</a></h3>
<ul>
<li>The <code>static</code> <code>access</code> <code>modifier</code> is a difficult concept to grasp at first, so we will simplify it somewhat.
<ul>
<li>Classes with a <code>static</code> <code>modifier</code> do not support the creation of <code>objects</code> of that <code>class</code> (instantiated).</li>
<li>We commonly take advantage of this to create classes which behave more like toolkits, where the class itself acts more like a singe object we can call upon to do things for us.</li>
</ul>
</li>
</ul>
<blockquote>
<p>So basically, the <code>Static</code> <code>modifier</code> is one instrument that you could use to build a complex script with.</p></blockquote>
<h3 id="public-and-private-modifier"><code>Public</code> and <code>Private</code> Modifier<a hidden class="anchor" aria-hidden="true" href="#public-and-private-modifier">#</a></h3>
<ul>
<li>The <em><code>public</code></em> modifier lets you access something anywhere in your project.</li>
<li>The <em><code>private</code></em> modifier limits access to the same class instead (generally for behind-the-scenes code in the class itself).</li>
</ul>
<p><em>There are <code>other modifiers</code>, but let&rsquo;s keep it simple.</em></p>
<h3 id="class-declaration">Class Declaration<a hidden class="anchor" aria-hidden="true" href="#class-declaration">#</a></h3>
<p><code>modifiers class ClassName : Interface(s)</code></p>
<p>After our modifiers we must define our class by using the keyword &lsquo;class&rsquo;, followed by a Class Name.</p>
<p>Generally, most people use <code>PascalCase</code> for class names, and you should choose names which are not reserved elsewhere.</p>
<h3 id="interfaces-optional">Interface(s) (Optional)<a hidden class="anchor" aria-hidden="true" href="#interfaces-optional">#</a></h3>
<p><code>modifiers class ClassName : Interface(s)</code></p>
<p><code>Interface</code> - acts as a template that a class should follow. It&rsquo;s like a contract that is formed with your class -&gt; the class must have certain methods / properties / behaviours that this interface would provide to it.</p>
<p><strong>Formally:</strong></p>
<ul>
<li><code>Interfaces</code> are optional agreements that the class must form with predefined <code>class</code> templates.</li>
<li>They usually provide <code>methods</code> and <code>properties</code> which would otherwise be cumbersome to access/define, as well as ensuring the class follows some requirements.</li>
</ul>
<h2 id="referencing-a-class">Referencing a Class<a hidden class="anchor" aria-hidden="true" href="#referencing-a-class">#</a></h2>
<h3 id="static-example-access-without-creating-an-instance"><code>Static</code> example (access without creating an instance):<a hidden class="anchor" aria-hidden="true" href="#static-example-access-without-creating-an-instance">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">myInstance</span> <span class="p">=</span> <span class="n">ClassName</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>A <strong><code>static</code></strong> class or member belongs to the <strong>class itself</strong>, not to any specific object.</li>
<li>You use the <strong><code>class name</code></strong> to access it directly.</li>
<li>You can call its <code>methods</code> or <code>properties</code> right away ‚Äî no need to create an object.</li>
<li>Because it‚Äôs static, you <strong>cannot</strong> use new to make an instance of it.</li>
</ul>
<p><em>Example:</em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Accessing a static property without creating Math object</span>
</span></span><span class="line"><span class="cl"><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">PI</span><span class="p">);</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="non-static-example--create-and-use-an-object"><code>Non-static</code> example ‚Äì Create and use an object<a hidden class="anchor" aria-hidden="true" href="#non-static-example--create-and-use-an-object">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">myInstance</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ClassName</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>A <strong><code>non-static</code></strong> class needs to be <strong>instantiated</strong> (created) before you can use it.</li>
<li>You create a new object using the new keyword and parentheses () to run its <code>constructor</code>.</li>
<li>The variable <code>myInstance</code> now <strong>refers to this new object</strong>, and you can use its methods and properties.</li>
<li>The var keyword tells the compiler to figure out the variable‚Äôs type automatically.</li>
</ul>
<p><em>Example:</em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">car</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Car</span><span class="p">();</span>  
</span></span><span class="line"><span class="cl"><span class="n">car</span><span class="p">.</span><span class="n">Drive</span><span class="p">();</span> <span class="c1">// Calling an instance method</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="homework">Homework<a hidden class="anchor" aria-hidden="true" href="#homework">#</a></h3>
<p>Let&rsquo;s do the following:</p>
<ul>
<li>Set up a <code>class</code> file (.cs) in our project,</li>
<li>Create a <code>namespace</code> for it,</li>
<li>Define our class (<code>non-static</code>, <code>public</code>).</li>
</ul>
<p><em>Its purpose is to store and process results from forms we create.</em></p>
<h3 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// 1. Create a new folder (if you haven&#39;t already) and call it &#39;Forms&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 2. Add a new item to &#39;Forms&#39; -&gt; pick the &#39;Class&#39; type -&gt; name it: &#34;Custom.cs&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collection.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Forms</span> <span class="c1">// try to make your namespace follow your folder structure</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Custom</span> <span class="c1">// change to &#39;public&#39; + &#39;static&#39; class </span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">FormResult</span> <span class="c1">// add another &#39;non-static&#39; class</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>Here‚Äôs a cleaner, beginner-friendly rewrite with improved structure, simpler explanations, and a working example that will actually compile.</p>
<p>I‚Äôve also made the terminology more precise and added a clear <strong>generic vs. specific constructor</strong> example.</p>
<hr>
<h1 id="3-constructors">3. Constructors<a hidden class="anchor" aria-hidden="true" href="#3-constructors">#</a></h1>
<blockquote>
<p>Optional but very useful</p></blockquote>
<p>A <code>constructor</code> is a special method that runs automatically when you create a new object from a class:</p>
<ul>
<li>It <strong>tells the <code>class</code> how it should start</strong> ‚Äî for example, setting initial values.</li>
<li>If you don‚Äôt add a constructor, C# uses a <strong>default constructor</strong> that simply sets <code>properties</code> to their default values, or formally: C# provides an <strong>implicit <code>parameterless</code> constructor</strong> that sets members to their type defaults.</li>
<li>You can make your own constructor to set specific values when an object is created.</li>
<li>A class can have <strong>multiple constructors</strong> (called <strong>constructor overloading</strong>), which is a form of <code>polymorphism</code>.</li>
</ul>
<hr>
<h3 id="constructor-syntax">Constructor Syntax<a hidden class="anchor" aria-hidden="true" href="#constructor-syntax">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ClassName</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Constructor with parameters</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ClassName</span><span class="p">(</span><span class="n">type</span> <span class="n">parameterName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Initialization logic</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="example-generic-vs-specific-constructor"><strong>Example: Generic vs. Specific Constructor</strong><a hidden class="anchor" aria-hidden="true" href="#example-generic-vs-specific-constructor">#</a></h3>
<p>Let‚Äôs create a FormResult class with two constructors:</p>
<ol>
<li><strong><code>Generic</code> constructor</strong> ‚Äì takes no arguments (creates a form with default values)</li>
<li><strong><code>Specific</code> constructor</strong> ‚Äì allows setting a custom status when creating the form</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Forms</span> <span class="c1">// Use namespaces that match your folder structure</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">FormResult</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">Status</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 1. Generic constructor (no parameters)</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">FormResult</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Status</span> <span class="p">=</span> <span class="s">&#34;Pending&#34;</span><span class="p">;</span> <span class="c1">// Default value</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 2. Specific constructor (with parameter)</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">FormResult</span><span class="p">(</span><span class="kt">string</span> <span class="n">status</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Status</span> <span class="p">=</span> <span class="n">status</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="using-the-constructors"><strong>Using the Constructors</strong><a hidden class="anchor" aria-hidden="true" href="#using-the-constructors">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Using the generic constructor</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">form1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FormResult</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">form1</span><span class="p">.</span><span class="n">Status</span><span class="p">);</span> <span class="c1">// Output: Pending</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Using the specific constructor</span>
</span></span><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">form2</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FormResult</span><span class="p">(</span><span class="s">&#34;Cancelled&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">form2</span><span class="p">.</span><span class="n">Status</span><span class="p">);</span> <span class="c1">// Output: Cancelled</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="homework-1"><strong>Homework</strong><a hidden class="anchor" aria-hidden="true" href="#homework-1">#</a></h3>
<p>In this exercise, you‚Äôll learn how to create <strong>two different constructors</strong> in a class ‚Äî one that uses a <strong>default value</strong> and one that accepts a <strong>custom value</strong> when creating an object.</p>
<p>We‚Äôll do this in a <strong>Revit API context</strong> by making a simple SheetResult class that stores the <strong>name of a sheet</strong>.</p>
<p><strong>Your task:</strong></p>
<ol>
<li>Create a new class called SheetResult in <code>Custom.cs</code>.</li>
<li>Add:
<ul>
<li>A <code>generic</code> constructor (no parameters) that sets the <code>SheetName</code> property to &ldquo;Untitled Sheet&rdquo;.</li>
<li>A <code>specific</code> constructor (with a parameter) that accepts a string and sets <code>SheetName</code> to the provided value.
<ul>
<li>Note: if you add the <code>specific</code> constructor, also add the <code>parameterless</code> one yourself.</li>
</ul>
</li>
</ul>
</li>
<li>In <code>Custom.cs</code>, create a static method <code>ShowSheetResultDemo()</code> that:
<ul>
<li>Creates one <code>SheetResult</code> using the <code>generic</code> constructor.</li>
<li>Creates another <code>SheetResult</code> using the <code>specific</code> constructor with a <code>custom name</code>.</li>
<li>Displays both names in a <code>TaskDialog</code>.</li>
</ul>
</li>
<li>In your <code>StartupCommand.Execute()</code> method, call <code>Custom.ShowSheetResultDemo()</code> to run the demo inside Revit.</li>
</ol>
<p>üí° <em>This will help you understand how constructors work in C#, and how you can use them to set up different ways of creating an object in your Revit add-ins.</em></p>
<h3 id="solution-1">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-1">#</a></h3>
<h4 id="customcs"><code>Custom.cs</code><a hidden class="anchor" aria-hidden="true" href="#customcs">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Forms</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">¬† ¬† <span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Custom</span> <span class="c1">// helper you can call from anywhere</span>
</span></span><span class="line"><span class="cl">¬† ¬† <span class="p">{</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† <span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">ShowSheetResultDemo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† <span class="p">{</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† ¬† ¬† <span class="kt">var</span> <span class="n">sheet1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SheetResult</span><span class="p">();</span> ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span class="c1">// generic</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† ¬† ¬† <span class="kt">var</span> <span class="n">sheet2</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SheetResult</span><span class="p">(</span><span class="s">&#34;A101 - Floor Plan&#34;</span><span class="p">);</span>¬† <span class="c1">// specific</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† ¬† ¬† 
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† ¬† ¬† <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Sheet Results&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span class="s">$&#34;Generic constructor: {sheet1.SheetName}\n&#34;</span> <span class="p">+</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span class="s">$&#34;Specific constructor: {sheet2.SheetName}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† <span class="p">}</span>
</span></span><span class="line"><span class="cl">¬† ¬† <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">¬† ¬† <span class="kd">public</span> <span class="k">class</span> <span class="nc">SheetResult</span>
</span></span><span class="line"><span class="cl">¬† ¬† <span class="p">{</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† <span class="kd">public</span> <span class="kt">string</span> <span class="n">SheetName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Parameterless (generic) constructor</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† <span class="kd">public</span> <span class="n">SheetResult</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="n">SheetName</span> <span class="p">=</span> <span class="s">&#34;Untitled Sheet&#34;</span><span class="p">;</span> ¬† ¬† 
</span></span><span class="line"><span class="cl">		<span class="c1">// Constructor with parameters (specific)</span>
</span></span><span class="line"><span class="cl">¬† ¬† ¬† ¬† <span class="kd">public</span> <span class="n">SheetResult</span><span class="p">(</span><span class="kt">string</span> <span class="n">sheetName</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">SheetName</span> <span class="p">=</span> <span class="n">sheetName</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">¬† ¬† <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="startupcommandcs"><code>StartupCommand.cs</code><a hidden class="anchor" aria-hidden="true" href="#startupcommandcs">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">guRoo.Forms</span><span class="p">;</span> <span class="c1">// add this</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">Execute</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...your existing code...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Custom</span><span class="p">.</span><span class="n">ShowSheetResultDemo</span><span class="p">();</span> <span class="c1">// &lt;-- shows the dialog from Custom.cs</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="4-properties">4. Properties<a hidden class="anchor" aria-hidden="true" href="#4-properties">#</a></h1>
<p>Properties define the <strong>data</strong> that a <code>class</code> can store and expose.</p>
<p>While you <em>can</em> make properties publicly accessible, best practice is to keep the underlying data <strong><code>private</code></strong> (inside the class) and control access through <strong>public</strong> get and set accessors.</p>
<p>This approach:</p>
<ul>
<li>Keeps the internal state of your object safe from unintended changes.</li>
<li>Lets you add validation or extra logic when reading or writing values.</li>
</ul>
<p>In simple examples, we‚Äôll mostly use <strong>auto-implemented properties</strong> (<code>public string Name { get; set; }</code>), but we‚Äôll also show how to back them with <strong><code>private fields</code></strong> when you need more control.</p>
<h3 id="declaring-a-property">Declaring a property<a hidden class="anchor" aria-hidden="true" href="#declaring-a-property">#</a></h3>
<p>A property is like a <strong>named piece of data</strong> that belongs to a <code>class</code>. The simplest form is an <strong>auto-implemented property</strong>, which C# creates for you without needing to write extra code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">Class</span> <span class="n">declaration</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">modifiers</span> <span class="n">type</span> <span class="n">PropertyName</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">Person</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// auto property</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="using-a-private-field">Using a private field<a hidden class="anchor" aria-hidden="true" href="#using-a-private-field">#</a></h3>
<p>Sometimes you want more control over how a property‚Äôs value is stored or changed. In that case, you can store the value in a <strong>private field</strong> and use a property to <strong>get</strong> and <strong>set</strong> it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ClassName</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">type</span> <span class="n">fieldName</span><span class="p">;</span> <span class="c1">// lowerCamelCase for fields</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">type</span> <span class="n">PropertyName</span> <span class="c1">// PascalCase for properties</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">fieldName</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">set</span> <span class="p">{</span> <span class="n">fieldName</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="example">Example:<a hidden class="anchor" aria-hidden="true" href="#example">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">Person</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">string</span> <span class="n">name</span><span class="p">;</span> <span class="c1">// field</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">Name</span>   <span class="c1">// property</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">name</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">set</span> <span class="p">{</span> <span class="n">name</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>üí° <em>Tip:</em> By convention, <strong>fields</strong> use camelCase and <strong>properties</strong> use PascalCase. This makes it easier to spot them in your code.</p></blockquote>
<h3 id="homework-2">Homework<a hidden class="anchor" aria-hidden="true" href="#homework-2">#</a></h3>
<p>Properties let us store and access data in a class. In our earlier example, the <code>SheetResult</code> class only had a <code>SheetName</code> property.</p>
<p><strong>Your task:</strong></p>
<ul>
<li>Let‚Äôs expand it to include more information ‚Äî for example, the <code>SheetNumber</code></li>
<li>And show both a simple <code>auto-property</code> and a property backed by a <code>private field</code>.</li>
</ul>
<hr>
<h3 id="solution-2">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-2">#</a></h3>
<h4 id="customcs-1"><code>Custom.cs</code><a hidden class="anchor" aria-hidden="true" href="#customcs-1">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Forms</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ===== STATIC CLASS =====</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Custom</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ===== METHOD =====</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">ShowSheetResultDemo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Create objects</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">sheet1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SheetResult</span><span class="p">();</span> <span class="c1">// generic constructor</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">sheet2</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SheetResult</span><span class="p">(</span><span class="s">&#34;A101 - Floor Plan&#34;</span><span class="p">,</span> <span class="s">&#34;S-001&#34;</span><span class="p">);</span> <span class="c1">// specific constructor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Show results in Revit dialog</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Sheet Results&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">$&#34;Generic constructor: {sheet1.SheetName}, Number: {sheet1.SheetNumber}\n&#34;</span> <span class="p">+</span>
</span></span><span class="line"><span class="cl">                <span class="s">$&#34;Specific constructor: {sheet2.SheetName}, Number: {sheet2.SheetNumber}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ===== END METHOD =====</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ===== END STATIC CLASS =====</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// ===== CLASS =====</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">SheetResult</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ===== PROPERTIES =====</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// Auto-implemented property</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">SheetName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Private field + property with get/set logic</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">string</span> <span class="n">sheetNumber</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">SheetNumber</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">sheetNumber</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">set</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// Example: basic validation</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="k">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sheetNumber</span> <span class="p">=</span> <span class="s">&#34;No Number&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sheetNumber</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ===== END PROPERTIES =====</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ===== CONSTRUCTORS =====</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// Generic constructor</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SheetResult</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetName</span> <span class="p">=</span> <span class="s">&#34;Untitled Sheet&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetNumber</span> <span class="p">=</span> <span class="s">&#34;No Number&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Specific constructor</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SheetResult</span><span class="p">(</span><span class="kt">string</span> <span class="n">sheetName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">sheetNumber</span> <span class="p">=</span> <span class="s">&#34;No Number&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetName</span> <span class="p">=</span> <span class="n">sheetName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetNumber</span> <span class="p">=</span> <span class="n">sheetNumber</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ===== END CONSTRUCTORS =====</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ===== END CLASS =====</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="what-changed"><strong>What Changed?</strong><a hidden class="anchor" aria-hidden="true" href="#what-changed">#</a></h4>
<ul>
<li><strong>Auto property</strong>: <code>SheetName</code> ‚Äî quick and simple, no custom logic.</li>
<li><strong>Property with private field</strong>: <code>SheetNumber</code> ‚Äî lets us add validation before saving the value.</li>
<li><strong>Constructors updated</strong> so both values can be set when creating a <code>SheetResult</code>.</li>
</ul>
<h4 id="result-in-revit"><strong>Result in Revit</strong><a hidden class="anchor" aria-hidden="true" href="#result-in-revit">#</a></h4>
<p>When you run <code>StartupCommand</code>, you‚Äôll still get your original workflow, but now the <code>Custom.ShowSheetResultDemo()</code> dialog will display <strong>both the sheet name and the sheet number</strong>, with ‚ÄúNo Number‚Äù automatically set if no value is given.</p>
<hr>
<h1 id="5-methods">5. Methods<a hidden class="anchor" aria-hidden="true" href="#5-methods">#</a></h1>
<p>A <strong>method</strong> is an action your class can perform.</p>
<p>Think of it this way:</p>
<ul>
<li><strong>Properties</strong> = what the object <strong>is</strong> (its data).</li>
<li><strong>Methods</strong> = what the object <strong>does</strong> (its behavior).</li>
</ul>
<p>Key points:</p>
<ul>
<li>Methods can take <strong>arguments</strong> (optional).</li>
<li>Methods have a <strong>return type</strong>. If they return nothing, use void.</li>
</ul>
<h3 id="declaring-a-method">Declaring a method<a hidden class="anchor" aria-hidden="true" href="#declaring-a-method">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ClassName</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">modifiers</span> <span class="n">returnType</span> <span class="n">MethodName</span><span class="p">(</span><span class="n">optionalArguments</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Code logic here</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">objectOfType</span><span class="p">;</span> <span class="c1">// omit if return type is void</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="example-continuing-our-sheetresult">Example (continuing our SheetResult)<a hidden class="anchor" aria-hidden="true" href="#example-continuing-our-sheetresult">#</a></h2>
<ul>
<li>We‚Äôll extend SheetResult with a method that <strong>formats</strong> its data for display.</li>
<li>This reinforces: <strong>field + property + constructor + method</strong> working together.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Forms</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ------- CALLER (static helper you can invoke from your command) -------</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Custom</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">ShowSheetResultDemo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">s1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SheetResult</span><span class="p">();</span>                               <span class="c1">// generic ctor</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">s2</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SheetResult</span><span class="p">(</span><span class="s">&#34;A101 - Floor Plan&#34;</span><span class="p">,</span> <span class="s">&#34;S-001&#34;</span><span class="p">);</span>   <span class="c1">// specific ctor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Call a METHOD that uses the properties/field</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Methods Demo&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">$&#34;s1 label: {s1.FormatLabel()}\n&#34;</span> <span class="p">+</span>
</span></span><span class="line"><span class="cl">                <span class="s">$&#34;s2 label: {s2.FormatLabel()}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// ------- DATA MODEL (class with properties, field, constructors, methods) -------</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">SheetResult</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Properties</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">SheetName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// auto-property</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Private field + property with simple validation</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">string</span> <span class="n">_sheetNumber</span><span class="p">;</span>          <span class="c1">// field (camelCase with leading underscore is common)</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">SheetNumber</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">_sheetNumber</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">set</span> <span class="p">=&gt;</span> <span class="n">_sheetNumber</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="k">value</span><span class="p">)</span> <span class="p">?</span> <span class="s">&#34;No Number&#34;</span> <span class="p">:</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Constructors</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SheetResult</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetName</span> <span class="p">=</span> <span class="s">&#34;Untitled Sheet&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetNumber</span> <span class="p">=</span> <span class="s">&#34;No Number&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SheetResult</span><span class="p">(</span><span class="kt">string</span> <span class="n">sheetName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">sheetNumber</span> <span class="p">=</span> <span class="s">&#34;No Number&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetName</span> <span class="p">=</span> <span class="n">sheetName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetNumber</span> <span class="p">=</span> <span class="n">sheetNumber</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// METHODS</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Returns a formatted label combining the properties</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">FormatLabel</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">$&#34;{SheetNumber} - {SheetName}&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Example of a void method that changes state (optional)</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="k">void</span> <span class="n">Rename</span><span class="p">(</span><span class="kt">string</span> <span class="n">newName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">SheetName</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">newName</span><span class="p">)</span> <span class="p">?</span> <span class="n">SheetName</span> <span class="p">:</span> <span class="n">newName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="homework-3">Homework<a hidden class="anchor" aria-hidden="true" href="#homework-3">#</a></h2>
<ul>
<li>Create a <code>class</code></li>
<li>Add some <code>properties</code></li>
<li>Give it a <code>constructor</code></li>
<li>Demonstrate how to use a <code>field</code></li>
<li>Demonstrate how to make a <code>method</code></li>
<li>Reference  our <code>class</code> in another part of your code base</li>
</ul>
<h2 id="solution-3">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-3">#</a></h2>
<h3 id="customcs-2"><code>Custom.cs</code><a hidden class="anchor" aria-hidden="true" href="#customcs-2">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.DB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Forms</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">FormResult</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ====== Field + wrapped property (best practice) ======</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">bool</span> <span class="n">_cancelled</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">bool</span> <span class="n">ExampleCancelled</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">_cancelled</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">set</span> <span class="p">=&gt;</span> <span class="n">_cancelled</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ====== Properties ======</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">object</span> <span class="n">Payload</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">Items</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">bool</span> <span class="n">Cancelled</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">bool</span> <span class="n">Valid</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">bool</span> <span class="n">Affirmative</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ====== Constructors ======</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">FormResult</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Payload</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Items</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">            <span class="n">_cancelled</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Cancelled</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Valid</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Affirmative</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">FormResult</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isValid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Payload</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Items</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">            <span class="n">_cancelled</span> <span class="p">=</span> <span class="p">!</span><span class="n">isValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Cancelled</span> <span class="p">=</span> <span class="p">!</span><span class="n">isValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Valid</span> <span class="p">=</span> <span class="n">isValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Affirmative</span> <span class="p">=</span> <span class="n">isValid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ====== Methods ======</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Change state to invalid</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="k">void</span> <span class="n">SetToInvalid</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">_cancelled</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Cancelled</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Valid</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Affirmative</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Summary for debugging or UI</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">Summary</span><span class="p">()</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="s">$&#34;Valid: {Valid}, Cancelled: {Cancelled}, Affirmative: {Affirmative}, Items: {Items.Count}&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Real-world method: tries to create a sheet based on form state</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">string</span> <span class="n">TryCreateSheet</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(!</span><span class="n">Valid</span> <span class="p">||</span> <span class="n">Cancelled</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s">&#34;Form is invalid or cancelled. No sheet created.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Grab first available title block</span>
</span></span><span class="line"><span class="cl">            <span class="n">ElementId</span> <span class="n">titleBlockId</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">OfCategory</span><span class="p">(</span><span class="n">BuiltInCategory</span><span class="p">.</span><span class="n">OST_TitleBlocks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">WhereElementIsElementType</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">FirstElementId</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">titleBlockId</span> <span class="p">==</span> <span class="n">ElementId</span><span class="p">.</span><span class="n">InvalidElementId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s">&#34;No title block types found. Cannot create sheet.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">using</span> <span class="p">(</span><span class="n">Transaction</span> <span class="n">tx</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Transaction</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&#34;Create Sheet&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">tx</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">ViewSheet</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">titleBlockId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">tx</span><span class="p">.</span><span class="n">Commit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">&#34;Sheet created successfully!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="startupcommandcs-1"><code>StartupCommand.cs</code><a hidden class="anchor" aria-hidden="true" href="#startupcommandcs-1">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.DB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Nice3point.Revit.Toolkit.External</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gFrm</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Forms</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Commands</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="na">    [UsedImplicitly]</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">StartupCommand</span> <span class="p">:</span> <span class="n">ExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">Execute</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Example 1: Default constructor (invalid form)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// var formResult = new gFrm.FormResult();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Example 2: Affirmative constructor (valid form)</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">formResult</span> <span class="p">=</span> <span class="k">new</span> <span class="n">gFrm</span><span class="p">.</span><span class="n">FormResult</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Attach the Revit Document to our form object</span>
</span></span><span class="line"><span class="cl">            <span class="n">formResult</span><span class="p">.</span><span class="n">Payload</span> <span class="p">=</span> <span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Optionally, flip it to invalid to test</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// formResult.SetToInvalid();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Try to create the sheet</span>
</span></span><span class="line"><span class="cl">            <span class="kt">string</span> <span class="n">operationResult</span> <span class="p">=</span> <span class="n">formResult</span><span class="p">.</span><span class="n">TryCreateSheet</span><span class="p">(</span><span class="n">Document</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Show result to the user</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;Form + Sheet Creation&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">formResult</span><span class="p">.</span><span class="n">Summary</span><span class="p">()</span> <span class="p">+</span> <span class="s">&#34;\n\n&#34;</span> <span class="p">+</span> <span class="n">operationResult</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="disposal">Disposal<a hidden class="anchor" aria-hidden="true" href="#disposal">#</a></h4>
<ul>
<li>Later on, we will look into other things we can make use of, such as specifying what happens to our class instances when they are <code>disposed</code>.</li>
<li>Generally, an object will be <code>disposed</code> when it us not needed anymore. The compiler tracks and determines when this occurs for us, but we can also manually dispose of or with the disposal of objects.</li>
</ul>
<p>We now have a basic understanding of:</p>
<ol>
<li><code>Classes</code> in C#</li>
<li>Access <code>modifiers</code></li>
<li><code>Initialization</code></li>
<li><code>Properties</code> and <code>methods</code></li>
<li><code>Namespaces</code></li>
</ol>
<h1 id="6-introduction-to-interfaces">6. Introduction to Interfaces<a hidden class="anchor" aria-hidden="true" href="#6-introduction-to-interfaces">#</a></h1>
<p>An <strong>interface</strong> is like a <strong>contract</strong> for a class.</p>
<p>It doesn‚Äôt contain actual working code ‚Äî instead, it <strong>defines what properties and methods a class must have</strong>.</p>
<p>If a class <strong>implements</strong> an interface, it promises to include all the members that interface defines.</p>
<p>This is useful for making sure different classes follow the same pattern, even if they work in different ways inside.</p>
<blockquote>
<p>üí° <em>Think of it as a checklist: the interface says ‚Äúyou must have these items,‚Äù and your class fills in the details.</em></p></blockquote>
<hr>
<h2 id="ascii-diagram-showing-the-real-world-application-of-interfaces"><code>ASCII diagram</code> showing the real world application of interfaces:<a hidden class="anchor" aria-hidden="true" href="#ascii-diagram-showing-the-real-world-application-of-interfaces">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">        +-------------------+
</span></span><span class="line"><span class="cl">        <span class="p">|</span>     IAnimal       <span class="p">|</span>   &lt;- Interface <span class="o">(</span>the contract<span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span>-------------------<span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> Name   : string   <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> Age    : int      <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> Fetch<span class="o">()</span>: void     <span class="p">|</span>
</span></span><span class="line"><span class="cl">        +-------------------+
</span></span><span class="line"><span class="cl">                 ^
</span></span><span class="line"><span class="cl">                 <span class="p">|</span>
</span></span><span class="line"><span class="cl">     +-----------+------------+
</span></span><span class="line"><span class="cl">     <span class="p">|</span>                        <span class="p">|</span>
</span></span><span class="line"><span class="cl">+------------+         +-------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span>    Dog     <span class="p">|</span>         <span class="p">|</span>     Cat     <span class="p">|</span>   &lt;- Class <span class="o">(</span>blueprint<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>------------<span class="p">|</span>         <span class="p">|</span>-------------<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Name       <span class="p">|</span>         <span class="p">|</span> Name        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Age        <span class="p">|</span>         <span class="p">|</span> Age         <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Breed      <span class="p">|</span>         <span class="p">|</span> Color       <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Bark<span class="o">()</span>     <span class="p">|</span>         <span class="p">|</span> Meow<span class="o">()</span>      <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Fetch<span class="o">()</span>    <span class="p">|</span>         <span class="p">|</span> Fetch<span class="o">()</span>     <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Sleep<span class="o">()</span>    <span class="p">|</span>         <span class="p">|</span> Sleep<span class="o">()</span>     <span class="p">|</span>
</span></span><span class="line"><span class="cl">+------------+         +-------------+
</span></span><span class="line"><span class="cl">     ^                        ^
</span></span><span class="line"><span class="cl">     <span class="p">|</span>                        <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----------------+     +------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> myDog          <span class="p">|</span>     <span class="p">|</span> myCat            <span class="p">|</span>   &lt;- Object <span class="o">(</span>instance in memory<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>----------------<span class="p">|</span>     <span class="p">|</span>------------------<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="nv">Name</span> <span class="o">=</span> <span class="s2">&#34;Buddy&#34;</span> <span class="p">|</span>     <span class="p">|</span> <span class="nv">Name</span> <span class="o">=</span> <span class="s2">&#34;Mittens&#34;</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="nv">Age</span> <span class="o">=</span> <span class="m">3</span>        <span class="p">|</span>     <span class="p">|</span> <span class="nv">Age</span> <span class="o">=</span> <span class="m">2</span>          <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="nv">Breed</span> <span class="o">=</span> <span class="s2">&#34;GR&#34;</span>   <span class="p">|</span>     <span class="p">|</span> <span class="nv">Color</span> <span class="o">=</span> <span class="s2">&#34;Gray&#34;</span>   <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Bark<span class="o">()</span>         <span class="p">|</span>     <span class="p">|</span> Meow<span class="o">()</span>           <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Fetch<span class="o">()</span>        <span class="p">|</span>     <span class="p">|</span> Fetch<span class="o">()</span>          <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Sleep<span class="o">()</span>        <span class="p">|</span>     <span class="p">|</span> Sleep<span class="o">()</span>          <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----------------+     +------------------+
</span></span><span class="line"><span class="cl">     ^                        ^
</span></span><span class="line"><span class="cl">     +-----------+------------+
</span></span><span class="line"><span class="cl">                 <span class="p">|</span>
</span></span><span class="line"><span class="cl">       +----------------------+
</span></span><span class="line"><span class="cl">       <span class="p">|</span>  AnimalPlayground    <span class="p">|</span>   &lt;- Code using IAnimal
</span></span><span class="line"><span class="cl">       <span class="p">|</span>----------------------<span class="p">|</span>
</span></span><span class="line"><span class="cl">       <span class="p">|</span> Play<span class="o">(</span>IAnimal animal<span class="o">)</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">       +----------------------+
</span></span><span class="line"><span class="cl">                 <span class="p">|</span>
</span></span><span class="line"><span class="cl">    +-------------------------------+
</span></span><span class="line"><span class="cl">    <span class="p">|</span> Works with ANY object that    <span class="p">|</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> implements IAnimanl <span class="o">(</span>myDog,   <span class="p">|</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> myCat, future animals, etc.<span class="o">)</span>  <span class="p">|</span>
</span></span><span class="line"><span class="cl">    +-------------------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Flow explanation:</strong></p>
<ol>
<li><code>IAnimal</code> defines the rules.</li>
<li><code>Dog</code> / <code>Cat</code> promise to follow them.</li>
<li><code>myDog</code> / <code>myCat</code> are <em>real</em> objects in memory created from those classes.</li>
<li><code>AnimalPlayground</code> can work with <strong>any</strong> object that implements <code>IAnimal</code> ‚Äî no matter what the actual class is.</li>
</ol>
<hr>
<h3 id="interface-example"><strong>Interface Example</strong><a hidden class="anchor" aria-hidden="true" href="#interface-example">#</a></h3>
<p>If we have an interface <code>IAnimal</code> that says:</p>
<ul>
<li>‚ÄúYou must have a <code>property</code> Legs‚Äù</li>
<li>‚ÄúYou must have a <code>property</code> Name‚Äù</li>
<li>‚ÄúYou must have a <code>method</code> <code>MakeNoise()</code>‚Äù
Then any class implementing <code>IAnimal</code> must include all of those members.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Pseudo Code</span>
</span></span><span class="line"><span class="cl"><span class="n">IAnimal</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">Legs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">Name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">void</span> <span class="n">MakeNoise</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once a class implements an interface:</p>
<ul>
<li>You write the actual code for the <code>methods</code> in that <code>class</code>.</li>
<li>You can <code>set</code> the starting <code>values</code> for the interface‚Äôs <code>properties</code>.</li>
<li>You can define the <code>behavior</code> of each <code>method</code> however you want.</li>
</ul>
<p>This is why interfaces are considered abstract ‚Äî they don‚Äôt tell you how to do something, only that you must have it.</p>
<p>They‚Äôre a way to guide multiple classes to share the same ‚Äútemplate‚Äù of members while letting each class have its own unique implementation.</p>
<h3 id="using-an-interface-examplecs"><strong>Using an Interface Example.cs</strong><a hidden class="anchor" aria-hidden="true" href="#using-an-interface-examplecs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Class that implements the IAnimal interface</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">Dog</span> <span class="p">:</span> <span class="n">IAnimal</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">int</span> <span class="n">Legs</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="m">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="s">&#34;Dog&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">MakeNoise</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Woof!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Explanation:</p>
<ul>
<li>The Dog class implements <code>IAnimal</code>.</li>
<li>The <code>Legs</code> and <code>Name</code> <code>properties</code> are given real values.</li>
<li>The <code>MakeNoise()</code> <code>method</code> is given actual <code>behavior</code> (printing &ldquo;Woof!&rdquo;).</li>
<li>You can implement more than one <code>interface</code> in a single <code>class</code>.</li>
<li>By convention, <code>interface</code> <code>names</code> start with <code>I</code> (e.g., <code>IAnimal</code>, <code>IExternalCommand</code>).</li>
</ul>
<h3 id="argument-provision"><strong>Argument Provision</strong><a hidden class="anchor" aria-hidden="true" href="#argument-provision">#</a></h3>
<p>Many interfaces in the <strong>Revit API</strong> come with extra built-in support.</p>
<p>For example:</p>
<ul>
<li>Some interfaces include <strong><code>methods</code> that are automatically called</strong> when certain events happen (e.g., a <code>command starts</code>, the <code>application opens</code>, or a <code>document changes</code>).</li>
<li>When you implement such an interface, you <code>don‚Äôt have to</code> set up the event wiring yourself ‚Äî Revit will call the method for you.</li>
<li><code>Your job</code> is simply to <strong>write the code that runs when the event occurs</strong>.</li>
</ul>
<blockquote>
<p>üí° <em>Think of it like Revit saying: ‚ÄúWhen this happens, I‚Äôll call your method. Just tell me what you want to do inside it.‚Äù</em></p></blockquote>
<h2 id="application-variants">Application Variants<a hidden class="anchor" aria-hidden="true" href="#application-variants">#</a></h2>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>UIControlledApplication</code></td>
          <td>Provides access to the Revit application, typically used on <code>startup</code> and <code>shutdown</code> when no document is yet available.</td>
      </tr>
      <tr>
          <td><code>ControlledApplication</code></td>
          <td>Represents the application service, giving access to documents, options, and application-specific settings (e.g., <code>language</code>).</td>
      </tr>
      <tr>
          <td><code>UIApplication</code></td>
          <td>Similar to <code>UIControlledApplication</code>, but available during a running session. We‚Äôll use this often, and in a future lesson we‚Äôll register it as a globally accessible variable.</td>
      </tr>
      <tr>
          <td><code>UIDocument</code></td>
          <td>Represents the current document at the UI level, giving access to things like selections and opened views.</td>
      </tr>
      <tr>
          <td><code>Document</code></td>
          <td>Represents the current document at the core API level, providing access to Revit API <code>classes</code>, <code>methods</code>, and <code>properties</code> (e.g., collecting elements).</td>
      </tr>
  </tbody>
</table>
<h3 id="how-we-can-access-them">How we can access them?<a hidden class="anchor" aria-hidden="true" href="#how-we-can-access-them">#</a></h3>
<p>These objects are related in a <code>cascading hierarchy</code> ‚Äî you can get one from another:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">;</span>         <span class="c1">// Available at startup/shutdown</span>
</span></span><span class="line"><span class="cl"><span class="n">ControlledApplication</span> <span class="n">ctlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">ControlledApplication</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">UIApplication</span> <span class="n">uiApp</span><span class="p">;</span>                      <span class="c1">// Available in commands/events</span>
</span></span><span class="line"><span class="cl"><span class="n">UIDocument</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>            <span class="c1">// The main Revit document API</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>üí° <em>Tip:</em> At <code>startup</code>/<code>shutdown</code> you‚Äôll usually have <code>UIControlledApplication</code>.<br>
üí° <em>Tip:</em> During a <code>command</code> / <code>event</code>, you‚Äôll start with <code>UIApplication</code>.</p></blockquote>
<h2 id="homework-4">Homework<a hidden class="anchor" aria-hidden="true" href="#homework-4">#</a></h2>
<ul>
<li>Implement <em><code>IExternalApplication</code></em></li>
<li>Implement <em><code>IExternalCommand</code></em></li>
<li>Collect the <em><code>ControlledApplication</code></em> in your application entry point</li>
<li>Collect the <em><code>Document</code></em> inside your command</li>
</ul>
<h2 id="solution-4"><strong>Solution</strong><a hidden class="anchor" aria-hidden="true" href="#solution-4">#</a></h2>
<h3 id="step-1--learn-the-interface-requirements"><strong>Step 1 ‚Äî Learn the interface requirements</strong><a hidden class="anchor" aria-hidden="true" href="#step-1--learn-the-interface-requirements">#</a></h3>
<p>Go to <a href="https://www.revitapidocs.com/2024/d893b9a7-6f3e-bf1f-f4d6-5fbc269544bb.htm">revitapidocs.com</a>.</p>
<p>You‚Äôll see that <code>IExternalApplication</code> defines <code>two</code> <code>methods</code> you must implement:</p>
<ol>
<li><code>OnStartup</code>(<code>UIControlledApplication</code> application) ‚Äî runs when Revit starts.</li>
<li><code>OnShutdown</code>(<code>UIControlledApplication</code> application) ‚Äî runs when Revit shuts down.</li>
</ol>
<p>Both methods must return a <strong>Result</strong> <code>enum</code>:</p>
<ul>
<li><code>Result.Succeeded</code> ‚Äî startup/shutdown completed successfully.</li>
<li><code>Result.Cancelled</code> ‚Äî you want to cancel the process.</li>
<li><code>Result.Failed</code> ‚Äî something went wrong.</li>
</ul>
<hr>
<h3 id="step-2--understand-the"><strong>Step 2 ‚Äî Understand the <code>parameters</code></strong><a hidden class="anchor" aria-hidden="true" href="#step-2--understand-the">#</a></h3>
<p>When <code>OnStartup()</code> or <code>OnShutdown()</code> runs, Revit passes you a <code>UIControlledApplication</code> object.</p>
<p>From this you can get:</p>
<ul>
<li><code>ControlledApplication</code> ‚Üí <code>uiCtlApp.ControlledApplication</code>
<ul>
<li>Gives access to application-level <code>settings</code>, documents <code>list</code>, Revit <code>version</code> info, <code>language</code>, etc.</li>
</ul>
</li>
<li><code>Ribbon</code> and <code>UI</code> setup methods (you can add <code>panels</code> and <code>buttons</code> here).</li>
</ul>
<hr>
<h3 id="step-3--implementation-in"><strong>Step 3 ‚Äî Implementation in <code>Application.cs</code></strong><a hidden class="anchor" aria-hidden="true" href="#step-3--implementation-in">#</a></h3>
<h3 id="applicationcs"><code>Application.cs</code><a hidden class="anchor" aria-hidden="true" href="#applicationcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// This application belongs to the root namespace</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Implementing the interface for application.cs class</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">Application</span><span class="p">:</span> <span class="n">IExternalApplication</span> 
</span></span><span class="line"><span class="cl">	<span class="c1">// IExternalApplication for the interface</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">//This will return a result on Startup method - requires uiCtlApp</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">ctlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">ControlledApplication</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span> <span class="c1">// or Cancelled</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// This will urn on shutdown</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">OnShutdown</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="project-solution">Project Solution<a hidden class="anchor" aria-hidden="true" href="#project-solution">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">Solution</span>
</span></span><span class="line"><span class="cl"><span class="p">|-&gt;</span> <span class="n">guRoo</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Dependencies</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Commands</span>
</span></span><span class="line"><span class="cl">		<span class="p">|-&gt;</span> <span class="n">General</span> <span class="c1">// Create a Ribbon Panel Folder</span>
</span></span><span class="line"><span class="cl">			<span class="p">|-&gt;</span> <span class="n">Cmds_General</span><span class="p">.</span><span class="n">cs</span> <span class="c1">// Create a Ribbon Panel</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Forms</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Resources</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Application</span><span class="p">.</span><span class="n">cs</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">addin</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmds_generalcs"><code>Cmds_General.cs</code><a hidden class="anchor" aria-hidden="true" href="#cmds_generalcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Cmds_General</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">	[Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Test</span><span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIApplication</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">commandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIDocument</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Code logic here:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Final return here:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">	[Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Test2</span><span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIApplication</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">commandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIDocument</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Code logic here:</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Final return here:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Typically, when working with interfaces you start with collecting information from your Revit document.</li>
</ul>
<p><strong>We now have a basic understanding of:</strong></p>
<ul>
<li><code>Interfaces</code></li>
<li><code>IExternalApplication</code></li>
<li><code>IExternalCommand</code></li>
<li><code>Application</code> Classes</li>
<li><code>Document</code> Classes</li>
</ul>
<h1 id="7-create-a-pushbutton">7. Create a <code>PushButton</code><a hidden class="anchor" aria-hidden="true" href="#7-create-a-pushbutton">#</a></h1>
<p>Now we‚Äôll set up a button in Revit‚Äôs ribbon to run our command.</p>
<p>We‚Äôve done something similar before, but this time we‚Äôll follow the <strong>standard Revit API approach</strong> instead of the Nice3point method.</p>
<p><strong>We‚Äôll create:</strong></p>
<ul>
<li><code>RibbonTab</code></li>
<li><code>RibbonPanel</code></li>
<li><code>PushButton</code></li>
<li><code>Command</code></li>
</ul>
<h2 id="understanding-the-terms"><strong>Understanding the Terms</strong><a hidden class="anchor" aria-hidden="true" href="#understanding-the-terms">#</a></h2>
<ol>
<li>
<p><code>RibbonTab</code> ‚Äì A top-level tab in the Revit ribbon interface. Each RibbonTab groups related functionality and contains one or more RibbonPanels. For example, the ‚ÄúAnnotate‚Äù tab contains tools related to dimensions, text, and tags.</p>
</li>
<li>
<p><code>RibbonPanel</code> ‚Äì A container within a RibbonTab that holds one or more buttons. Panels help organize commands visually and logically within a tab. For instance, the ‚ÄúText‚Äù panel inside the ‚ÄúAnnotate‚Äù tab might contain buttons for adding text, leaders, and notes.</p>
</li>
<li>
<p><code>PushButton</code> ‚Äì A clickable button (or a pull-down button with multiple options) that executes a specific Command. There are several related button types in the Revit API:</p>
<ul>
<li>
<p><code>PulldownButton</code> ‚Äì Displays a drop-down list of other buttons or commands when clicked.</p>
</li>
<li>
<p><code>PushButton</code> ‚Äì The most common button type. To create one in an add-in, you first create a PushButtonData object to define its properties (name, tooltip, images, and linked command), then add it to a RibbonPanel with RibbonPanel.AddItem(), which returns a PushButton object.</p>
</li>
<li>
<p><code>RadioButton</code> ‚Äì Allows users to select one option from a set. When placed in a group, selecting one radio button automatically deselects the others.</p>
</li>
<li>
<p><code>SplitButton</code> ‚Äì Combines a PushButton with a PulldownButton. The top half performs a default action, while the bottom half opens a list of related actions.</p>
</li>
<li>
<p><code>ToggleButton</code> ‚Äì Acts like an on/off switch. It maintains its state after being clicked, making it useful for settings that need to stay enabled or disabled until changed again.</p>
</li>
</ul>
</li>
<li>
<p><code>Command</code> ‚Äì The underlying logic that executes when a button is pressed. In Revit API development, a Command is typically implemented as a class that implements IExternalCommand, containing the Execute() method where your code runs.</p>
</li>
</ol>
<h2 id="properties-of-a-pushbutton">Properties of a <code>PushButton</code><a hidden class="anchor" aria-hidden="true" href="#properties-of-a-pushbutton">#</a></h2>
<table>
  <thead>
      <tr>
          <th><strong>Property</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>AssemblyName</code></td>
          <td>Assembly path of the button.</td>
      </tr>
      <tr>
          <td><code>AvailabilityClassName</code></td>
          <td>The full class name of the class providing the entry point to decide availability of this push button.</td>
      </tr>
      <tr>
          <td><code>ClassName</code></td>
          <td>The name of the class containing the implementation for the command.</td>
      </tr>
      <tr>
          <td><code>Enabled</code></td>
          <td>Gets or sets a value indicating whether the item is enabled.</td>
      </tr>
      <tr>
          <td><code>Image</code></td>
          <td>The image of the button.</td>
      </tr>
      <tr>
          <td><code>IsEnabledByContext</code></td>
          <td>Indicates if this button can be executed. <code>True</code> if permitted based on the current Revit context (active doc, active view, active tool). <code>False</code> if disabled because of the active context.</td>
      </tr>
      <tr>
          <td><code>ItemText</code></td>
          <td>Gets or sets the text displayed on the item.</td>
      </tr>
      <tr>
          <td><code>ItemType</code></td>
          <td>Gets the item type.</td>
      </tr>
      <tr>
          <td><code>LargeImage</code></td>
          <td>The large image shown on the button.</td>
      </tr>
      <tr>
          <td><code>LongDescription</code></td>
          <td>Long description of the command tooltip.</td>
      </tr>
      <tr>
          <td><code>Name</code></td>
          <td>The name of the item.</td>
      </tr>
      <tr>
          <td><code>ToolTip</code></td>
          <td>The description that appears as a tooltip for the item.</td>
      </tr>
      <tr>
          <td><code>ToolTipImage</code></td>
          <td>The image to show as part of the button‚Äôs extended tooltip.</td>
      </tr>
      <tr>
          <td><code>Visible</code></td>
          <td>Gets or sets a value indicating whether the item is visible.</td>
      </tr>
  </tbody>
</table>
<h2 id="step-by-step">Step-by-step:<a hidden class="anchor" aria-hidden="true" href="#step-by-step">#</a></h2>
<ol>
<li>Create a <code>Tab</code></li>
<li>Add a <code>RibbonPanel</code> to the <code>Tab</code></li>
<li>Add a <code>PushButton</code> to the <code>RibbonPanel</code></li>
</ol>
<h3 id="related-api-classes"><em>Related API Classes:</em><a hidden class="anchor" aria-hidden="true" href="#related-api-classes">#</a></h3>
<ol>
<li><code>UIControlledApplication</code> &gt; <code>GetRibbonPannels</code> Method &gt; <code>Tab</code></li>
<li><code>Tab</code> &gt; <code>RibbonPannel</code> &gt; <code>AddItem</code> Method</li>
<li><code>RibbonPanel</code> &gt; <code>PushButtonData</code> Constructor &gt; <code>PushButton</code> Object &gt; Icon / Tooltip</li>
</ol>
<h3 id="one-important-method--"><strong>One Important Method -&gt; <code>GetRibbonPanels</code> :</strong><a hidden class="anchor" aria-hidden="true" href="#one-important-method--">#</a></h3>
<ol>
<li><code>GetRibbonPannels</code> - Get all the custom Panels on Add-Ins Tab of Revit.</li>
<li><code>GetRibbonPannels</code>(String) - Get all the custom Panels on a designated Revit Tab.</li>
<li><code>GetRibbonPannel</code>(Tab) - Get all the custom Panels on a designated standard Revit Tab.</li>
</ol>
<h3 id="executing-assembly">Executing Assembly<a hidden class="anchor" aria-hidden="true" href="#executing-assembly">#</a></h3>
<ul>
<li>When our add-in is running, all the classes, resources and code we have produced are executed as an Assembly. We will access this to connect commands to buttons.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Reflection</span>
</span></span><span class="line"><span class="cl"><span class="n">Assembly</span><span class="p">.</span><span class="n">GetExecutingAssembly</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="homework-5">Homework<a hidden class="anchor" aria-hidden="true" href="#homework-5">#</a></h2>
<ol>
<li>Create a <code>static</code> utility class</li>
<li>Add <code>methods</code> to <code>static</code> utility class that we need</li>
<li>Run these <code>methods</code> in <code>OnStartup</code> method</li>
</ol>
<h2 id="solution-5">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-5">#</a></h2>
<h3 id="project-solution-1"><code>Project Solution</code><a hidden class="anchor" aria-hidden="true" href="#project-solution-1">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">Solution</span>
</span></span><span class="line"><span class="cl"><span class="p">|-&gt;</span> <span class="n">guRoo</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Dependencies</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Commands</span>
</span></span><span class="line"><span class="cl">		<span class="p">|-&gt;</span> <span class="n">General</span> <span class="c1">// Create a Ribbon Panel Folder</span>
</span></span><span class="line"><span class="cl">			<span class="p">|-&gt;</span> <span class="n">Cmds_General</span><span class="p">.</span><span class="n">cs</span> <span class="c1">// Create a Ribbon Panel</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Forms</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Resources</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Utilities</span> <span class="c1">// Add a New Utilities Folder</span>
</span></span><span class="line"><span class="cl">		<span class="p">|-&gt;</span> <span class="n">Ribbon_Utils</span><span class="p">.</span><span class="n">cs</span> <span class="c1">// Add a New Ribbon Utilities Class</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Application</span><span class="p">.</span><span class="n">cs</span> <span class="c1">// Update Application Class</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">addin</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ribbon_utilscs"><code>Ribbon_Utils.cs</code><a hidden class="anchor" aria-hidden="true" href="#ribbon_utilscs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Task</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Utilities</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Ribbon_Utils</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to create a &#34;Tab&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">Result</span> <span class="n">AddRibbonTab</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">,</span> <span class="kt">string</span> <span class="n">tabName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">try</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">uiCtlApp</span><span class="p">.</span><span class="n">CreateRibbonTab</span><span class="p">(</span><span class="n">tabName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">catch</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Coulnd not create a tab: {tabName}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Failed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to create a &#34;Panel&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">RibbonPanel</span> <span class="n">AddRibbonPanelToTab</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">,</span> <span class="kt">string</span> <span class="n">tabName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">try</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">uiCtlApp</span><span class="p">.</span><span class="n">CreateRibbonPanel</span><span class="p">(</span><span class="n">tabName</span><span class="p">,</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">catch</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;Error: Could not add {panelName} to {tabName}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="n">GetRibbonPanelByName</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">,</span> <span class="n">tabName</span><span class="p">,</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to get that &#34;Panel&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">RibbonPannel</span> <span class="n">GetRibbonPanelByName</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">,</span> <span class="kt">string</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">panels</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">GetRibbonPanels</span><span class="p">(</span><span class="n">tabName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">panel</span> <span class="k">in</span> <span class="n">panels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="n">panel</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="n">panelName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="n">panel</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to create a &#34;Button&#34; to &#34;Panel&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// Fill this summary for Methods to be described on Mouse Hover.</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;panel&#34;&gt;This is the ribbonpannel to add to.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;buttonName&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;className&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;internalName&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;param name=&#34;assemblyPath&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">PushButton</span> <span class="n">AddPushButtonToPanel</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">			<span class="n">RibbonPanel</span> <span class="n">panel</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">buttonName</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">className</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">internalName</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">assemblyPath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="n">panel</span> <span class="k">is</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="err">$</span><span class="n">Error</span><span class="p">:</span> <span class="n">Could</span> <span class="n">not</span> <span class="n">create</span> <span class="p">{</span><span class="n">buttonName</span><span class="p">}.)</span>
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// Open PushButtonData Constructor and check what&#39;s needed</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">				<span class="kt">var</span> <span class="n">pushButtonData</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PushButtonData</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">					<span class="n">internalName</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">					<span class="n">buttonName</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">					<span class="n">assemblyPath</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">					<span class="n">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="n">panel</span><span class="p">.</span><span class="n">AddItem</span><span class="p">(</span><span class="n">pushButtonData</span><span class="p">)</span> <span class="k">is</span> <span class="n">PushButton</span> <span class="n">pushButton</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="n">pushButton</span><span class="p">.</span><span class="n">ToolTip</span> <span class="p">=</span> <span class="s">&#34;Testing tooltip&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="c1">// pushButton.Image = null;</span>
</span></span><span class="line"><span class="cl">					<span class="c1">// pushButton.LargeImage = null;</span>
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="n">pushButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="k">else</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="n">Debug</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;$Error: Could not create {buttonName}.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="applicationcs-1"><code>Application.cs</code><a hidden class="anchor" aria-hidden="true" href="#applicationcs-1">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// System</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Reflection</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// guRoo</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gRib</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Ribbon_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// This application belongs to the root namespace</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Implementing the interface for application.cs class</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">Application</span><span class="p">:</span> <span class="n">IExternalApplication</span> 
</span></span><span class="line"><span class="cl">	<span class="c1">// IExternalApplication for the interface</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">//This will return a result on Startup method - requires uiCtlApp</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// Collect the controlled application:</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">ctlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">ControlledApplication</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">assembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="n">GetExecutingAssembly</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">avr</span> <span class="n">assemblyPath</span> <span class="p">=</span> <span class="n">assembly</span><span class="p">.</span><span class="n">Location</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Variables</span>
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">tabName</span> <span class="p">=</span> <span class="s">&#34;guRoo&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Add RibbonTab</span>
</span></span><span class="line"><span class="cl">			<span class="n">gRib</span><span class="p">.</span><span class="n">AddRibbonTab</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">,</span> <span class="n">tabName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Create RibbonPanel</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">panelGeneral</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">AddRibbonPanelToTab</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">												<span class="n">uiCtlApp</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">												<span class="n">tabName</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">												<span class="s">&#34;General&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Add PushButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">buttonTest</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">AddPushButtonToPanel</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">												<span class="n">panelGeneral</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">												<span class="s">&#34;Testing&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">												<span class="s">&#34;guRoo.Cmds_General.Cmd_Test&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">												<span class="n">assemblyPath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Final return:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span> <span class="c1">// or Cancelled</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// This will urn on shutdown</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">OnShutdown</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmds_generalcs-1"><code>Cmds_General.cs</code><a hidden class="anchor" aria-hidden="true" href="#cmds_generalcs-1">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Cmds_General</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">	[Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Test</span><span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIApplication</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">commandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIDocument</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Code logic here:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Final return here:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="cs">///		Example Command</span>
</span></span><span class="line"><span class="cl">	<span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">	[Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Test2</span><span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">CommandData</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIApplication</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">commandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">UIDocument</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Code logic here:</span>
</span></span><span class="line"><span class="cl">			<span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;It&#39;s Working!&#34;</span><span class="p">,</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Final return here:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="8-global-variables">8. <code>Global</code> Variables<a hidden class="anchor" aria-hidden="true" href="#8-global-variables">#</a></h1>
<p>Some programming languages support &lsquo;<code>global</code>&rsquo; variables, which can be accessed anywhere at any time once set in the project.</p>
<p>To my knowledge, C# does not have a dedicated system for this. We can still achieve this by utilizing a static class that is dedicated to storing and providing these.</p>
<ul>
<li>Let&rsquo;s set up a Globals Class, which will give us access to objects that would otherwise be inaccessible from various areas of our project.</li>
<li>We will also look at how we can use an event to capture the <code>UIApplication</code>.</li>
</ul>
<h2 id="why-cant-we-get-the-uiapp">Why can&rsquo;t we get the <code>UiApp</code>?<a hidden class="anchor" aria-hidden="true" href="#why-cant-we-get-the-uiapp">#</a></h2>
<p>We will collect most variables on startup, but the <code>UiApplication</code> is not available during this time in Revit. In order to collect it we will take advantage of the <code>Idling Event</code>.</p>
<h3 id="events-101"><code>Events</code> 101<a hidden class="anchor" aria-hidden="true" href="#events-101">#</a></h3>
<ol>
<li>Events provide us the ability to have code that executes when various events occur in an application. For example, run a code whenever the view is changed.</li>
<li>When Revit is available, it is said to be <strong><code>Idling</code></strong> (not doing anything). The <code>Idling event</code> is commonly used to run some code as soon as Revit is available for code to be run.</li>
</ol>
<h3 id="basic-subunsub-syntax">Basic <code>Sub</code>/<code>Unsub</code> syntax<a hidden class="anchor" aria-hidden="true" href="#basic-subunsub-syntax">#</a></h3>
<p>Subscribe to <code>Idling</code> event
<code>UICtlApp.Idling += MethodName</code></p>
<p>Unsubscribe from <code>idling</code> event
<code>UICtlApp.Idling -= MethodName</code></p>
<p><em>In most cases, you will want your method to unsubscribe itself once it has run.</em></p>
<h2 id="homework-6">Homework<a hidden class="anchor" aria-hidden="true" href="#homework-6">#</a></h2>
<ol>
<li>Create a <code>static</code> <code>Globals</code> Class</li>
<li>Add <code>properties</code> and <code>registration</code> method</li>
<li>Register the <code>UiApp</code> and Revit User Name using <code>IdlingEvent</code></li>
</ol>
<h2 id="solution-6">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-6">#</a></h2>
<h3 id="project-solution-2"><code>Project Solution</code><a hidden class="anchor" aria-hidden="true" href="#project-solution-2">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">Solution</span>
</span></span><span class="line"><span class="cl"><span class="p">|-&gt;</span> <span class="n">guRoo</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Dependencies</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Commands</span>
</span></span><span class="line"><span class="cl">		<span class="p">|-&gt;</span> <span class="n">General</span> 
</span></span><span class="line"><span class="cl">			<span class="p">|-&gt;</span> <span class="n">Cmds_General</span><span class="p">.</span><span class="n">cs</span> 
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Forms</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">General</span> <span class="c1">// Add a New General Folder</span>
</span></span><span class="line"><span class="cl">		<span class="p">|-&gt;</span> <span class="n">Globals</span><span class="p">.</span><span class="n">cs</span> <span class="c1">// Add a New Globals Class</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Resources</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Utilities</span>
</span></span><span class="line"><span class="cl">		<span class="p">|-&gt;</span> <span class="n">Ribbon_Utils</span><span class="p">.</span><span class="n">cs</span> 
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">Application</span><span class="p">.</span><span class="n">cs</span> <span class="c1">// Updated</span>
</span></span><span class="line"><span class="cl">	<span class="p">|-&gt;</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">addin</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="globalscs"><code>Globals.cs</code><a hidden class="anchor" aria-hidden="true" href="#globalscs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collection.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Threading.Task</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Assembly</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">Assembly</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">Globals</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="cp">#region</span> <span class="n">Properties</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Applications</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">UIControlledApplication</span> <span class="n">UiCtlApp</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">ControlledApplication</span> <span class="n">CtlApp</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">UIApplication</span> <span class="n">UiApp</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Assembly</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="n">Assembly</span> <span class="n">Assembly</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span> <span class="c1">// Ambiguity or missing ref</span>
</span></span><span class="line"><span class="cl">		<span class="n">piblic</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AssemblyPath</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Revit Versions</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">RevitVersion</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">RevitVersionInt</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// User Names</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">UsernameRevit</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">UsernameWindows</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// GUIDs and Versioning</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AdddinVersionNumber</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AddinVersionName</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AddinName</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">AddinGuid</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#region</span> <span class="n">Register</span> <span class="n">Method</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Method to Register Variable Properties</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">RegisterProperties</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">UiCtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">CtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">ContrlledApplication</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// UiApp set on idling</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="n">Assembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="n">GetExecutingAssembly</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">AssemblyPath</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="n">Location</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="n">RevitVersion</span> <span class="p">=</span> <span class="n">CtlApp</span><span class="p">.</span><span class="n">VersionNumber</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">RevitVersionInt</span> <span class="p">=</span> <span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">RevitVersion</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Revit Username set to idling</span>
</span></span><span class="line"><span class="cl">			<span class="n">UsernameWindows</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">UserName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="n">AddinVersionNumber</span> <span class="p">=</span> <span class="s">&#34;25.08.12&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">AddinVersionName</span> <span class="p">=</span> <span class="s">&#34;WIP&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">AddinName</span> <span class="p">=</span> <span class="s">&#34;guRoo&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">AddinGuid</span> <span class="p">=</span> <span class="s">&#34;5FD7523B-5832-4AB8-9B3D-0BE7ACFE1207&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="applicationcs-2"><code>Application.cs</code><a hidden class="anchor" aria-hidden="true" href="#applicationcs-2">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// guRoo</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gRib</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Ribbon_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// This application belongs to the root namespace</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Implementing the interface for application.cs class</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">Application</span><span class="p">:</span> <span class="n">IExternalApplication</span> 
</span></span><span class="line"><span class="cl">	<span class="c1">// IExternalApplication for the interface</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Make a private uiCtlApp method:</span>
</span></span><span class="line"><span class="cl">		<span class="kd">private</span> <span class="kd">static</span> <span class="n">UIControlledApplication</span> <span class="n">_uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">//This will return a result on Startup method - requires uiCtlApp</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="cp">#region</span> <span class="n">Globals</span> <span class="n">registration</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// Store _uiCtlApp, register on idling</span>
</span></span><span class="line"><span class="cl">			<span class="n">_uiCtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">try</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">+=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">catch</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="n">Glovals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Register Globals</span>
</span></span><span class="line"><span class="cl">			<span class="n">Globals</span><span class="p">.</span><span class="n">RegisterProperties</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endregion</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#region</span> <span class="n">Removed</span> <span class="n">because</span> <span class="n">we</span> <span class="n">added</span> <span class="n">the</span> <span class="n">Global</span> <span class="n">Variables</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">			<span class="c1">// Collect the controlled application:</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// var ctlApp = uiCtlApp.ControlledApplication;</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// var assembly = Assembly.GetExecutingAssembly();</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// avr assemblyPath = assembly.Location;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Variables</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// string tabName = &#34;guRoo&#34;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#region</span> <span class="n">Ribbon</span> <span class="n">setup</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// Add RibbonTab</span>
</span></span><span class="line"><span class="cl">			<span class="n">gRib</span><span class="p">.</span><span class="n">AddRibbonTab</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">,</span> <span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">);</span> <span class="c1">// instead of TabName</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Create RibbonPanel</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">panelGeneral</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">AddRibbonPanelToTab</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">								<span class="n">uiCtlApp</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">,</span> <span class="c1">// instead of TabName</span>
</span></span><span class="line"><span class="cl">								<span class="s">&#34;General&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Add PushButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">			<span class="kt">var</span> <span class="n">buttonTest</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">AddPushButtonToPanel</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">								<span class="n">panelGeneral</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="s">&#34;Testing&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">								<span class="s">&#34;guRoo.Cmds_General.Cmd_Test&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">								<span class="n">Globals</span><span class="p">.</span><span class="n">AssemblyPath</span><span class="p">)</span> <span class="c1">// instead of assemblyPath</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Final return:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span> <span class="c1">// or Cancelled</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#region</span> <span class="n">On</span> <span class="n">shutdown</span> <span class="n">method</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// This will urn on shutdown</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="n">Result</span> <span class="n">OnShutdown</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#region</span> <span class="n">Use</span> <span class="n">idling</span> <span class="n">to</span> <span class="n">register</span> <span class="n">UiApp</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// On idling, register UiApp/username</span>
</span></span><span class="line"><span class="cl">		<span class="kd">private</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">RegisterUiApp</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">IdlingEvenArgs</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">-=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">sender</span> <span class="k">is</span> <span class="n">UIApplication</span> <span class="n">uiApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="n">Globals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Ambiguity - is when Windows API and Revit API has the same class name like <code>Assembly</code>
<ul>
<li><code>using Assembly = System.Reflection.Assembly;</code> - this is how to remove <code>Ambiguity</code>.</li>
</ul>
</li>
<li><code>#region</code> &amp; <code>#endregion</code> let&rsquo;s you organize the code - collapses long paragraphs of code to be able to skim the logic.</li>
</ul>
<blockquote>
<p>These tutorials were inspired by the work of <a href="https://www.youtube.com/@AussieBIMGuru">Aussie BIM Guru</a>. If you‚Äôre looking for a deeper dive into the topics, check out his channel for detailed explanations.</p></blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/c%23/">C#</a></li>
      <li><a href="http://localhost:1313/tags/revit/">Revit</a></li>
      <li><a href="http://localhost:1313/tags/tutorial/">Tutorial</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/lesson-8/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>C# &#43; Revit API: Lesson 8 - Tooltips &amp; Icons</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/lesson-6/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>C# &#43; Revit API: Lesson 6 - try &amp; catch Statements</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>¬© 2025 AYDrafting. All rights reserved.</span> ¬∑ 

    <span>
        Powered by
        <a href="https://aydrafting.com/" rel="noopener noreferrer" target="_blank">AYDrafting</a> &
        <a href="https://github.com/aydimir95/" rel="noopener" target="_blank">GitHub</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
