<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>C# + Revit API: Lesson 9 - Static vs. Extension Methods | Blog</title><meta name=keywords content="C#,Revit,Tutorial"><meta name=description content='

1
2
3
4


modifiers returnType Method(this extendedType, args)
{
	coding logic;
}


So far, we have been using static utility classes to store common methods to call upon. Alternatively, we can use Extension Methods to:

Make the code readable.
To let you Add methods to existing types.

They provide syntactic sugar (a nicer way to write code), so calls look like instance methods:





1
2


string x = "hello";
string y = x.Reverse();  // Looks built-in, but it&#39;s actually an extension



if Reverse was written as a static utility method instead of an extension, it might look like this:'><meta name=author content><link rel=canonical href=https://blog.aydrafting.com/posts/post-9/><link crossorigin=anonymous href=/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css integrity="sha256-bVhUcqQJqPUE5r+Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.aydrafting.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.aydrafting.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.aydrafting.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.aydrafting.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.aydrafting.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.aydrafting.com/posts/post-9/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.aydrafting.com/posts/post-9/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="C# + Revit API: Lesson 9 - Static vs. Extension Methods"><meta property="og:description" content=' 1 2 3 4 modifiers returnType Method(this extendedType, args) { coding logic; } So far, we have been using static utility classes to store common methods to call upon. Alternatively, we can use Extension Methods to:
Make the code readable. To let you Add methods to existing types. They provide syntactic sugar (a nicer way to write code), so calls look like instance methods: 1 2 string x = "hello"; string y = x.Reverse(); // Looks built-in, but it&#39;s actually an extension if Reverse was written as a static utility method instead of an extension, it might look like this:'><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-08T13:53:29+03:00"><meta property="article:modified_time" content="2025-08-08T13:53:29+03:00"><meta property="article:tag" content="C#"><meta property="article:tag" content="Revit"><meta property="article:tag" content="Tutorial"><meta property="og:image" content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.aydrafting.com/LogoAYD.png"><meta name=twitter:title content="C# + Revit API: Lesson 9 - Static vs. Extension Methods"><meta name=twitter:description content='

1
2
3
4


modifiers returnType Method(this extendedType, args)
{
	coding logic;
}


So far, we have been using static utility classes to store common methods to call upon. Alternatively, we can use Extension Methods to:

Make the code readable.
To let you Add methods to existing types.

They provide syntactic sugar (a nicer way to write code), so calls look like instance methods:





1
2


string x = "hello";
string y = x.Reverse();  // Looks built-in, but it&#39;s actually an extension



if Reverse was written as a static utility method instead of an extension, it might look like this:'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.aydrafting.com/posts/"},{"@type":"ListItem","position":2,"name":"C# + Revit API: Lesson 9 - Static vs. Extension Methods","item":"https://blog.aydrafting.com/posts/post-9/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"C# + Revit API: Lesson 9 - Static vs. Extension Methods","name":"C# \u002b Revit API: Lesson 9 - Static vs. Extension Methods","description":" 1 2 3 4 modifiers returnType Method(this extendedType, args) { coding logic; } So far, we have been using static utility classes to store common methods to call upon. Alternatively, we can use Extension Methods to:\nMake the code readable. To let you Add methods to existing types. They provide syntactic sugar (a nicer way to write code), so calls look like instance methods: 1 2 string x = \u0026#34;hello\u0026#34;; string y = x.Reverse(); // Looks built-in, but it\u0026#39;s actually an extension if Reverse was written as a static utility method instead of an extension, it might look like this:\n","keywords":["C#","Revit","Tutorial"],"articleBody":" 1 2 3 4 modifiers returnType Method(this extendedType, args) { coding logic; } So far, we have been using static utility classes to store common methods to call upon. Alternatively, we can use Extension Methods to:\nMake the code readable. To let you Add methods to existing types. They provide syntactic sugar (a nicer way to write code), so calls look like instance methods: 1 2 string x = \"hello\"; string y = x.Reverse(); // Looks built-in, but it's actually an extension if Reverse was written as a static utility method instead of an extension, it might look like this:\nUtility method version 1 2 3 4 5 6 7 8 9 public static class StringUtils { public static string Reverse(string s) { char[] arr = s.ToCharArray(); Array.Reverse(arr); return new string(arr); } } Usage (static way):\n1 2 string x = \"hello\"; string y = StringUtils.Reverse(x); // \u003c-- utility call Extension Method version 1 2 3 4 5 6 7 8 9 public static class StringExtensions { public static string Reverse(this string s) // \"this\" turns it into an extension { char[] arr = s.ToCharArray(); Array.Reverse(arr); return new string(arr); } } Usage (extension way):\n1 2 3 4 using MyExtensions; // namespace with StringExtensions string x = \"hello\"; string y = x.Reverse(); // looks like built-in, but calls static method under the hood Key difference:\nStatic → StringUtils.Reverse(x) — always pass the value as an argument. Extension → x.Reverse() — looks like the method belongs to string, but it’s just compiler sugar for StringExtensions.Reverse(x). Microsoft’s Official Definition Extension members let you add methods to an existing type without subclassing, recompiling, or modifying its original code. These methods must be declared in a static class, using the this keyword on the first parameter to indicate the extended type. Example: LINQ methods like Where, Select, GroupBy are extension methods on IEnumerable. The idea in one picture Utility method = a tool on the shelf you call by name. MathUtils.IsEven(4) Extension method = the same tool glued onto the type so it reads like a built-in ability. 4.IsEven() Same logic, different syntax. Utility (plain function in a static class)\n1 2 3 4 5 6 7 public static class MathUtils { public static bool IsEven(int n) =\u003e n % 2 == 0; } // use bool a = MathUtils.IsEven(4); Extension (adds “instance-like” call to a type)\n1 2 3 4 5 6 7 8 9 10 namespace MyExtensions { public static class IntExtensions // class must be static { // method must be static; first param has `this` public static bool IsEven(this int n) =\u003e n % 2 == 0; } } Usage\n1 2 3 using MyExtensions; // import the namespace that contains IntExtensions bool b = 4.IsEven(); // now it reads like a built-in method C# Extension Methods vs Static Utilities — Cheat Sheet A one‑pager you can print and keep by your keyboard.\nThe 5‑second summary Static utility: call a function on a helper class. StringUtils.Reverse(x) Extension method: same function, but called like an instance. x.Reverse() Truth: x.Reverse() is compiler sugar for StringExtensions.Reverse(x). Static Utility Pattern 1 2 3 4 5 6 7 8 9 10 11 12 public static class StringUtils { public static string Reverse(string s) { var a = s.ToCharArray(); Array.Reverse(a); return new string(a); } } // Usage var y = StringUtils.Reverse(\"hello\"); Extension Method Pattern Rules:\nMethod lives in a static class Method itself is static First parameter has this and is the type you’re extending The namespace must be in scope via using 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 namespace MyExtensions { public static class StringExtensions { public static string Reverse(this string s) { var a = s.ToCharArray(); Array.Reverse(a); return new string(a); } } } // Usage (note the \"using\") using MyExtensions; var y = \"hello\".Reverse(); What the Compiler Actually Does 1 2 3 Your code: Desugared by compiler: --------- ---------------------------------- \"hello\".Reverse() ==\u003e StringExtensions.Reverse(\"hello\"); Lookup steps\nCheck receiver type (string) for an instance Reverse() → none. Search imported namespaces for static methods whose first param is this string. Pick best match (normal overload rules). Instance methods (if any) always win over extensions. When to Use Which Use static utility when:\nIt’s general‑purpose or spans many types (logging, parsing, config). You don’t want to pollute IntelliSense for common types. Use extension method when:\nThe behavior clearly “belongs” to a single type. You want fluent, chainable syntax (e.g., LINQ‑style pipelines). Gotchas (memorize these) Extensions don’t modify the type; they’re just syntax sugar. If the type later adds a real instance method with the same signature, the real one wins. Resolution uses the variable’s compile‑time type, not runtime. You must using the extension’s namespace, or it won’t be found. Keep extensions focused; too many can clutter IntelliSense. Minimal Working Example (copy/paste) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // StringExtensions.cs namespace MyExtensions { public static class StringExtensions { public static bool IsNullOrBlank(this string? s) =\u003e string.IsNullOrWhiteSpace(s); } } // Program.cs using System; using MyExtensions; class Program { static void Main() { string x = \" \"; Console.WriteLine(x.IsNullOrBlank()); // True } } Quick Troubleshooting CS1061: ‘Type’ does not contain a definition for ‘Foo’ → Missing using for the extension’s namespace or wrong this type. Ambiguous call → Multiple extensions in scope with same signature; qualify with full class name or remove one using. Not being called → A real instance method with same signature exists and shadows your extension. Mental Model (ASCII) 1 2 3 4 5 6 7 Caller Compiler Resolution ------ ------------------ x.Reverse() -\u003e 1) Check instance on string → none 2) Scan imported namespaces for static methods with first param: this string 3) Choose best match 4) Rewrite to StringExtensions.Reverse(x) utilities = toolbox; extensions = bolt‑on skills. Same logic, nicer syntax.\nExtension Method Naming 1 2 3 4 5 6 7 8 // Extension namespace guRoo.Extensions // Class file name guRoo\\Extentions\\ExtendedClass_Ext // Extension method Ext_MethodName Homework Extend your methods: Set up a new folder and namespace Set up 2 extension classes in your project Set up extension methods Modify some of our code to use the above Solution Code: Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e General |-\u003e Cmds_General.cs |-\u003e Forms |-\u003e General |-\u003e Globals.cs |-\u003e Extensions // Add a New Folder |-\u003e UIControlledApplicaiton_Ext.cs // Create a New Class |-\u003e |-\u003e Resources |-\u003e Files |-\u003e Tooltips.resx |-\u003e Icons |-\u003e Icons16 |-\u003e General_test16.png |-\u003e Icons32 |-\u003e General_test32.png |-\u003e Utilities |-\u003e Ribbon_Utils.cs |-\u003e Application.cs // Updated |-\u003e guRoo.addin Borrow an existing static method from Ribbon_Utils.cs and extend it: UIControlledApplicaiton_Ext.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 using Autodesk.Revit.UI; using System.Diagnostics; namespace guRoo.Extensions { public static class UIControlledApplication_Ext { public static Result AddRibbonTab(this UIControlledApplication uiCtlApp, string tabName) { try { // Try to add a tab: uiCtlApp.CreateRibbonTab(tabName); return Result.Succeeded; } catch { // Report the error if it fails: Debug.WriteLine($\"Error: Could not create a tab: {tabName}\"); return Result.Failed; } } } } Update Applications.cs: Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 // Autodesk using Autodesk.Revit.UI; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; namespace guRoo { public class Application : IExternalApplication { private static UIControlledApplication _uiCtlApp; public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } Globals.RegisterProperties(uiCtlApp); Globals.RegisterTooltips(\"guRoo.Resources.Files.Tooltips\"); #endregion // =====Updated Part 1 Start===== #region Ribbon setup //Add Ribbon Tab uiCtlApp.AddRibbonTab(Globals.AddinName); // Create a Panel var panelGeneral = gRib.AddRibbonPanelToTab(uiCtlApp, Globals.AddinName, \"General\"); // Add Button to Panel var buttonTest = gRib.AddPushButtonToPanel(panelGeneral, \"Testing\", \"guRoo.Cmds_General.Cmd_Test\"); #endregion // Final Return return Result.Succeeded; } // =====Updated Part 1 End===== #region On shutdown method public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } And remove that part from Ribbon_Utils.cs: Ribbon_Utils.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 using Autodesk.Revit.UI; using System.Diagnostics; namespace guRoo.Utilities { public static class Ribbon_Utils { // =====REMOVE THIS PART 1===== // Method to create a \"Tab\" // public static Result AddRibbonTab(UIControlledApplication uiCtlApp,string tabName) // { // try // { // uiCtlApp.CreateRibbonTab(tabName); // return Result.Succeeded; // } // catch // { // Debug.WriteLine($\"Error: Could not create a tab: {tabName}\"); // return Result.Failed; // } // } // =====REMOVE THIS PART 1===== // =====REMOVE THIS PART 2===== // Method to create a \"Panel\" public static RibbonPanel AddRibbonPanelToTab(UIControlledApplication uiCtlApp, string tabName, string panelName) { try { uiCtlApp.CreateRibbonPanel(tabName, panelName); } catch { Debug.WriteLine($\"Error: Could not add {panelName} to {tabName}\"); return null; } return GetRibbonPanelByName(uiCtlApp, tabName, panelName); } // Method to get that \"Panel\" public static RibbonPanel GetRibbonPanelByName(UIControlledApplication uiCtlApp, string tabName, string panelName) { var panels = uiCtlApp.GetRibbonPanels(tabName); foreach (var panel in panels) { if (panel.Name == panelName) return panel; } // If Not found return null; } // =====REMOVE THIS PART 2===== // Method to create a \"Button\" to \"Panel\" /// /// Fill this summary for Methods to be described on Mouse Hover. /// /// This is the RibbonPanel to add to. /// Test /// Test /// Test /// Test /// public static PushButton AddPushButtonToPanel(RibbonPanel panel, string buttonName, string className) // string internalName, -\u003e NOT NEEDED ANYMORE // string assemblyPath)-\u003e NOT NEEDED ANYMORE { if (panel is null) { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } // Open PushButtonData Constructor and check what's needed // Get the base name from below var baseName = CommandToBaseName(className); // Create a PushButtonData object: var pushButtonData = new PushButtonData(baseName, buttonName, Globals.AssemblyPath, className); // if the button was made - return it: if (panel.AddItem(pushButtonData) is PushButton pushButton) { pushButton.ToolTip = LookupTooltip(baseName); // We will come back to this: pushButton.Image = GetIcon(baseName, resolution: 16); pushButton.LargeImage = GetIcon(baseName, resolution: 32); return pushButton; } else { Debug.WriteLine($\"Error: Could not create {buttonName}.\"); return null; } } // Method to get the base name of a command: public static string CommandToBaseName(string commandName) { return commandName.Replace(\"guRoo.Cmds_\", \"\").Replace(\".Cmd\", \"\"); } // Method to get a value from a dictionary key public static string LookupTooltip(string key, string failValue = null) { failValue ??= \"No tooltip value was found.\"; // ??= -\u003e if this is null set it to the following if (Globals.Tooltips.TryGetValue(key, out string value)) { return value; } return failValue; } // Method to get an icon as an image source public static ImageSource GetIcon(string baseName, int resolution = 32) { var resourcePath = $\"guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png\"; using (var stream = Globals.Assembly.GetManifestResourceStream(resourcePath)) { if (stream is null) { return null; } var decoder = new PngBitmapDecoder( stream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); if (decoder.Frames.Count \u003e 0) { return decoder.Frames.First(); } else { return null; } } } } } ","wordCount":"2042","inLanguage":"en","image":"https://blog.aydrafting.com/LogoAYD.png","datePublished":"2025-08-08T13:53:29+03:00","dateModified":"2025-08-08T13:53:29+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.aydrafting.com/posts/post-9/"},"publisher":{"@type":"Organization","name":"Blog","logo":{"@type":"ImageObject","url":"https://blog.aydrafting.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.aydrafting.com/ accesskey=h title="Blog (Alt + H)">Blog</a></div><div class="logo main-logo"><a href=https://aydrafting.com target=_blank><img src=/LogoAYD.png alt=Blog height=40></a></div><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.aydrafting.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.aydrafting.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">C# + Revit API: Lesson 9 - Static vs. Extension Methods</h1><div class=post-meta><span title='2025-08-08 13:53:29 +0300 MSK'>August 8, 2025</span>&nbsp;·&nbsp;10 min&nbsp;|&nbsp;<a href=mailto:%20aydimir@aydrafting.com rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><ul><ul><li><a href=#utility-method-version aria-label="Utility method version">Utility method version</a></li><li><a href=#extension-method-version aria-label="Extension Method version">Extension Method version</a></li></ul><li><a href=#the-idea-in-one-picture aria-label="The idea in one picture">The idea in one picture</a></li></ul><li><a href=#c-extension-methods-vs-static-utilities--cheat-sheet aria-label="C# Extension Methods vs Static Utilities — Cheat Sheet">C# Extension Methods vs Static Utilities — Cheat Sheet</a><ul><li><a href=#the-5second-summary aria-label="The 5‑second summary">The 5‑second summary</a></li><li><a href=#static-utility-pattern aria-label="Static Utility Pattern">Static Utility Pattern</a></li><li><a href=#extension-method-pattern aria-label="Extension Method Pattern">Extension Method Pattern</a></li><li><a href=#what-the-compiler-actually-does aria-label="What the Compiler Actually Does">What the Compiler Actually Does</a></li><li><a href=#when-to-use-which aria-label="When to Use Which">When to Use Which</a></li><li><a href=#gotchas-memorize-these aria-label="Gotchas (memorize these)">Gotchas (memorize these)</a></li><li><a href=#minimal-working-example-copypaste aria-label="Minimal Working Example (copy/paste)">Minimal Working Example (copy/paste)</a></li><li><a href=#quick-troubleshooting aria-label="Quick Troubleshooting">Quick Troubleshooting</a><ul><li><a href=#mental-model-ascii aria-label="Mental Model (ASCII)">Mental Model (ASCII)</a></li></ul></li></ul></li><li><a href=#extension-method-naming aria-label="Extension Method Naming">Extension Method Naming</a></li><li><a href=#homework aria-label=Homework>Homework</a><ul><ul><li><a href=#extend-your-methods aria-label="Extend your methods:">Extend your methods:</a></li></ul></ul></li><li><a href=#solution aria-label=Solution>Solution</a><ul><li><a href=#code aria-label=Code:>Code:</a><ul><li><a href=#project-solution aria-label="Project Solution">Project Solution</a></li><li><a href=#uicontrolledapplicaiton_extcs aria-label=UIControlledApplicaiton_Ext.cs>UIControlledApplicaiton_Ext.cs</a></li><li><a href=#applicationcs aria-label=Application.cs>Application.cs</a></li><li><a href=#ribbon_utilscs aria-label=Ribbon_Utils.cs>Ribbon_Utils.cs</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>modifiers</span> <span class=n>returnType</span> <span class=n>Method</span><span class=p>(</span><span class=k>this</span> <span class=n>extendedType</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=n>coding</span> <span class=n>logic</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>So far, we have been using <code>static utility classes</code> to store common methods to call upon. Alternatively, we can use <code>Extension Methods</code> to:</p><ol><li>Make the code readable.</li><li>To let you <code>Add</code> methods to existing types.<ul><li>They provide <strong>syntactic sugar</strong> (a nicer way to write code), so calls look like instance methods:</li></ul></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>string</span> <span class=n>x</span> <span class=p>=</span> <span class=s>&#34;hello&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>string</span> <span class=n>y</span> <span class=p>=</span> <span class=n>x</span><span class=p>.</span><span class=n>Reverse</span><span class=p>();</span>  <span class=c1>// Looks built-in, but it&#39;s actually an extension</span>
</span></span></code></pre></td></tr></table></div></div><hr><p>if <code>Reverse</code> was written as a <strong>static utility method</strong> instead of an <strong>extension</strong>, it might look like this:</p><h3 id=utility-method-version><strong><code>Utility method version</code></strong><a hidden class=anchor aria-hidden=true href=#utility-method-version>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>StringUtils</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>string</span> <span class=n>Reverse</span><span class=p>(</span><span class=kt>string</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span><span class=p>[]</span> <span class=n>arr</span> <span class=p>=</span> <span class=n>s</span><span class=p>.</span><span class=n>ToCharArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Array</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=n>arr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=kt>string</span><span class=p>(</span><span class=n>arr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong><code>Usage (static way):</code></strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kt>string</span> <span class=n>x</span> <span class=p>=</span> <span class=s>&#34;hello&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>string</span> <span class=n>y</span> <span class=p>=</span> <span class=n>StringUtils</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=n>x</span><span class=p>);</span> <span class=c1>// &lt;-- utility call</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=extension-method-version><code>Extension Method</code> version<a hidden class=anchor aria-hidden=true href=#extension-method-version>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>StringExtensions</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>string</span> <span class=n>Reverse</span><span class=p>(</span><span class=k>this</span> <span class=kt>string</span> <span class=n>s</span><span class=p>)</span> <span class=c1>// &#34;this&#34; turns it into an extension</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span><span class=p>[]</span> <span class=n>arr</span> <span class=p>=</span> <span class=n>s</span><span class=p>.</span><span class=n>ToCharArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Array</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=n>arr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=kt>string</span><span class=p>(</span><span class=n>arr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Usage (<code>extension</code> way):</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=nn>MyExtensions</span><span class=p>;</span> <span class=c1>// namespace with StringExtensions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>string</span> <span class=n>x</span> <span class=p>=</span> <span class=s>&#34;hello&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>string</span> <span class=n>y</span> <span class=p>=</span> <span class=n>x</span><span class=p>.</span><span class=n>Reverse</span><span class=p>();</span> <span class=c1>// looks like built-in, but calls static method under the hood</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Key difference:</strong></p><ul><li><strong>Static</strong> → <code>StringUtils.Reverse(x)</code> — always pass the value as an argument.</li><li><strong>Extension</strong> → <code>x.Reverse()</code> — looks like the method belongs to string, but it’s just compiler sugar for <code>StringExtensions.Reverse(x)</code>.</li></ul><ol start=3><li>Microsoft’s Official Definition<ul><li><strong>Extension members</strong> let you add methods to an existing type <strong>without</strong> subclassing, recompiling, or modifying its original code.</li><li>These methods must be declared in a <strong>static class</strong>, using the this keyword on the first parameter to indicate the extended type.</li><li>Example: LINQ methods like Where, Select, GroupBy are extension methods on <code>IEnumerable&lt;T>.</code></li></ul></li></ol><hr><h2 id=the-idea-in-one-picture>The idea in one picture<a hidden class=anchor aria-hidden=true href=#the-idea-in-one-picture>#</a></h2><ul><li><strong>Utility method</strong> = a tool on the shelf you call by name.
<code>MathUtils.IsEven(4)</code></li><li><strong>Extension method</strong> = the same tool glued onto the type so it <em>reads</em> like a built-in ability.
<code>4.IsEven()</code>
Same logic, different syntax.</li></ul><p><strong>Utility (plain function in a static class)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>MathUtils</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>bool</span> <span class=n>IsEven</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=n>n</span> <span class=p>%</span> <span class=m>2</span> <span class=p>==</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// use</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=n>a</span> <span class=p>=</span> <span class=n>MathUtils</span><span class=p>.</span><span class=n>IsEven</span><span class=p>(</span><span class=m>4</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><br><p><strong>Extension (adds “instance-like” call to a type)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>MyExtensions</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>IntExtensions</span>     <span class=c1>// class must be static</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// method must be static; first param has `this`</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=kt>bool</span> <span class=n>IsEven</span><span class=p>(</span><span class=k>this</span> <span class=kt>int</span> <span class=n>n</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=p>=&gt;</span> <span class=n>n</span> <span class=p>%</span> <span class=m>2</span> <span class=p>==</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><p><strong>Usage</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=nn>MyExtensions</span><span class=p>;</span>  <span class=c1>// import the namespace that contains IntExtensions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=n>b</span> <span class=p>=</span> <span class=m>4.</span><span class=n>IsEven</span><span class=p>();</span> <span class=c1>// now it reads like a built-in method</span>
</span></span></code></pre></td></tr></table></div></div><hr><h1 id=c-extension-methods-vs-static-utilities--cheat-sheet>C# Extension Methods vs Static Utilities — Cheat Sheet<a hidden class=anchor aria-hidden=true href=#c-extension-methods-vs-static-utilities--cheat-sheet>#</a></h1><p><em>A one‑pager you can print and keep by your keyboard.</em></p><hr><h2 id=the-5second-summary><strong>The 5‑second summary</strong><a hidden class=anchor aria-hidden=true href=#the-5second-summary>#</a></h2><ul><li><strong>Static utility</strong>: call a function on a helper class. <code>StringUtils.Reverse(x)</code></li><li><strong>Extension method</strong>: same function, but <em>called like an instance</em>. <code>x.Reverse()</code></li><li><strong>Truth</strong>: <code>x.Reverse()</code> is compiler sugar for <code>StringExtensions.Reverse(x)</code>.</li></ul><hr><h2 id=static-utility-pattern><strong>Static Utility Pattern</strong><a hidden class=anchor aria-hidden=true href=#static-utility-pattern>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>StringUtils</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>string</span> <span class=n>Reverse</span><span class=p>(</span><span class=kt>string</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>a</span> <span class=p>=</span> <span class=n>s</span><span class=p>.</span><span class=n>ToCharArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Array</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=kt>string</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Usage</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>y</span> <span class=p>=</span> <span class=n>StringUtils</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=s>&#34;hello&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=extension-method-pattern>Extension Method Pattern<a hidden class=anchor aria-hidden=true href=#extension-method-pattern>#</a></h2><p>Rules:</p><ol><li>Method <strong>lives in a static class</strong></li><li>Method itself is <strong>static</strong></li><li><strong>First parameter</strong> has this and is the type you’re extending</li><li>The <strong>namespace must be in scope</strong> via using</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>MyExtensions</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>StringExtensions</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=kt>string</span> <span class=n>Reverse</span><span class=p>(</span><span class=k>this</span> <span class=kt>string</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>a</span> <span class=p>=</span> <span class=n>s</span><span class=p>.</span><span class=n>ToCharArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>Array</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>new</span> <span class=kt>string</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Usage (note the &#34;using&#34;)</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>MyExtensions</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>y</span> <span class=p>=</span> <span class=s>&#34;hello&#34;</span><span class=p>.</span><span class=n>Reverse</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=what-the-compiler-actually-does><strong>What the Compiler Actually Does</strong><a hidden class=anchor aria-hidden=true href=#what-the-compiler-actually-does>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>Your</span> <span class=n>code</span><span class=p>:</span>                 <span class=n>Desugared</span> <span class=k>by</span> <span class=n>compiler</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>---------</span>                  <span class=p>----------------------------------</span>
</span></span><span class=line><span class=cl><span class=s>&#34;hello&#34;</span><span class=p>.</span><span class=n>Reverse</span><span class=p>()</span>   <span class=p>==&gt;</span>    <span class=n>StringExtensions</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=s>&#34;hello&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Lookup steps</strong></p><ol><li>Check receiver type (string) for an <strong>instance</strong> <code>Reverse()</code> → none.</li><li>Search imported <code>namespaces</code> for <strong>static methods</strong> whose <strong>first param</strong> is this string.</li><li>Pick best match (normal overload rules). Instance methods (if any) always <strong>win</strong> over extensions.</li></ol><hr><h2 id=when-to-use-which><strong>When to Use Which</strong><a hidden class=anchor aria-hidden=true href=#when-to-use-which>#</a></h2><ul><li><p><strong>Use static utility</strong> when:</p><ul><li>It’s general‑purpose or spans many types (logging, parsing, config).</li><li>You don’t want to pollute IntelliSense for common types.</li></ul></li><li><p><strong>Use extension method</strong> when:</p><ul><li>The behavior clearly “belongs” to a single type.</li><li>You want fluent, chainable syntax (e.g., LINQ‑style pipelines).</li></ul></li></ul><hr><h2 id=gotchas-memorize-these><strong>Gotchas (memorize these)</strong><a hidden class=anchor aria-hidden=true href=#gotchas-memorize-these>#</a></h2><ul><li>Extensions <strong>don’t modify</strong> the type; they’re just syntax <code>sugar</code>.</li><li>If the type later adds a real instance method with the same signature, the <strong>real one wins</strong>.</li><li>Resolution uses the variable’s <strong>compile‑time type</strong>, not runtime.</li><li>You must <code>using</code> the extension’s <strong>namespace</strong>, or it won’t be found.</li><li>Keep extensions <strong>focused</strong>; too many can clutter <code>IntelliSense</code>.</li></ul><hr><h2 id=minimal-working-example-copypaste>Minimal Working Example (copy/paste)<a hidden class=anchor aria-hidden=true href=#minimal-working-example-copypaste>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// StringExtensions.cs</span>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>MyExtensions</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>StringExtensions</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=kt>bool</span> <span class=n>IsNullOrBlank</span><span class=p>(</span><span class=k>this</span> <span class=kt>string?</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>=&gt;</span> <span class=kt>string</span><span class=p>.</span><span class=n>IsNullOrWhiteSpace</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Program.cs</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>MyExtensions</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Program</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=k>void</span> <span class=n>Main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>x</span> <span class=p>=</span> <span class=s>&#34;  &#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=n>IsNullOrBlank</span><span class=p>());</span> <span class=c1>// True</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=quick-troubleshooting><strong>Quick Troubleshooting</strong><a hidden class=anchor aria-hidden=true href=#quick-troubleshooting>#</a></h2><ul><li><strong>CS1061: ‘Type’ does not contain a definition for ‘Foo’</strong> → Missing <code>using</code> for the extension’s namespace or wrong this type.</li><li><strong>Ambiguous call</strong> → Multiple extensions in scope with same signature; qualify with full class <code>name</code> or remove one <code>using</code>.</li><li><strong>Not being called</strong> → A real instance method with same signature exists and <strong>shadows</strong> your extension.</li></ul><hr><h3 id=mental-model-ascii>Mental Model (ASCII)<a hidden class=anchor aria-hidden=true href=#mental-model-ascii>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>Caller</span>                       <span class=n>Compiler</span> <span class=n>Resolution</span>
</span></span><span class=line><span class=cl><span class=p>------</span>                       <span class=p>------------------</span>
</span></span><span class=line><span class=cl><span class=n>x</span><span class=p>.</span><span class=n>Reverse</span><span class=p>()</span>          <span class=p>-&gt;</span>      <span class=m>1</span><span class=p>)</span> <span class=n>Check</span> <span class=n>instance</span> <span class=k>on</span> <span class=kt>string</span> <span class=err>→</span> <span class=n>none</span>
</span></span><span class=line><span class=cl>                             <span class=m>2</span><span class=p>)</span> <span class=n>Scan</span> <span class=n>imported</span> <span class=n>namespaces</span> <span class=k>for</span>
</span></span><span class=line><span class=cl>                                <span class=kd>static</span> <span class=n>methods</span> <span class=n>with</span> <span class=n>first</span> <span class=n>param</span><span class=p>:</span> <span class=k>this</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>                             <span class=m>3</span><span class=p>)</span> <span class=n>Choose</span> <span class=n>best</span> <span class=n>match</span>
</span></span><span class=line><span class=cl>                             <span class=m>4</span><span class=p>)</span> <span class=n>Rewrite</span> <span class=n>to</span> <span class=n>StringExtensions</span><span class=p>.</span><span class=n>Reverse</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><code>utilities</code> = toolbox; <code>extensions</code> = bolt‑on skills. Same logic, nicer syntax.</p></blockquote><h1 id=extension-method-naming>Extension Method Naming<a hidden class=anchor aria-hidden=true href=#extension-method-naming>#</a></h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Extension namespace</span>
</span></span><span class=line><span class=cl><span class=n>guRoo</span><span class=p>.</span><span class=n>Extensions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Class file name</span>
</span></span><span class=line><span class=cl><span class=n>guRoo</span><span class=err>\</span><span class=n>Extentions</span><span class=err>\</span><span class=n>ExtendedClass_Ext</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Extension method</span>
</span></span><span class=line><span class=cl><span class=n>Ext_MethodName</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=homework>Homework<a hidden class=anchor aria-hidden=true href=#homework>#</a></h1><h3 id=extend-your-methods>Extend your methods:<a hidden class=anchor aria-hidden=true href=#extend-your-methods>#</a></h3><ul><li>Set up a new folder and namespace</li><li>Set up 2 extension classes in your project</li><li>Set up extension methods</li><li>Modify some of our code to use the above</li></ul><h1 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h1><h2 id=code>Code:<a hidden class=anchor aria-hidden=true href=#code>#</a></h2><h3 id=project-solution><code>Project Solution</code><a hidden class=anchor aria-hidden=true href=#project-solution>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>Solution</span>
</span></span><span class=line><span class=cl><span class=p>|-&gt;</span> <span class=n>guRoo</span>
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>Dependencies</span>
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>Commands</span>
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>General</span> 
</span></span><span class=line><span class=cl>			<span class=p>|-&gt;</span> <span class=n>Cmds_General</span><span class=p>.</span><span class=n>cs</span> 
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>Forms</span>
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>General</span> 
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>Globals</span><span class=p>.</span><span class=n>cs</span> 
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>Extensions</span> <span class=c1>// Add a New Folder</span>
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>UIControlledApplicaiton_Ext</span><span class=p>.</span><span class=n>cs</span> <span class=c1>// Create a New Class</span>
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> 
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>Resources</span>
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>Files</span> 
</span></span><span class=line><span class=cl>			<span class=p>|-&gt;</span> <span class=n>Tooltips</span><span class=p>.</span><span class=n>resx</span> 
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>Icons</span> 
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>Icons16</span> 
</span></span><span class=line><span class=cl>			<span class=p>|-&gt;</span> <span class=n>General_test16</span><span class=p>.</span><span class=n>png</span> 
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>Icons32</span> 
</span></span><span class=line><span class=cl>			<span class=p>|-&gt;</span> <span class=n>General_test32</span><span class=p>.</span><span class=n>png</span> 
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>Utilities</span>
</span></span><span class=line><span class=cl>		<span class=p>|-&gt;</span> <span class=n>Ribbon_Utils</span><span class=p>.</span><span class=n>cs</span> 
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>Application</span><span class=p>.</span><span class=n>cs</span> <span class=c1>// Updated</span>
</span></span><span class=line><span class=cl>	<span class=p>|-&gt;</span> <span class=n>guRoo</span><span class=p>.</span><span class=n>addin</span>
</span></span></code></pre></td></tr></table></div></div><ol><li>Borrow an existing static method from <code>Ribbon_Utils.cs</code> and extend it:</li></ol><h3 id=uicontrolledapplicaiton_extcs><code>UIControlledApplicaiton_Ext.cs</code><a hidden class=anchor aria-hidden=true href=#uicontrolledapplicaiton_extcs>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=nn>Autodesk.Revit.UI</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Diagnostics</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>guRoo.Extensions</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>UIControlledApplication_Ext</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kd>public</span> <span class=kd>static</span> <span class=n>Result</span> <span class=n>AddRibbonTab</span><span class=p>(</span><span class=k>this</span> <span class=n>UIControlledApplication</span> <span class=n>uiCtlApp</span><span class=p>,</span> <span class=kt>string</span> <span class=n>tabName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>	            <span class=c1>// Try to add a tab:</span>
</span></span><span class=line><span class=cl>                <span class=n>uiCtlApp</span><span class=p>.</span><span class=n>CreateRibbonTab</span><span class=p>(</span><span class=n>tabName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=n>Succeeded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>catch</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>	            <span class=c1>// Report the error if it fails:</span>
</span></span><span class=line><span class=cl>                <span class=n>Debug</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&#34;Error: Could not create a tab: {tabName}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=n>Failed</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>Update <code>Applications.cs</code>:</li></ol><h3 id=applicationcs><code>Application.cs</code><a hidden class=anchor aria-hidden=true href=#applicationcs>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=c1>// Autodesk</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>Autodesk.Revit.UI</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// guRoo</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>gRib</span> <span class=p>=</span> <span class=n>guRoo</span><span class=p>.</span><span class=n>Utilities</span><span class=p>.</span><span class=n>Ribbon_Utils</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>guRoo.Extensions</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>guRoo</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>class</span> <span class=nc>Application</span> <span class=p>:</span> <span class=n>IExternalApplication</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=kd>static</span> <span class=n>UIControlledApplication</span> <span class=n>_uiCtlApp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Result</span> <span class=n>OnStartup</span><span class=p>(</span><span class=n>UIControlledApplication</span> <span class=n>uiCtlApp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=cp>#region</span> <span class=n>Globals</span> <span class=n>registration</span>
</span></span><span class=line><span class=cl>            <span class=n>_uiCtlApp</span> <span class=p>=</span> <span class=n>uiCtlApp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>_uiCtlApp</span><span class=p>.</span><span class=n>Idling</span> <span class=p>+=</span> <span class=n>RegisterUiApp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>catch</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Globals</span><span class=p>.</span><span class=n>UiApp</span> <span class=p>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>Globals</span><span class=p>.</span><span class=n>UsernameRevit</span> <span class=p>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>Globals</span><span class=p>.</span><span class=n>RegisterProperties</span><span class=p>(</span><span class=n>uiCtlApp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>Globals</span><span class=p>.</span><span class=n>RegisterTooltips</span><span class=p>(</span><span class=s>&#34;guRoo.Resources.Files.Tooltips&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// =====Updated Part 1 Start=====</span>
</span></span><span class=line><span class=cl>            <span class=cp>#region</span> <span class=n>Ribbon</span> <span class=n>setup</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>//Add Ribbon Tab</span>
</span></span><span class=line><span class=cl>            <span class=n>uiCtlApp</span><span class=p>.</span><span class=n>AddRibbonTab</span><span class=p>(</span><span class=n>Globals</span><span class=p>.</span><span class=n>AddinName</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// Create a Panel</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>panelGeneral</span> <span class=p>=</span> <span class=n>gRib</span><span class=p>.</span><span class=n>AddRibbonPanelToTab</span><span class=p>(</span><span class=n>uiCtlApp</span><span class=p>,</span> <span class=n>Globals</span><span class=p>.</span><span class=n>AddinName</span><span class=p>,</span> <span class=s>&#34;General&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// Add Button to Panel</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>buttonTest</span> <span class=p>=</span> <span class=n>gRib</span><span class=p>.</span><span class=n>AddPushButtonToPanel</span><span class=p>(</span><span class=n>panelGeneral</span><span class=p>,</span> <span class=s>&#34;Testing&#34;</span><span class=p>,</span> <span class=s>&#34;guRoo.Cmds_General.Cmd_Test&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// Final Return</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=n>Succeeded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// =====Updated Part 1 End=====</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cp>#region</span> <span class=n>On</span> <span class=n>shutdown</span> <span class=n>method</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>Result</span> <span class=n>OnShutdown</span><span class=p>(</span><span class=n>UIControlledApplication</span> <span class=n>uiCtlApp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=n>Succeeded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cp>#region</span> <span class=n>Use</span> <span class=n>idling</span> <span class=n>to</span> <span class=n>register</span> <span class=n>UiApp</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=kd>static</span> <span class=k>void</span> <span class=n>RegisterUiApp</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>IdlingEventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_uiCtlApp</span><span class=p>.</span><span class=n>Idling</span> <span class=p>-=</span> <span class=n>RegisterUiApp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>sender</span> <span class=k>is</span> <span class=n>UIApplication</span> <span class=n>uiApp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Globals</span><span class=p>.</span><span class=n>UiApp</span> <span class=p>=</span> <span class=n>uiApp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>Globals</span><span class=p>.</span><span class=n>UsernameRevit</span> <span class=p>=</span> <span class=n>uiApp</span><span class=p>.</span><span class=n>Application</span><span class=p>.</span><span class=n>Username</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>And remove that part from <code>Ribbon_Utils.cs</code>:</li></ol><h3 id=ribbon_utilscs><code>Ribbon_Utils.cs</code><a hidden class=anchor aria-hidden=true href=#ribbon_utilscs>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=nn>Autodesk.Revit.UI</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Diagnostics</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>guRoo.Utilities</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kd>static</span> <span class=k>class</span> <span class=nc>Ribbon_Utils</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// =====REMOVE THIS PART 1=====</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Method to create a &#34;Tab&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>//        public static Result AddRibbonTab(UIControlledApplication uiCtlApp,string tabName)</span>
</span></span><span class=line><span class=cl><span class=c1>//        {</span>
</span></span><span class=line><span class=cl><span class=c1>//            try</span>
</span></span><span class=line><span class=cl><span class=c1>//            {</span>
</span></span><span class=line><span class=cl><span class=c1>//                uiCtlApp.CreateRibbonTab(tabName);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//                return Result.Succeeded;</span>
</span></span><span class=line><span class=cl><span class=c1>//            }</span>
</span></span><span class=line><span class=cl><span class=c1>//            catch</span>
</span></span><span class=line><span class=cl><span class=c1>//            {</span>
</span></span><span class=line><span class=cl><span class=c1>//                Debug.WriteLine($&#34;Error: Could not create a tab: {tabName}&#34;);</span>
</span></span><span class=line><span class=cl><span class=c1>//                return Result.Failed;</span>
</span></span><span class=line><span class=cl><span class=c1>//            }</span>
</span></span><span class=line><span class=cl><span class=c1>//        }</span>
</span></span><span class=line><span class=cl><span class=c1>// =====REMOVE THIS PART 1=====</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// =====REMOVE THIS PART 2=====</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Method to create a &#34;Panel&#34;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=n>RibbonPanel</span> <span class=n>AddRibbonPanelToTab</span><span class=p>(</span><span class=n>UIControlledApplication</span> <span class=n>uiCtlApp</span><span class=p>,</span> <span class=kt>string</span> <span class=n>tabName</span><span class=p>,</span> <span class=kt>string</span> <span class=n>panelName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>uiCtlApp</span><span class=p>.</span><span class=n>CreateRibbonPanel</span><span class=p>(</span><span class=n>tabName</span><span class=p>,</span> <span class=n>panelName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>catch</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Debug</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&#34;Error: Could not add {panelName} to {tabName}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>GetRibbonPanelByName</span><span class=p>(</span><span class=n>uiCtlApp</span><span class=p>,</span> <span class=n>tabName</span><span class=p>,</span> <span class=n>panelName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Method to get that &#34;Panel&#34;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=n>RibbonPanel</span> <span class=n>GetRibbonPanelByName</span><span class=p>(</span><span class=n>UIControlledApplication</span> <span class=n>uiCtlApp</span><span class=p>,</span> <span class=kt>string</span> <span class=n>tabName</span><span class=p>,</span> <span class=kt>string</span> <span class=n>panelName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>panels</span> <span class=p>=</span> <span class=n>uiCtlApp</span><span class=p>.</span><span class=n>GetRibbonPanels</span><span class=p>(</span><span class=n>tabName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=n>panel</span> <span class=k>in</span> <span class=n>panels</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>panel</span><span class=p>.</span><span class=n>Name</span> <span class=p>==</span> <span class=n>panelName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>panel</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// If Not found</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// =====REMOVE THIS PART 2=====</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Method to create a &#34;Button&#34; to &#34;Panel&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// Fill this summary for Methods to be described on Mouse Hover.</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;panel&#34;&gt;This is the RibbonPanel to add to.&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;buttonName&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;className&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;internalName&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;param name=&#34;assemblyPath&#34;&gt;Test&lt;/param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cs>/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=n>PushButton</span> <span class=n>AddPushButtonToPanel</span><span class=p>(</span><span class=n>RibbonPanel</span> <span class=n>panel</span><span class=p>,</span> <span class=kt>string</span> <span class=n>buttonName</span><span class=p>,</span> <span class=kt>string</span> <span class=n>className</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// string internalName, -&gt; NOT NEEDED ANYMORE</span>
</span></span><span class=line><span class=cl>        <span class=c1>// string assemblyPath)-&gt; NOT NEEDED ANYMORE</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>panel</span> <span class=k>is</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Debug</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&#34;Error: Could not create {buttonName}.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Open PushButtonData Constructor and check what&#39;s needed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Get the base name from below</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>baseName</span> <span class=p>=</span> <span class=n>CommandToBaseName</span><span class=p>(</span><span class=n>className</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Create a PushButtonData object:</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>pushButtonData</span> <span class=p>=</span> <span class=k>new</span> <span class=n>PushButtonData</span><span class=p>(</span><span class=n>baseName</span><span class=p>,</span> <span class=n>buttonName</span><span class=p>,</span> <span class=n>Globals</span><span class=p>.</span><span class=n>AssemblyPath</span><span class=p>,</span> <span class=n>className</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// if the button was made - return it:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>panel</span><span class=p>.</span><span class=n>AddItem</span><span class=p>(</span><span class=n>pushButtonData</span><span class=p>)</span> <span class=k>is</span> <span class=n>PushButton</span> <span class=n>pushButton</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>pushButton</span><span class=p>.</span><span class=n>ToolTip</span> <span class=p>=</span> <span class=n>LookupTooltip</span><span class=p>(</span><span class=n>baseName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=c1>// We will come back to this:</span>
</span></span><span class=line><span class=cl>                <span class=n>pushButton</span><span class=p>.</span><span class=n>Image</span> <span class=p>=</span> <span class=n>GetIcon</span><span class=p>(</span><span class=n>baseName</span><span class=p>,</span> <span class=n>resolution</span><span class=p>:</span> <span class=m>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>pushButton</span><span class=p>.</span><span class=n>LargeImage</span> <span class=p>=</span> <span class=n>GetIcon</span><span class=p>(</span><span class=n>baseName</span><span class=p>,</span> <span class=n>resolution</span><span class=p>:</span> <span class=m>32</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>pushButton</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Debug</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&#34;Error: Could not create {buttonName}.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Method to get the base name of a command:</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=kt>string</span> <span class=n>CommandToBaseName</span><span class=p>(</span><span class=kt>string</span> <span class=n>commandName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>commandName</span><span class=p>.</span><span class=n>Replace</span><span class=p>(</span><span class=s>&#34;guRoo.Cmds_&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>).</span><span class=n>Replace</span><span class=p>(</span><span class=s>&#34;.Cmd&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Method to get a value from a dictionary key</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>static</span> <span class=kt>string</span> <span class=n>LookupTooltip</span><span class=p>(</span><span class=kt>string</span> <span class=n>key</span><span class=p>,</span> <span class=kt>string</span> <span class=n>failValue</span> <span class=p>=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>failValue</span> <span class=p>??=</span> <span class=s>&#34;No tooltip value was found.&#34;</span><span class=p>;</span> <span class=c1>// ??= -&gt; if this is null set it to the following</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>Globals</span><span class=p>.</span><span class=n>Tooltips</span><span class=p>.</span><span class=n>TryGetValue</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=k>out</span> <span class=kt>string</span> <span class=k>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>failValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>// Method to get an icon as an image source</span>
</span></span><span class=line><span class=cl>		<span class=kd>public</span> <span class=kd>static</span> <span class=n>ImageSource</span> <span class=n>GetIcon</span><span class=p>(</span><span class=kt>string</span> <span class=n>baseName</span><span class=p>,</span> <span class=kt>int</span> <span class=n>resolution</span> <span class=p>=</span> <span class=m>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=kt>var</span> <span class=n>resourcePath</span> <span class=p>=</span> <span class=s>$&#34;guRoo.Resources.Icons{resolution}.{baseName}{resolution}.png&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			<span class=k>using</span>  <span class=p>(</span><span class=kt>var</span> <span class=n>stream</span> <span class=p>=</span> <span class=n>Globals</span><span class=p>.</span><span class=n>Assembly</span><span class=p>.</span><span class=n>GetManifestResourceStream</span><span class=p>(</span><span class=n>resourcePath</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			<span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>if</span> <span class=p>(</span><span class=n>stream</span> <span class=k>is</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=kc>null</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>				
</span></span><span class=line><span class=cl>				<span class=kt>var</span> <span class=n>decoder</span> <span class=p>=</span> <span class=k>new</span> <span class=n>PngBitmapDecoder</span><span class=p>(</span>
</span></span><span class=line><span class=cl>					<span class=n>stream</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>					<span class=n>BitmapCreateOptions</span><span class=p>.</span><span class=n>PreservePixelFormat</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>					<span class=n>BitmapCacheOption</span><span class=p>.</span><span class=n>Default</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				
</span></span><span class=line><span class=cl>				<span class=k>if</span> <span class=p>(</span><span class=n>decoder</span><span class=p>.</span><span class=n>Frames</span><span class=p>.</span><span class=n>Count</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=k>return</span> <span class=n>decoder</span><span class=p>.</span><span class=n>Frames</span><span class=p>.</span><span class=n>First</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=k>else</span>
</span></span><span class=line><span class=cl>				<span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.aydrafting.com/tags/c%23/>C#</a></li><li><a href=https://blog.aydrafting.com/tags/revit/>Revit</a></li><li><a href=https://blog.aydrafting.com/tags/tutorial/>Tutorial</a></li></ul><nav class=paginav><a class=next href=https://blog.aydrafting.com/posts/post-8/><span class=title>Next »</span><br><span>C# + Revit API: Lesson 8 - Tooltips & Icons</span></a></nav></footer></article></main><footer class=footer><span>© 2025 AYDrafting. All rights reserved.</span> ·
<span>Powered by
<a href=https://aydrafting.com/ rel="noopener noreferrer" target=_blank>AYDrafting</a> &
<a href=https://github.com/aydimir95/ rel=noopener target=_blank>GitHub</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>