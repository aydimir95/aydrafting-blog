<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>C# &#43; Revit API: Lesson 11 - Stacking Buttons | Blog</title>
<meta name="keywords" content="C#, Revit, Tutorial">
<meta name="description" content="Aussie BIM Guru
The Goal

Stacks can vertically contain 2 or 3 items.

Homework

Create a stack
Access stacked items

Solution
Revit API

AddStackedItems Method

2 overloads available, you can either add 2 items or 3 items.


RibbonItemData Class - is the object that we are going to be adding:

ComboBoxData Class
RadioButtonClass
ButtonData Class

PulldownButton
PushButton





Tips

We will be adding it to RibbonPanel
But we will not create an Extension for this, since the the Method itself is sufficient to run this process.
But we are going to have to access the projects once we create them as well.

Project Solution


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42


Solution
|-&gt; guRoo
	|-&gt; Dependencies
	|-&gt; Commands
		|-&gt; General 
			|-&gt; Cmds_General.cs 
			|-&gt; Cmds_Button.cs // Add a New Class
			|-&gt; Cmds_PullDown.cs  
			|-&gt; Cmds_Stack1.cs // Add a New Class
			|-&gt; Cmds_Stack2.cs // Add a New Class
			|-&gt; Cmds_Stack3.cs // Add a New Class
	|-&gt; Forms
	|-&gt; General 
		|-&gt; Globals.cs 
	|-&gt; Extensions 
		|-&gt; UIControlledApplicaiton_Ext.cs 
		|-&gt; RibbonPanel_Ext.cs
		|-&gt; PulldownButton_Ext.cs 
	|-&gt; Resources
		|-&gt; Files 
			|-&gt; Tooltips.resx       // Update
		|-&gt; Icons 
		|-&gt; Icons16 
			|-&gt; General_test16.png 
			|-&gt; Stack1_Button16.png // add a .png
			|-&gt; Stack116.png        // add a .png
			|-&gt; Stack2_Button16.png // add a .png
			|-&gt; Stack216.png        // add a .png
			|-&gt; Stack3_Button16.png // add a .png
			|-&gt; Stack316.png        // add a .png
		|-&gt; Icons32      
			|-&gt; General_test32.png  // add a .png
			|-&gt; Stack1_Button32.png // add a .png
			|-&gt; Stack132.png        // add a .png
			|-&gt; Stack2_Button32.png // add a .png
			|-&gt; Stack232.png        // add a .png
			|-&gt; Stack3_Button32.png // add a .png
			|-&gt; Stack332.png        // add a .png
	|-&gt; Utilities
		|-&gt; Ribbon_Utils.cs
	|-&gt; Application.cs              // Update
	|-&gt; guRoo.addin


Cmds_Stack1.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28


// Autodesk
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// Associate with stack commands
namespace guRoo.Cmds_Stack1
{
    /// &lt;summary&gt;
    /// Example command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
        {
            // Collect the document
            var uiApp = commandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Testing if the command worked
            TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title);

            // Final return
            return Result.Succeeded;
        }
    }
}


Cmds_Stack2.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28


// Autodesk
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// Associate with stack commands
namespace guRoo.Cmds_Stack2
{
    /// &lt;summary&gt;
    /// Example command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
        {
            // Collect the document
            var uiApp = commandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Testing if the command worked
            TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title);

            // Final return
            return Result.Succeeded;
        }
    }
}


Cmds_Stack3.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28


// Autodesk
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// Associate with stack commands
namespace guRoo.Cmds_Stack3
{
    /// &lt;summary&gt;
    /// Example command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
        {
            // Collect the document
            var uiApp = commandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Testing if the command worked
            TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title);

            // Final return
            return Result.Succeeded;
        }
    }
}


Tooltips.resx

  
      
          Name
          Value
      
  
  
      
          Button
          The user will generally not see this - it just holds the PushButton example.
      
      
          Button_Button
          This is an example of adding a PushButton to a RibbonPanel.
      
      
          PullDown
          This is an example of adding a PulldownButton to a RibbonPanel.
      
      
          PullDown_1Button
          This is button 1 of the PulldownButton.
      
      
          PullDown_2Button
          This is button 2 of the PulldownButton.
      
      
          PullDown_3Button
          This is button 3 of the PulldownButton.
      
      
          Stack1
          This is an example of stacking buttons.
      
      
          Stack1_Button
          This is an example of stacking buttons.
      
      
          Stack2
          This is an example of stacking buttons.
      
      
          Stack2_Button
          This is an example of stacking buttons.
      
      
          Stack3
          This is an example of stacking buttons.
      
      
          Stack3_Button
          This is an example of stacking buttons.
      
  

Application.cs


  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108


// Autodesk
using Autodesk.Revit.UI;
using Autodesk.Revit.UI.Events;


// guRoo
using gRib = guRoo.Utilities.Ribbon_Utils;
using guRoo.Extensions;

// This application belongs to the root namespace
namespace guRoo
{
    // Implementing the interface for application.cs class
    public class Application : IExternalApplication
    // IExternalApplication for the interface
    {
        // Make a private uiCtlApp method:
        private static UIControlledApplication _uiCtlApp;

        //This will return a result on Startup method - requires uiCtlApp
        public Result OnStartup(UIControlledApplication uiCtlApp)
        {

            #region Globals registration
            // Store _uiCtlApp, register on idling
            _uiCtlApp = uiCtlApp;

            try
            {
                _uiCtlApp.Idling &#43;= RegisterUiApp;
            }
            catch
            {
                Globals.UiApp = null;
                Globals.UsernameRevit = null;
            }

            // Register Globals
            Globals.RegisterProperties(uiCtlApp);

            // Register Tooltips
            Globals.RegisterTooltips(&#34;guRoo.Resources.Files.Tooltips&#34;);
            #endregion

            #region Ribbon setup
            // Add RibbonTab
            uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); 

            // Create RibbonPanel
            var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, &#34;General&#34;);

            // Add PushButton to RibbonPanel
            var buttonTest = panelGeneral.Ext_AddPushButton(&#34;Testing&#34;, &#34;guRoo.Cmds_General.Cmd_Test&#34;);

            // Add PulldownButton to RibbonPanel
            var pulldownTest = panelGeneral.Ext_AddPulldownButton(&#34;PullDown&#34;, &#34;guRoo.Cmds_PullDown&#34;);

            // Add Buttons to Pulldown
            pulldownTest.Ext_AddPushButton(&#34;Button 1&#34;, &#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 2&#34;, &#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 3&#34;, &#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;);

			// Create data objects for the stack
            var stack1Data = gRib.NewPulldownButtonData(&#34;Stack1&#34;, &#34;guRoo.Cmds_Stack1&#34;);
            var stack2Data = gRib.NewPulldownButtonData(&#34;Stack2&#34;, &#34;guRoo.Cmds_Stack2&#34;);
            var stack3Data = gRib.NewPulldownButtonData(&#34;Stack3&#34;, &#34;guRoo.Cmds_Stack3&#34;);

            // Create the Stack
            var stack = panelGeneral.AddStackedItems(stack1Data, stack2Data, stack3Data);
            var pulldownStack1 = stack[0] as PulldownButton;
            var pulldownStack2 = stack[1] as PulldownButton;
            var pulldownStack3 = stack[2] as PulldownButton;

            // Add buttons to stacked pulldowns
            pulldownStack1.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack1.Cmd_Button&#34;);
            pulldownStack2.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack2.Cmd_Button&#34;);
            pulldownStack3.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack3.Cmd_Button&#34;);

            #endregion


            // Final return:
            return Result.Succeeded; // or Cancelled
        }

        #region On shutdown method
        // This will urn on shutdown
        public Result OnShutdown(UIControlledApplication uiCtlApp)
        {
            return Result.Succeeded;
        }
        #endregion

        #region Use idling to register UiApp
        // On idling, register UiApp/username
        private static void RegisterUiApp(object sender, IdlingEventArgs e)
        {
            _uiCtlApp.Idling -= RegisterUiApp;

            if (sender is UIApplication uiApp)
            {
                Globals.UiApp = uiApp;
                Globals.UsernameRevit = uiApp.Application.Username;
            }
        }
        #endregion
    }
}




These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/lesson-11/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6d585472a409a8f504e6bf969a2864fd1288e629997cd2926dd96376ae22831b.css" integrity="sha256-bVhUcqQJqPUE5r&#43;Wmihk/RKI5imZfNKSbdljdq4igxs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/lesson-11/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/lesson-11/">
  <meta property="og:site_name" content="Blog">
  <meta property="og:title" content="C# &#43; Revit API: Lesson 11 - Stacking Buttons">
  <meta property="og:description" content="Aussie BIM Guru
The Goal Stacks can vertically contain 2 or 3 items. Homework Create a stack Access stacked items Solution Revit API AddStackedItems Method 2 overloads available, you can either add 2 items or 3 items. RibbonItemData Class - is the object that we are going to be adding: ComboBoxData Class RadioButtonClass ButtonData Class PulldownButton PushButton Tips We will be adding it to RibbonPanel But we will not create an Extension for this, since the the Method itself is sufficient to run this process. But we are going to have to access the projects once we create them as well. Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 Solution |-&gt; guRoo |-&gt; Dependencies |-&gt; Commands |-&gt; General |-&gt; Cmds_General.cs |-&gt; Cmds_Button.cs // Add a New Class |-&gt; Cmds_PullDown.cs |-&gt; Cmds_Stack1.cs // Add a New Class |-&gt; Cmds_Stack2.cs // Add a New Class |-&gt; Cmds_Stack3.cs // Add a New Class |-&gt; Forms |-&gt; General |-&gt; Globals.cs |-&gt; Extensions |-&gt; UIControlledApplicaiton_Ext.cs |-&gt; RibbonPanel_Ext.cs |-&gt; PulldownButton_Ext.cs |-&gt; Resources |-&gt; Files |-&gt; Tooltips.resx // Update |-&gt; Icons |-&gt; Icons16 |-&gt; General_test16.png |-&gt; Stack1_Button16.png // add a .png |-&gt; Stack116.png // add a .png |-&gt; Stack2_Button16.png // add a .png |-&gt; Stack216.png // add a .png |-&gt; Stack3_Button16.png // add a .png |-&gt; Stack316.png // add a .png |-&gt; Icons32 |-&gt; General_test32.png // add a .png |-&gt; Stack1_Button32.png // add a .png |-&gt; Stack132.png // add a .png |-&gt; Stack2_Button32.png // add a .png |-&gt; Stack232.png // add a .png |-&gt; Stack3_Button32.png // add a .png |-&gt; Stack332.png // add a .png |-&gt; Utilities |-&gt; Ribbon_Utils.cs |-&gt; Application.cs // Update |-&gt; guRoo.addin Cmds_Stack1.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack1 { /// &lt;summary&gt; /// Example command /// &lt;/summary&gt; [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack2.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack2 { /// &lt;summary&gt; /// Example command /// &lt;/summary&gt; [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack3.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack3 { /// &lt;summary&gt; /// Example command /// &lt;/summary&gt; [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title); // Final return return Result.Succeeded; } } } Tooltips.resx Name Value Button The user will generally not see this - it just holds the PushButton example. Button_Button This is an example of adding a PushButton to a RibbonPanel. PullDown This is an example of adding a PulldownButton to a RibbonPanel. PullDown_1Button This is button 1 of the PulldownButton. PullDown_2Button This is button 2 of the PulldownButton. PullDown_3Button This is button 3 of the PulldownButton. Stack1 This is an example of stacking buttons. Stack1_Button This is an example of stacking buttons. Stack2 This is an example of stacking buttons. Stack2_Button This is an example of stacking buttons. Stack3 This is an example of stacking buttons. Stack3_Button This is an example of stacking buttons. Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling &#43;= RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips(&#34;guRoo.Resources.Files.Tooltips&#34;); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, &#34;General&#34;); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton(&#34;Testing&#34;, &#34;guRoo.Cmds_General.Cmd_Test&#34;); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton(&#34;PullDown&#34;, &#34;guRoo.Cmds_PullDown&#34;); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton(&#34;Button 1&#34;, &#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;); pulldownTest.Ext_AddPushButton(&#34;Button 2&#34;, &#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;); pulldownTest.Ext_AddPushButton(&#34;Button 3&#34;, &#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;); // Create data objects for the stack var stack1Data = gRib.NewPulldownButtonData(&#34;Stack1&#34;, &#34;guRoo.Cmds_Stack1&#34;); var stack2Data = gRib.NewPulldownButtonData(&#34;Stack2&#34;, &#34;guRoo.Cmds_Stack2&#34;); var stack3Data = gRib.NewPulldownButtonData(&#34;Stack3&#34;, &#34;guRoo.Cmds_Stack3&#34;); // Create the Stack var stack = panelGeneral.AddStackedItems(stack1Data, stack2Data, stack3Data); var pulldownStack1 = stack[0] as PulldownButton; var pulldownStack2 = stack[1] as PulldownButton; var pulldownStack3 = stack[2] as PulldownButton; // Add buttons to stacked pulldowns pulldownStack1.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack1.Cmd_Button&#34;); pulldownStack2.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack2.Cmd_Button&#34;); pulldownStack3.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack3.Cmd_Button&#34;); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-14T18:30:33+03:00">
    <meta property="article:modified_time" content="2025-08-14T18:30:33+03:00">
    <meta property="article:tag" content="C#">
    <meta property="article:tag" content="Revit">
    <meta property="article:tag" content="Tutorial">
    <meta property="og:image" content="http://localhost:1313/images/Pasted%20image%2020250814192206.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/Pasted%20image%2020250814192206.png">
<meta name="twitter:title" content="C# &#43; Revit API: Lesson 11 - Stacking Buttons">
<meta name="twitter:description" content="Aussie BIM Guru
The Goal

Stacks can vertically contain 2 or 3 items.

Homework

Create a stack
Access stacked items

Solution
Revit API

AddStackedItems Method

2 overloads available, you can either add 2 items or 3 items.


RibbonItemData Class - is the object that we are going to be adding:

ComboBoxData Class
RadioButtonClass
ButtonData Class

PulldownButton
PushButton





Tips

We will be adding it to RibbonPanel
But we will not create an Extension for this, since the the Method itself is sufficient to run this process.
But we are going to have to access the projects once we create them as well.

Project Solution


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42


Solution
|-&gt; guRoo
	|-&gt; Dependencies
	|-&gt; Commands
		|-&gt; General 
			|-&gt; Cmds_General.cs 
			|-&gt; Cmds_Button.cs // Add a New Class
			|-&gt; Cmds_PullDown.cs  
			|-&gt; Cmds_Stack1.cs // Add a New Class
			|-&gt; Cmds_Stack2.cs // Add a New Class
			|-&gt; Cmds_Stack3.cs // Add a New Class
	|-&gt; Forms
	|-&gt; General 
		|-&gt; Globals.cs 
	|-&gt; Extensions 
		|-&gt; UIControlledApplicaiton_Ext.cs 
		|-&gt; RibbonPanel_Ext.cs
		|-&gt; PulldownButton_Ext.cs 
	|-&gt; Resources
		|-&gt; Files 
			|-&gt; Tooltips.resx       // Update
		|-&gt; Icons 
		|-&gt; Icons16 
			|-&gt; General_test16.png 
			|-&gt; Stack1_Button16.png // add a .png
			|-&gt; Stack116.png        // add a .png
			|-&gt; Stack2_Button16.png // add a .png
			|-&gt; Stack216.png        // add a .png
			|-&gt; Stack3_Button16.png // add a .png
			|-&gt; Stack316.png        // add a .png
		|-&gt; Icons32      
			|-&gt; General_test32.png  // add a .png
			|-&gt; Stack1_Button32.png // add a .png
			|-&gt; Stack132.png        // add a .png
			|-&gt; Stack2_Button32.png // add a .png
			|-&gt; Stack232.png        // add a .png
			|-&gt; Stack3_Button32.png // add a .png
			|-&gt; Stack332.png        // add a .png
	|-&gt; Utilities
		|-&gt; Ribbon_Utils.cs
	|-&gt; Application.cs              // Update
	|-&gt; guRoo.addin


Cmds_Stack1.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28


// Autodesk
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// Associate with stack commands
namespace guRoo.Cmds_Stack1
{
    /// &lt;summary&gt;
    /// Example command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
        {
            // Collect the document
            var uiApp = commandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Testing if the command worked
            TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title);

            // Final return
            return Result.Succeeded;
        }
    }
}


Cmds_Stack2.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28


// Autodesk
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// Associate with stack commands
namespace guRoo.Cmds_Stack2
{
    /// &lt;summary&gt;
    /// Example command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
        {
            // Collect the document
            var uiApp = commandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Testing if the command worked
            TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title);

            // Final return
            return Result.Succeeded;
        }
    }
}


Cmds_Stack3.cs


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28


// Autodesk
using Autodesk.Revit.Attributes;
using Autodesk.Revit.UI;

// Associate with stack commands
namespace guRoo.Cmds_Stack3
{
    /// &lt;summary&gt;
    /// Example command
    /// &lt;/summary&gt;
    [Transaction(TransactionMode.Manual)]
    public class Cmd_Button : IExternalCommand
    {
        public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
        {
            // Collect the document
            var uiApp = commandData.Application;
            var uiDoc = uiApp.ActiveUIDocument;
            var doc = uiDoc.Document;

            // Testing if the command worked
            TaskDialog.Show(&#34;It&#39;s working!&#34;, doc.Title);

            // Final return
            return Result.Succeeded;
        }
    }
}


Tooltips.resx

  
      
          Name
          Value
      
  
  
      
          Button
          The user will generally not see this - it just holds the PushButton example.
      
      
          Button_Button
          This is an example of adding a PushButton to a RibbonPanel.
      
      
          PullDown
          This is an example of adding a PulldownButton to a RibbonPanel.
      
      
          PullDown_1Button
          This is button 1 of the PulldownButton.
      
      
          PullDown_2Button
          This is button 2 of the PulldownButton.
      
      
          PullDown_3Button
          This is button 3 of the PulldownButton.
      
      
          Stack1
          This is an example of stacking buttons.
      
      
          Stack1_Button
          This is an example of stacking buttons.
      
      
          Stack2
          This is an example of stacking buttons.
      
      
          Stack2_Button
          This is an example of stacking buttons.
      
      
          Stack3
          This is an example of stacking buttons.
      
      
          Stack3_Button
          This is an example of stacking buttons.
      
  

Application.cs


  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108


// Autodesk
using Autodesk.Revit.UI;
using Autodesk.Revit.UI.Events;


// guRoo
using gRib = guRoo.Utilities.Ribbon_Utils;
using guRoo.Extensions;

// This application belongs to the root namespace
namespace guRoo
{
    // Implementing the interface for application.cs class
    public class Application : IExternalApplication
    // IExternalApplication for the interface
    {
        // Make a private uiCtlApp method:
        private static UIControlledApplication _uiCtlApp;

        //This will return a result on Startup method - requires uiCtlApp
        public Result OnStartup(UIControlledApplication uiCtlApp)
        {

            #region Globals registration
            // Store _uiCtlApp, register on idling
            _uiCtlApp = uiCtlApp;

            try
            {
                _uiCtlApp.Idling &#43;= RegisterUiApp;
            }
            catch
            {
                Globals.UiApp = null;
                Globals.UsernameRevit = null;
            }

            // Register Globals
            Globals.RegisterProperties(uiCtlApp);

            // Register Tooltips
            Globals.RegisterTooltips(&#34;guRoo.Resources.Files.Tooltips&#34;);
            #endregion

            #region Ribbon setup
            // Add RibbonTab
            uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); 

            // Create RibbonPanel
            var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, &#34;General&#34;);

            // Add PushButton to RibbonPanel
            var buttonTest = panelGeneral.Ext_AddPushButton(&#34;Testing&#34;, &#34;guRoo.Cmds_General.Cmd_Test&#34;);

            // Add PulldownButton to RibbonPanel
            var pulldownTest = panelGeneral.Ext_AddPulldownButton(&#34;PullDown&#34;, &#34;guRoo.Cmds_PullDown&#34;);

            // Add Buttons to Pulldown
            pulldownTest.Ext_AddPushButton(&#34;Button 1&#34;, &#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 2&#34;, &#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;);
            pulldownTest.Ext_AddPushButton(&#34;Button 3&#34;, &#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;);

			// Create data objects for the stack
            var stack1Data = gRib.NewPulldownButtonData(&#34;Stack1&#34;, &#34;guRoo.Cmds_Stack1&#34;);
            var stack2Data = gRib.NewPulldownButtonData(&#34;Stack2&#34;, &#34;guRoo.Cmds_Stack2&#34;);
            var stack3Data = gRib.NewPulldownButtonData(&#34;Stack3&#34;, &#34;guRoo.Cmds_Stack3&#34;);

            // Create the Stack
            var stack = panelGeneral.AddStackedItems(stack1Data, stack2Data, stack3Data);
            var pulldownStack1 = stack[0] as PulldownButton;
            var pulldownStack2 = stack[1] as PulldownButton;
            var pulldownStack3 = stack[2] as PulldownButton;

            // Add buttons to stacked pulldowns
            pulldownStack1.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack1.Cmd_Button&#34;);
            pulldownStack2.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack2.Cmd_Button&#34;);
            pulldownStack3.Ext_AddPushButton(&#34;Button&#34;, &#34;guRoo.Cmds_Stack3.Cmd_Button&#34;);

            #endregion


            // Final return:
            return Result.Succeeded; // or Cancelled
        }

        #region On shutdown method
        // This will urn on shutdown
        public Result OnShutdown(UIControlledApplication uiCtlApp)
        {
            return Result.Succeeded;
        }
        #endregion

        #region Use idling to register UiApp
        // On idling, register UiApp/username
        private static void RegisterUiApp(object sender, IdlingEventArgs e)
        {
            _uiCtlApp.Idling -= RegisterUiApp;

            if (sender is UIApplication uiApp)
            {
                Globals.UiApp = uiApp;
                Globals.UsernameRevit = uiApp.Application.Username;
            }
        }
        #endregion
    }
}




These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "C# + Revit API: Lesson 11 - Stacking Buttons",
      "item": "http://localhost:1313/posts/lesson-11/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C# + Revit API: Lesson 11 - Stacking Buttons",
  "name": "C# \u002b Revit API: Lesson 11 - Stacking Buttons",
  "description": "Aussie BIM Guru\nThe Goal Stacks can vertically contain 2 or 3 items. Homework Create a stack Access stacked items Solution Revit API AddStackedItems Method 2 overloads available, you can either add 2 items or 3 items. RibbonItemData Class - is the object that we are going to be adding: ComboBoxData Class RadioButtonClass ButtonData Class PulldownButton PushButton Tips We will be adding it to RibbonPanel But we will not create an Extension for this, since the the Method itself is sufficient to run this process. But we are going to have to access the projects once we create them as well. Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 Solution |-\u0026gt; guRoo |-\u0026gt; Dependencies |-\u0026gt; Commands |-\u0026gt; General |-\u0026gt; Cmds_General.cs |-\u0026gt; Cmds_Button.cs // Add a New Class |-\u0026gt; Cmds_PullDown.cs |-\u0026gt; Cmds_Stack1.cs // Add a New Class |-\u0026gt; Cmds_Stack2.cs // Add a New Class |-\u0026gt; Cmds_Stack3.cs // Add a New Class |-\u0026gt; Forms |-\u0026gt; General |-\u0026gt; Globals.cs |-\u0026gt; Extensions |-\u0026gt; UIControlledApplicaiton_Ext.cs |-\u0026gt; RibbonPanel_Ext.cs |-\u0026gt; PulldownButton_Ext.cs |-\u0026gt; Resources |-\u0026gt; Files |-\u0026gt; Tooltips.resx // Update |-\u0026gt; Icons |-\u0026gt; Icons16 |-\u0026gt; General_test16.png |-\u0026gt; Stack1_Button16.png // add a .png |-\u0026gt; Stack116.png // add a .png |-\u0026gt; Stack2_Button16.png // add a .png |-\u0026gt; Stack216.png // add a .png |-\u0026gt; Stack3_Button16.png // add a .png |-\u0026gt; Stack316.png // add a .png |-\u0026gt; Icons32 |-\u0026gt; General_test32.png // add a .png |-\u0026gt; Stack1_Button32.png // add a .png |-\u0026gt; Stack132.png // add a .png |-\u0026gt; Stack2_Button32.png // add a .png |-\u0026gt; Stack232.png // add a .png |-\u0026gt; Stack3_Button32.png // add a .png |-\u0026gt; Stack332.png // add a .png |-\u0026gt; Utilities |-\u0026gt; Ribbon_Utils.cs |-\u0026gt; Application.cs // Update |-\u0026gt; guRoo.addin Cmds_Stack1.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack1 { /// \u0026lt;summary\u0026gt; /// Example command /// \u0026lt;/summary\u0026gt; [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(\u0026#34;It\u0026#39;s working!\u0026#34;, doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack2.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack2 { /// \u0026lt;summary\u0026gt; /// Example command /// \u0026lt;/summary\u0026gt; [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(\u0026#34;It\u0026#39;s working!\u0026#34;, doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack3.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack3 { /// \u0026lt;summary\u0026gt; /// Example command /// \u0026lt;/summary\u0026gt; [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(\u0026#34;It\u0026#39;s working!\u0026#34;, doc.Title); // Final return return Result.Succeeded; } } } Tooltips.resx Name Value Button The user will generally not see this - it just holds the PushButton example. Button_Button This is an example of adding a PushButton to a RibbonPanel. PullDown This is an example of adding a PulldownButton to a RibbonPanel. PullDown_1Button This is button 1 of the PulldownButton. PullDown_2Button This is button 2 of the PulldownButton. PullDown_3Button This is button 3 of the PulldownButton. Stack1 This is an example of stacking buttons. Stack1_Button This is an example of stacking buttons. Stack2 This is an example of stacking buttons. Stack2_Button This is an example of stacking buttons. Stack3 This is an example of stacking buttons. Stack3_Button This is an example of stacking buttons. Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips(\u0026#34;guRoo.Resources.Files.Tooltips\u0026#34;); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, \u0026#34;General\u0026#34;); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton(\u0026#34;Testing\u0026#34;, \u0026#34;guRoo.Cmds_General.Cmd_Test\u0026#34;); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton(\u0026#34;PullDown\u0026#34;, \u0026#34;guRoo.Cmds_PullDown\u0026#34;); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton(\u0026#34;Button 1\u0026#34;, \u0026#34;guRoo.Cmds_PullDown.Cmd_1Button\u0026#34;); pulldownTest.Ext_AddPushButton(\u0026#34;Button 2\u0026#34;, \u0026#34;guRoo.Cmds_PullDown.Cmd_2Button\u0026#34;); pulldownTest.Ext_AddPushButton(\u0026#34;Button 3\u0026#34;, \u0026#34;guRoo.Cmds_PullDown.Cmd_3Button\u0026#34;); // Create data objects for the stack var stack1Data = gRib.NewPulldownButtonData(\u0026#34;Stack1\u0026#34;, \u0026#34;guRoo.Cmds_Stack1\u0026#34;); var stack2Data = gRib.NewPulldownButtonData(\u0026#34;Stack2\u0026#34;, \u0026#34;guRoo.Cmds_Stack2\u0026#34;); var stack3Data = gRib.NewPulldownButtonData(\u0026#34;Stack3\u0026#34;, \u0026#34;guRoo.Cmds_Stack3\u0026#34;); // Create the Stack var stack = panelGeneral.AddStackedItems(stack1Data, stack2Data, stack3Data); var pulldownStack1 = stack[0] as PulldownButton; var pulldownStack2 = stack[1] as PulldownButton; var pulldownStack3 = stack[2] as PulldownButton; // Add buttons to stacked pulldowns pulldownStack1.Ext_AddPushButton(\u0026#34;Button\u0026#34;, \u0026#34;guRoo.Cmds_Stack1.Cmd_Button\u0026#34;); pulldownStack2.Ext_AddPushButton(\u0026#34;Button\u0026#34;, \u0026#34;guRoo.Cmds_Stack2.Cmd_Button\u0026#34;); pulldownStack3.Ext_AddPushButton(\u0026#34;Button\u0026#34;, \u0026#34;guRoo.Cmds_Stack3.Cmd_Button\u0026#34;); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.\n",
  "keywords": [
    "C#", "Revit", "Tutorial"
  ],
  "articleBody": "Aussie BIM Guru\nThe Goal Stacks can vertically contain 2 or 3 items. Homework Create a stack Access stacked items Solution Revit API AddStackedItems Method 2 overloads available, you can either add 2 items or 3 items. RibbonItemData Class - is the object that we are going to be adding: ComboBoxData Class RadioButtonClass ButtonData Class PulldownButton PushButton Tips We will be adding it to RibbonPanel But we will not create an Extension for this, since the the Method itself is sufficient to run this process. But we are going to have to access the projects once we create them as well. Project Solution 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 Solution |-\u003e guRoo |-\u003e Dependencies |-\u003e Commands |-\u003e General |-\u003e Cmds_General.cs |-\u003e Cmds_Button.cs // Add a New Class |-\u003e Cmds_PullDown.cs |-\u003e Cmds_Stack1.cs // Add a New Class |-\u003e Cmds_Stack2.cs // Add a New Class |-\u003e Cmds_Stack3.cs // Add a New Class |-\u003e Forms |-\u003e General |-\u003e Globals.cs |-\u003e Extensions |-\u003e UIControlledApplicaiton_Ext.cs |-\u003e RibbonPanel_Ext.cs |-\u003e PulldownButton_Ext.cs |-\u003e Resources |-\u003e Files |-\u003e Tooltips.resx // Update |-\u003e Icons |-\u003e Icons16 |-\u003e General_test16.png |-\u003e Stack1_Button16.png // add a .png |-\u003e Stack116.png // add a .png |-\u003e Stack2_Button16.png // add a .png |-\u003e Stack216.png // add a .png |-\u003e Stack3_Button16.png // add a .png |-\u003e Stack316.png // add a .png |-\u003e Icons32 |-\u003e General_test32.png // add a .png |-\u003e Stack1_Button32.png // add a .png |-\u003e Stack132.png // add a .png |-\u003e Stack2_Button32.png // add a .png |-\u003e Stack232.png // add a .png |-\u003e Stack3_Button32.png // add a .png |-\u003e Stack332.png // add a .png |-\u003e Utilities |-\u003e Ribbon_Utils.cs |-\u003e Application.cs // Update |-\u003e guRoo.addin Cmds_Stack1.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack1 { /// /// Example command /// [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(\"It's working!\", doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack2.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack2 { /// /// Example command /// [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(\"It's working!\", doc.Title); // Final return return Result.Succeeded; } } } Cmds_Stack3.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Autodesk using Autodesk.Revit.Attributes; using Autodesk.Revit.UI; // Associate with stack commands namespace guRoo.Cmds_Stack3 { /// /// Example command /// [Transaction(TransactionMode.Manual)] public class Cmd_Button : IExternalCommand { public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements) { // Collect the document var uiApp = commandData.Application; var uiDoc = uiApp.ActiveUIDocument; var doc = uiDoc.Document; // Testing if the command worked TaskDialog.Show(\"It's working!\", doc.Title); // Final return return Result.Succeeded; } } } Tooltips.resx Name Value Button The user will generally not see this - it just holds the PushButton example. Button_Button This is an example of adding a PushButton to a RibbonPanel. PullDown This is an example of adding a PulldownButton to a RibbonPanel. PullDown_1Button This is button 1 of the PulldownButton. PullDown_2Button This is button 2 of the PulldownButton. PullDown_3Button This is button 3 of the PulldownButton. Stack1 This is an example of stacking buttons. Stack1_Button This is an example of stacking buttons. Stack2 This is an example of stacking buttons. Stack2_Button This is an example of stacking buttons. Stack3 This is an example of stacking buttons. Stack3_Button This is an example of stacking buttons. Application.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 // Autodesk using Autodesk.Revit.UI; using Autodesk.Revit.UI.Events; // guRoo using gRib = guRoo.Utilities.Ribbon_Utils; using guRoo.Extensions; // This application belongs to the root namespace namespace guRoo { // Implementing the interface for application.cs class public class Application : IExternalApplication // IExternalApplication for the interface { // Make a private uiCtlApp method: private static UIControlledApplication _uiCtlApp; //This will return a result on Startup method - requires uiCtlApp public Result OnStartup(UIControlledApplication uiCtlApp) { #region Globals registration // Store _uiCtlApp, register on idling _uiCtlApp = uiCtlApp; try { _uiCtlApp.Idling += RegisterUiApp; } catch { Globals.UiApp = null; Globals.UsernameRevit = null; } // Register Globals Globals.RegisterProperties(uiCtlApp); // Register Tooltips Globals.RegisterTooltips(\"guRoo.Resources.Files.Tooltips\"); #endregion #region Ribbon setup // Add RibbonTab uiCtlApp.Ext_AddRibbonTab(Globals.AddinName); // Create RibbonPanel var panelGeneral = uiCtlApp.Ext_AddRibbonPanel(Globals.AddinName, \"General\"); // Add PushButton to RibbonPanel var buttonTest = panelGeneral.Ext_AddPushButton(\"Testing\", \"guRoo.Cmds_General.Cmd_Test\"); // Add PulldownButton to RibbonPanel var pulldownTest = panelGeneral.Ext_AddPulldownButton(\"PullDown\", \"guRoo.Cmds_PullDown\"); // Add Buttons to Pulldown pulldownTest.Ext_AddPushButton(\"Button 1\", \"guRoo.Cmds_PullDown.Cmd_1Button\"); pulldownTest.Ext_AddPushButton(\"Button 2\", \"guRoo.Cmds_PullDown.Cmd_2Button\"); pulldownTest.Ext_AddPushButton(\"Button 3\", \"guRoo.Cmds_PullDown.Cmd_3Button\"); // Create data objects for the stack var stack1Data = gRib.NewPulldownButtonData(\"Stack1\", \"guRoo.Cmds_Stack1\"); var stack2Data = gRib.NewPulldownButtonData(\"Stack2\", \"guRoo.Cmds_Stack2\"); var stack3Data = gRib.NewPulldownButtonData(\"Stack3\", \"guRoo.Cmds_Stack3\"); // Create the Stack var stack = panelGeneral.AddStackedItems(stack1Data, stack2Data, stack3Data); var pulldownStack1 = stack[0] as PulldownButton; var pulldownStack2 = stack[1] as PulldownButton; var pulldownStack3 = stack[2] as PulldownButton; // Add buttons to stacked pulldowns pulldownStack1.Ext_AddPushButton(\"Button\", \"guRoo.Cmds_Stack1.Cmd_Button\"); pulldownStack2.Ext_AddPushButton(\"Button\", \"guRoo.Cmds_Stack2.Cmd_Button\"); pulldownStack3.Ext_AddPushButton(\"Button\", \"guRoo.Cmds_Stack3.Cmd_Button\"); #endregion // Final return: return Result.Succeeded; // or Cancelled } #region On shutdown method // This will urn on shutdown public Result OnShutdown(UIControlledApplication uiCtlApp) { return Result.Succeeded; } #endregion #region Use idling to register UiApp // On idling, register UiApp/username private static void RegisterUiApp(object sender, IdlingEventArgs e) { _uiCtlApp.Idling -= RegisterUiApp; if (sender is UIApplication uiApp) { Globals.UiApp = uiApp; Globals.UsernameRevit = uiApp.Application.Username; } } #endregion } } These tutorials were inspired by the work of Aussie BIM Guru. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.\n",
  "wordCount" : "1139",
  "inLanguage": "en",
  "image":"http://localhost:1313/images/Pasted%20image%2020250814192206.png","datePublished": "2025-08-14T18:30:33+03:00",
  "dateModified": "2025-08-14T18:30:33+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/lesson-11/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Blog (Alt + H)">Blog</a>
        </div>

        
        <div class="logo main-logo">
            <a href="https://aydrafting.com" target="_blank">
                <img src="/LogoAYD.png" alt="Blog" height="40">
            </a>
        </div>

        
        <div class="logo-switches">
            <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        </div>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      C# &#43; Revit API: Lesson 11 - Stacking Buttons
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2025-08-14 18:30:33 +0300 MSK'>August 14, 2025</span>&nbsp;·&nbsp;6 min&nbsp;|&nbsp;<a href="mailto:%20aydimir@aydrafting.com" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/images/Pasted%20image%2020250814192206.png" alt="Create a Pulldown Button">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#the-goal" aria-label="The Goal">The Goal</a></li>
                <li>
                    <a href="#homework" aria-label="Homework">Homework</a></li>
                <li>
                    <a href="#solution" aria-label="Solution">Solution</a><ul>
                        
                <li>
                    <a href="#revit-api" aria-label="Revit API">Revit API</a></li>
                <li>
                    <a href="#tips" aria-label="Tips">Tips</a><ul>
                        
                <li>
                    <a href="#project-solution" aria-label="Project Solution">Project Solution</a></li>
                <li>
                    <a href="#cmds_stack1cs" aria-label="Cmds_Stack1.cs">Cmds_Stack1.cs</a></li>
                <li>
                    <a href="#cmds_stack2cs" aria-label="Cmds_Stack2.cs">Cmds_Stack2.cs</a></li>
                <li>
                    <a href="#cmds_stack3cs" aria-label="Cmds_Stack3.cs">Cmds_Stack3.cs</a></li>
                <li>
                    <a href="#tooltipsresx" aria-label="Tooltips.resx">Tooltips.resx</a></li>
                <li>
                    <a href="#applicationcs" aria-label="Application.cs">Application.cs</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><a href="https://www.youtube.com/watch?v=zaouXDa1dTc">Aussie BIM Guru</a></p>
<h1 id="the-goal">The Goal<a hidden class="anchor" aria-hidden="true" href="#the-goal">#</a></h1>
<ul>
<li>Stacks can vertically contain 2 or 3 items.</li>
</ul>
<h1 id="homework">Homework<a hidden class="anchor" aria-hidden="true" href="#homework">#</a></h1>
<ol>
<li>Create a stack</li>
<li>Access stacked items</li>
</ol>
<h1 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h1>
<h2 id="revit-api">Revit API<a hidden class="anchor" aria-hidden="true" href="#revit-api">#</a></h2>
<ul>
<li><code>AddStackedItems</code> Method
<ul>
<li>2 overloads available, you can either add 2 items or 3 items.</li>
</ul>
</li>
<li><code>RibbonItemData</code> Class - is the object that we are going to be adding:
<ul>
<li><code>ComboBoxData</code> Class</li>
<li><code>RadioButton</code>Class</li>
<li><code>ButtonData</code> Class
<ul>
<li><code>PulldownButton</code></li>
<li><code>PushButton</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="tips">Tips<a hidden class="anchor" aria-hidden="true" href="#tips">#</a></h2>
<ul>
<li>We will be adding it to <code>RibbonPanel</code></li>
<li>But we will not create an <code>Extension</code> for this, since the the Method itself is sufficient to run this process.</li>
<li>But we are going to have to access the projects once we create them as well.</li>
</ul>
<h3 id="project-solution"><code>Project Solution</code><a hidden class="anchor" aria-hidden="true" href="#project-solution">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Solution
</span></span><span class="line"><span class="cl"><span class="p">|</span>-&gt; guRoo
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Dependencies
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Commands
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; General 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_General.cs 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_Button.cs // Add a New Class
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_PullDown.cs  
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_Stack1.cs // Add a New Class
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_Stack2.cs // Add a New Class
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Cmds_Stack3.cs // Add a New Class
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Forms
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; General 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Globals.cs 
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Extensions 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; UIControlledApplicaiton_Ext.cs 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; RibbonPanel_Ext.cs
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; PulldownButton_Ext.cs 
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Resources
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Files 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Tooltips.resx       // Update
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons 
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons16 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; General_test16.png 
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack1_Button16.png // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack116.png        // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack2_Button16.png // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack216.png        // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack3_Button16.png // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack316.png        // add a .png
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Icons32      
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; General_test32.png  // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack1_Button32.png // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack132.png        // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack2_Button32.png // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack232.png        // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack3_Button32.png // add a .png
</span></span><span class="line"><span class="cl">			<span class="p">|</span>-&gt; Stack332.png        // add a .png
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Utilities
</span></span><span class="line"><span class="cl">		<span class="p">|</span>-&gt; Ribbon_Utils.cs
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; Application.cs              // Update
</span></span><span class="line"><span class="cl">	<span class="p">|</span>-&gt; guRoo.addin
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmds_stack1cs"><code>Cmds_Stack1.cs</code><a hidden class="anchor" aria-hidden="true" href="#cmds_stack1cs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Associate with stack commands</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Cmds_Stack1</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Example command</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Button</span> <span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">commandData</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Collect the document</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">commandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Testing if the command worked</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;It&#39;s working!&#34;</span><span class="p">,</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmds_stack2cs"><code>Cmds_Stack2.cs</code><a hidden class="anchor" aria-hidden="true" href="#cmds_stack2cs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Associate with stack commands</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Cmds_Stack2</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Example command</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Button</span> <span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">commandData</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Collect the document</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">commandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Testing if the command worked</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;It&#39;s working!&#34;</span><span class="p">,</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmds_stack3cs"><code>Cmds_Stack3.cs</code><a hidden class="anchor" aria-hidden="true" href="#cmds_stack3cs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.Attributes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Associate with stack commands</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo.Cmds_Stack3</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Example command</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Transaction(TransactionMode.Manual)]</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Cmd_Button</span> <span class="p">:</span> <span class="n">IExternalCommand</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ExternalCommandData</span> <span class="n">commandData</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">ElementSet</span> <span class="n">elements</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Collect the document</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiApp</span> <span class="p">=</span> <span class="n">commandData</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">ActiveUIDocument</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uiDoc</span><span class="p">.</span><span class="n">Document</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Testing if the command worked</span>
</span></span><span class="line"><span class="cl">            <span class="n">TaskDialog</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&#34;It&#39;s working!&#34;</span><span class="p">,</span> <span class="n">doc</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="tooltipsresx"><code>Tooltips.resx</code><a hidden class="anchor" aria-hidden="true" href="#tooltipsresx">#</a></h3>
<table>
  <thead>
      <tr>
          <th><strong>Name</strong></th>
          <th><strong>Value</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Button</td>
          <td>The user will generally not see this - it just holds the PushButton example.</td>
      </tr>
      <tr>
          <td>Button_Button</td>
          <td>This is an example of adding a PushButton to a RibbonPanel.</td>
      </tr>
      <tr>
          <td>PullDown</td>
          <td>This is an example of adding a PulldownButton to a RibbonPanel.</td>
      </tr>
      <tr>
          <td>PullDown_1Button</td>
          <td>This is button 1 of the PulldownButton.</td>
      </tr>
      <tr>
          <td>PullDown_2Button</td>
          <td>This is button 2 of the PulldownButton.</td>
      </tr>
      <tr>
          <td>PullDown_3Button</td>
          <td>This is button 3 of the PulldownButton.</td>
      </tr>
      <tr>
          <td>Stack1</td>
          <td>This is an example of stacking buttons.</td>
      </tr>
      <tr>
          <td>Stack1_Button</td>
          <td>This is an example of stacking buttons.</td>
      </tr>
      <tr>
          <td>Stack2</td>
          <td>This is an example of stacking buttons.</td>
      </tr>
      <tr>
          <td>Stack2_Button</td>
          <td>This is an example of stacking buttons.</td>
      </tr>
      <tr>
          <td>Stack3</td>
          <td>This is an example of stacking buttons.</td>
      </tr>
      <tr>
          <td>Stack3_Button</td>
          <td>This is an example of stacking buttons.</td>
      </tr>
  </tbody>
</table>
<h3 id="applicationcs"><code>Application.cs</code><a hidden class="anchor" aria-hidden="true" href="#applicationcs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Autodesk</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Autodesk.Revit.UI.Events</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// guRoo</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">gRib</span> <span class="p">=</span> <span class="n">guRoo</span><span class="p">.</span><span class="n">Utilities</span><span class="p">.</span><span class="n">Ribbon_Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">guRoo.Extensions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// This application belongs to the root namespace</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">guRoo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Implementing the interface for application.cs class</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">Application</span> <span class="p">:</span> <span class="n">IExternalApplication</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// IExternalApplication for the interface</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Make a private uiCtlApp method:</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">static</span> <span class="n">UIControlledApplication</span> <span class="n">_uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//This will return a result on Startup method - requires uiCtlApp</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">OnStartup</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cp">#region</span> <span class="n">Globals</span> <span class="n">registration</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Store _uiCtlApp, register on idling</span>
</span></span><span class="line"><span class="cl">            <span class="n">_uiCtlApp</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">try</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">+=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">catch</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Register Globals</span>
</span></span><span class="line"><span class="cl">            <span class="n">Globals</span><span class="p">.</span><span class="n">RegisterProperties</span><span class="p">(</span><span class="n">uiCtlApp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Register Tooltips</span>
</span></span><span class="line"><span class="cl">            <span class="n">Globals</span><span class="p">.</span><span class="n">RegisterTooltips</span><span class="p">(</span><span class="s">&#34;guRoo.Resources.Files.Tooltips&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cp">#region</span> <span class="n">Ribbon</span> <span class="n">setup</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Add RibbonTab</span>
</span></span><span class="line"><span class="cl">            <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">Ext_AddRibbonTab</span><span class="p">(</span><span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Create RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">panelGeneral</span> <span class="p">=</span> <span class="n">uiCtlApp</span><span class="p">.</span><span class="n">Ext_AddRibbonPanel</span><span class="p">(</span><span class="n">Globals</span><span class="p">.</span><span class="n">AddinName</span><span class="p">,</span> <span class="s">&#34;General&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Add PushButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">buttonTest</span> <span class="p">=</span> <span class="n">panelGeneral</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Testing&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_General.Cmd_Test&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Add PulldownButton to RibbonPanel</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pulldownTest</span> <span class="p">=</span> <span class="n">panelGeneral</span><span class="p">.</span><span class="n">Ext_AddPulldownButton</span><span class="p">(</span><span class="s">&#34;PullDown&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Add Buttons to Pulldown</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownTest</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button 1&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown.Cmd_1Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownTest</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button 2&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown.Cmd_2Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownTest</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button 3&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_PullDown.Cmd_3Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="c1">// Create data objects for the stack</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">stack1Data</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">NewPulldownButtonData</span><span class="p">(</span><span class="s">&#34;Stack1&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_Stack1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">stack2Data</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">NewPulldownButtonData</span><span class="p">(</span><span class="s">&#34;Stack2&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_Stack2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">stack3Data</span> <span class="p">=</span> <span class="n">gRib</span><span class="p">.</span><span class="n">NewPulldownButtonData</span><span class="p">(</span><span class="s">&#34;Stack3&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_Stack3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Create the Stack</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">stack</span> <span class="p">=</span> <span class="n">panelGeneral</span><span class="p">.</span><span class="n">AddStackedItems</span><span class="p">(</span><span class="n">stack1Data</span><span class="p">,</span> <span class="n">stack2Data</span><span class="p">,</span> <span class="n">stack3Data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pulldownStack1</span> <span class="p">=</span> <span class="n">stack</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="k">as</span> <span class="n">PulldownButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pulldownStack2</span> <span class="p">=</span> <span class="n">stack</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="k">as</span> <span class="n">PulldownButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">pulldownStack3</span> <span class="p">=</span> <span class="n">stack</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="k">as</span> <span class="n">PulldownButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Add buttons to stacked pulldowns</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownStack1</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_Stack1.Cmd_Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownStack2</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_Stack2.Cmd_Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pulldownStack3</span><span class="p">.</span><span class="n">Ext_AddPushButton</span><span class="p">(</span><span class="s">&#34;Button&#34;</span><span class="p">,</span> <span class="s">&#34;guRoo.Cmds_Stack3.Cmd_Button&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// Final return:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span> <span class="c1">// or Cancelled</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">On</span> <span class="n">shutdown</span> <span class="n">method</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// This will urn on shutdown</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Result</span> <span class="n">OnShutdown</span><span class="p">(</span><span class="n">UIControlledApplication</span> <span class="n">uiCtlApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cp">#region</span> <span class="n">Use</span> <span class="n">idling</span> <span class="n">to</span> <span class="n">register</span> <span class="n">UiApp</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// On idling, register UiApp/username</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">RegisterUiApp</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">IdlingEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">_uiCtlApp</span><span class="p">.</span><span class="n">Idling</span> <span class="p">-=</span> <span class="n">RegisterUiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">sender</span> <span class="k">is</span> <span class="n">UIApplication</span> <span class="n">uiApp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UiApp</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">Globals</span><span class="p">.</span><span class="n">UsernameRevit</span> <span class="p">=</span> <span class="n">uiApp</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">#endregion</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<blockquote>
<p>These tutorials were inspired by the work of <a href="https://www.youtube.com/@AussieBIMGuru">Aussie BIM Guru</a>. If you’re looking for a deeper dive into the topics, check out his channel for detailed explanations.</p></blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/c%23/">C#</a></li>
      <li><a href="http://localhost:1313/tags/revit/">Revit</a></li>
      <li><a href="http://localhost:1313/tags/tutorial/">Tutorial</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/lesson-12/">
    <span class="title">« Prev</span>
    <br>
    <span>C# &#43; Revit API: Lesson 12 - FilteredElementCollector</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/lesson-10/">
    <span class="title">Next »</span>
    <br>
    <span>C# &#43; Revit API: Lesson 10 - Create a Pulldown Button</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© 2025 AYDrafting. All rights reserved.</span> · 

    <span>
        Powered by
        <a href="https://aydrafting.com/" rel="noopener noreferrer" target="_blank">AYDrafting</a> &
        <a href="https://github.com/aydimir95/" rel="noopener" target="_blank">GitHub</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
