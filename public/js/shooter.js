(()=>{var M=Object.defineProperty;var I=(n,e,t)=>e in n?M(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var d=(n,e,t)=>I(n,typeof e!="symbol"?e+"":e,t);var f=class{constructor(){d(this,"angle",0);d(this,"x",0);d(this,"y",0);d(this,"speed",6)}rotate(e){this.angle=e}move(e,t){this.x=e,this.y=t}update(){this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed}},p=class{constructor(){d(this,"active",!1);d(this,"item",new f)}},u=class{},h=class extends u{shoot(e,t){let o=t.find(a=>!a.active);o&&(o.active=!0,o.item.rotate(0),o.item.move(e[0]+50,e[1]))}},b=class extends u{constructor(t=3,o=Math.PI/4){super();this.count=t;this.spread=o}shoot(t,o){for(let a=0;a<this.count;a++){let r=o.find(s=>!s.active);if(!r)return;r.active=!0;let i=-this.spread+2*this.spread*(this.count===1?0:a)/Math.max(1,this.count-1);r.item.rotate(i),r.item.move(t[0]+50,t[1])}}};function y(n,e){let t=document.createElement("button");return t.textContent=n,t.style.marginRight="8px",t.onclick=e,t}window.initShooter=({mountId:n,strategy:e="burst",count:t=3,spread:o=Math.PI/4})=>{let a=document.getElementById(n);a.innerHTML="";let r=document.createElement("div");r.style.margin="0 0 8px";let i=document.createElement("canvas");i.width=640,i.height=320,i.style.border="1px solid var(--border, #ccc)",i.style.background="var(--code-bg, #0b0b0b0d)",a.append(r,i);let s=i.getContext("2d"),v=Array.from({length:128},()=>new p),g=e==="single"?new h:new b(t,o),m=document.createElement("span");m.textContent=`Mode: ${e==="single"?"Single":`Burst(${t}, spread=${o.toFixed(2)})`}`,m.style.marginLeft="8px",r.append(y("Single",()=>{g=new h,m.textContent="Mode: Single"}),y("Burst",()=>{g=new b(t,o),m.textContent=`Mode: Burst(${t}, spread=${o.toFixed(2)})`}),m);let l=[60,i.height/2],w=0;function x(){s.clearRect(0,0,i.width,i.height),s.fillStyle="#3b82f6",s.beginPath(),s.moveTo(l[0],l[1]),s.lineTo(l[0]-20,l[1]-12),s.lineTo(l[0]-20,l[1]+12),s.closePath(),s.fill(),w++%15===0&&g.shoot(l,v),s.fillStyle="#ef4444";for(let c of v)c.active&&(c.item.update(),s.beginPath(),s.arc(c.item.x,c.item.y,3,0,Math.PI*2),s.fill(),(c.item.x<-10||c.item.x>i.width+10||c.item.y<-10||c.item.y>i.height+10)&&(c.active=!1));requestAnimationFrame(x)}x()};(()=>{function n(){document.querySelectorAll(".shooter-embed").forEach(t=>{let o=t.id,a=t.getAttribute("data-strategy")||"burst",r=parseInt(t.getAttribute("data-count")||"3",10),i=parseFloat(t.getAttribute("data-spread")||`${Math.PI/4}`);o&&window.initShooter({mountId:o,strategy:a,count:r,spread:i})})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})();})();
